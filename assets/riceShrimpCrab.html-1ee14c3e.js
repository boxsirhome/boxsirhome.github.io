import{_ as c,r as B,o as r,c as i,d as s,e as n,b as l,f as p}from"./app-c4ddd265.js";const y="/assets/17-f5d0e2f8.png",A="/assets/15-e59b4b2e.png",d="/assets/16-d6c26209.png",F="/assets/66-c16e1cfb.png",v="/assets/67-e22a1bbb.png",u="/assets/18-a6daa2a4.png",m="/assets/20-603e8987.png",C="/assets/21-a49c3b9b.png",D="/assets/22-61c7ad5d.png",e="/assets/9-de4aefed.png",t="/assets/10-ab9d2a74.png",b="/assets/27-f2cead80.png",E="/assets/28-c8d44086.png",g="/assets/29-f002ae80.png",h="/assets/30-db7f7991.png",f="/assets/24-b6737f85.png",q="/assets/23-8926e18d.png",_="/assets/25-6c7fe52a.png",x="/assets/26-585c5cf7.png",w="/assets/31-d315b93e.png",S="/assets/57-26fa7021.png",k="/assets/32-4b0a69c9.png",P="/assets/33-e790b02f.png",I="/assets/0-2e043c99.jpg",T="/assets/1-a6bb69dd.png",L="/assets/2-d522c741.png",R="/assets/3-7551079f.png",N="/assets/4-c0c5296a.png",O="/assets/5-72572c94.png",M="/assets/7-8e7b9834.png",j="/assets/8-9b6dbfcb.png",U="/assets/6-1b4e03e5.png",V="/assets/11-071992f4.png",H="/assets/12-0695e8ea.png",G="/assets/94-846cb063.png",W="/assets/95-19050166.png",z="/assets/13-5f6d0fb9.png",K="/assets/14-89419d9a.png",Y="/assets/34-128545a7.png",X="/assets/35-50bb041f.png",J="/assets/36-b45d3f1f.png",$="/assets/38-a772e9f9.png",Z="/assets/39-1f24c3e2.png",Q="/assets/37-c8f69b59.png",ss="/assets/40-478fe91a.png",ns="/assets/41-42a14d39.png",as="/assets/42-25701dd6.png",ls="/assets/43-102cd499.png",ps="/assets/44-7c264638.png",os="/assets/45-cf08064c.png",es="/assets/91-74cee473.png",ts="/assets/92-59761f59.png",cs="/assets/46-962f1d2a.png",Bs="/assets/47-c69741d0.png",rs="/assets/52-a2e1662c.png",is="/assets/49-34fc4745.png",ys="/assets/50-45fe9cd1.png",As="/assets/51-a6b31ad9.png",ds="/assets/53-a1ce988d.png",Fs="/assets/54-a5235324.png",vs="/assets/55-1fe8be07.png",us="/assets/56-84f492f1.png",ms="/assets/60-325c48ac.png",o="/assets/61-7c838f31.png",Cs="/assets/62-e490eaff.png",Ds="/assets/58-9af97000.png",bs="/assets/59-bad40299.png",Es="/assets/63-5370e6a9.png",gs="/assets/64-c4145f18.png",hs="/assets/65-962a4b6d.png",fs="/assets/68-01b261b0.png",qs="/assets/69-84273f33.png",_s="/assets/70-76c9f255.png",xs="/assets/71-0ed82ee7.png",ws="/assets/72-b97e91b9.png",Ss="/assets/73-5ad94461.png",ks="/assets/74-4c063f69.png",Ps="/assets/75-d116cdf9.png",Is="/assets/76-1ed698c3.png",Ts="/assets/77-53039a1d.png",Ls="/assets/78-1dc12a5f.png",Rs="/assets/79-ece1abb6.png",Ns="/assets/80-d08488b6.png",Os="/assets/81-116182e4.png",Ms="/assets/83-2d72f748.png",js="/assets/84-77f77507.png",Us="/assets/85-9a2a5c2c.png",Vs="/assets/86-8df0ba1a.png",Hs="/assets/82-b6beda62.png",Gs="/assets/87-379d2346.png",Ws="/assets/88-feed66a8.png",zs="/assets/89-1993cc65.png",Ks="/assets/90-b4803ff6.png",Ys="/assets/93-01aa8d30.png",Xs="/assets/96-d523c832.png",Js="/assets/97-fa5a56c9.png",$s="/assets/98-a177b158.png",Zs="/assets/99-511faed5.png",Qs="/assets/100-1dfec726.png",sn="/assets/101-e1a96ab8.png",nn="/assets/102-fc38bb22.png",an="/assets/103-6a35c0c4.png",ln="/assets/104-79578f7b.png",pn="/assets/105-e3ffbdcb.png",on="/assets/109-93a38bec.png",en="/assets/110-480d83d6.png",tn="/assets/111-0cb935b4.png",cn="/assets/112-8cd42b9a.png",Bn="/assets/113-2b3b62af.png",rn="/assets/114-b424a9b2.png",yn="/assets/115-9d91dd16.png",An="/assets/116-3dd1a02e.png",dn="/assets/117-d688397e.png",Fn="/assets/118-ee7dba44.png",vn="/assets/119-852618c3.png",un="/assets/120-f38703b9.png",mn="/assets/121-9af4bc53.png",Cn="/assets/122-bee13943.png",Dn="/assets/106-f52689e2.png",bn="/assets/107-bd219815.png",En="/assets/108-1f52613d.png",gn="/assets/123-6e87452c.png",hn="/assets/124-90a08785.png",fn="/assets/125-3af8724a.png",qn="/assets/126-554a9d37.png",_n="/assets/127-ed570bb7.png",xn="/assets/128-3233477a.png",wn="/assets/129-f129665e.png",Sn="/assets/130-1a32d47b.png",kn="/assets/131-5620343f.png",Pn="/assets/132-174bd419.png",In="/assets/133-0a95f96d.png",Tn="/assets/134-54cd0e46.png",Ln="/assets/135-0db44cda.png",Rn="/assets/136-729508a7.png",Nn="/assets/137-7155afb6.png",On="/assets/138-b5f15bae.png",Mn="/assets/139-b8c27a57.png",jn="/assets/140-4f23ec54.png",Un={},Vn=p('<h1 id="稻虾蟹共生系统项目说明" tabindex="-1"><a class="header-anchor" href="#稻虾蟹共生系统项目说明" aria-hidden="true">#</a> <strong>稻虾蟹共生系统项目说明</strong></h1><h2 id="一、认识物联网模块" tabindex="-1"><a class="header-anchor" href="#一、认识物联网模块" aria-hidden="true">#</a> 一、认识物联网模块</h2><h3 id="主控模块" tabindex="-1"><a class="header-anchor" href="#主控模块" aria-hidden="true">#</a> 主控模块：</h3><img src="'+y+'" alt="图片1" width="700"><p>主控板为ESP8266，链接环境温湿度传感器、雾化片驱动、水位传感器、继电器、OLED屏幕</p><h4 id="_1、esp8266主控板" tabindex="-1"><a class="header-anchor" href="#_1、esp8266主控板" aria-hidden="true">#</a> 1、ESP8266主控板</h4><div style="display:flex;justify-content:center;gap:50px;"><img src="'+A+'" width="300"><img src="'+d+'" width="300"></div>',7),Hn={href:"https://pan.baidu.com/s/1LymkbGFzdjkwvs4E7MMi2g?pwd=8889",target:"_blank",rel:"noopener noreferrer"},Gn={href:"https://pan.baidu.com/s/10xkZRh0lhhMzrGsPKYjVlw?pwd=l9hj",target:"_blank",rel:"noopener noreferrer"},Wn=p('<h4 id="_2、esp8266扩展板" tabindex="-1"><a class="header-anchor" href="#_2、esp8266扩展板" aria-hidden="true">#</a> 2、ESP8266扩展板</h4><div style="display:flex;justify-content:center;gap:50px;"><img src="'+F+'" width="300"><img src="'+v+'" width="300"></div><h4 id="_3、环境温湿度传感器" tabindex="-1"><a class="header-anchor" href="#_3、环境温湿度传感器" aria-hidden="true">#</a> 3、环境温湿度传感器</h4><div style="display:flex;justify-content:center;gap:50px;"><img src="'+u+'" width="300"><img src="'+m+'" width="300"></div>',4),zn={href:"https://pan.baidu.com/s/1WdJK13-oJNpTJXn-8sp0DQ?pwd=8889%E6%8F%90%E5%8F%96%E7%A0%81%EF%BC%9A8889",target:"_blank",rel:"noopener noreferrer"},Kn=p('<h4 id="_4、水位传感器" tabindex="-1"><a class="header-anchor" href="#_4、水位传感器" aria-hidden="true">#</a> 4、水位传感器</h4><div style="display:flex;justify-content:center;gap:50px;"><img src="'+C+'" width="300"><img src="'+D+'" width="300"></div>',2),Yn=s("br",null,null,-1),Xn={href:"https://pan.baidu.com/s/15i3dfnr396_Riqrt5KNIFg?pwd=cupr",target:"_blank",rel:"noopener noreferrer"},Jn={href:"https://www.ixigua.com/6947472265965470239?utm_source=xiguastudio",target:"_blank",rel:"noopener noreferrer"},$n=p('<h4 id="_5、oled显示屏" tabindex="-1"><a class="header-anchor" href="#_5、oled显示屏" aria-hidden="true">#</a> 5、OLED显示屏</h4><div style="display:flex;justify-content:center;gap:50px;"><img src="'+e+'" width="300"><img src="'+t+'" width="300"></div>',2),Zn={href:"https://www.bilibili.com/opus/1019499397834080257",target:"_blank",rel:"noopener noreferrer"},Qn={href:"https://www.bilibili.com/opus/1019500909654179841",target:"_blank",rel:"noopener noreferrer"},sa={href:"https://pan.baidu.com/s/1l9Az0SOl7TOfX1HwjdqMjg?pwd=8889",target:"_blank",rel:"noopener noreferrer"},na={href:"https://pan.baidu.com/s/1Zp6dyui6dDvy03ossLSKnw?pwd=8889",target:"_blank",rel:"noopener noreferrer"},aa=p('<h4 id="_6、继电器" tabindex="-1"><a class="header-anchor" href="#_6、继电器" aria-hidden="true">#</a> 6、继电器</h4><div style="display:flex;justify-content:center;gap:50px;"><img src="'+b+'" width="300" height="300"><img src="'+E+'" width="300" height="300"></div><div style="display:flex;justify-content:center;gap:50px;"><img src="'+g+'" width="300" height="300"><img src="'+h+'" width="300" height="300"></div><h4 id="_7、雾化驱动" tabindex="-1"><a class="header-anchor" href="#_7、雾化驱动" aria-hidden="true">#</a> 7、雾化驱动</h4><div style="display:flex;justify-content:center;gap:50px;"><img src="'+f+'" width="300"><img src="'+q+'" width="300"></div><div style="display:flex;justify-content:center;gap:50px;"><img src="'+_+'" width="300" height="300"><img src="'+x+'" width="300" height="300"></div><h4 id="_8、水泵" tabindex="-1"><a class="header-anchor" href="#_8、水泵" aria-hidden="true">#</a> 8、水泵</h4><div style="display:flex;justify-content:center;gap:50px;"><img src="'+w+'" width="300"><img src="'+S+'" width="300"></div><h4 id="_9、增氧泵" tabindex="-1"><a class="header-anchor" href="#_9、增氧泵" aria-hidden="true">#</a> 9、增氧泵</h4><img src="'+k+'" width="300" height="300"><h4 id="_10、报警器" tabindex="-1"><a class="header-anchor" href="#_10、报警器" aria-hidden="true">#</a> 10、报警器</h4><img src="'+P+'" width="300" height="300"><h3 id="水质检测模块" tabindex="-1"><a class="header-anchor" href="#水质检测模块" aria-hidden="true">#</a> 水质检测模块：</h3><img src="'+I+'" alt="图片1" width="700"><p>以STM32系列单片机为核心设计水质检测系统，自行设计电源，选用PH传感器采集当前水体酸碱度， DS18B20温度采集、浊度传感器、OLED液晶显示，按键设置和蜂鸣器报警提醒构成。主要完成以下工作：</p><ul><li>基于STM32单片机水质检测设计方案。</li><li>温度传感器、PH、浊度传感器等与单片机的接口电路设计。</li><li>OLED液晶显示当前信息。</li><li>按键设置参数报警范围，通过蜂鸣器进行声光报警。</li><li>电源通过USB-5V供电为整个系统供电</li></ul><h4 id="_1、stm32f103c8t6开发板" tabindex="-1"><a class="header-anchor" href="#_1、stm32f103c8t6开发板" aria-hidden="true">#</a> 1、STM32F103C8T6开发板</h4><div style="display:flex;justify-content:center;gap:50px;"><img src="'+T+'" alt="图片1" width="300"><img src="'+L+'" alt="图片2" width="300"></div>',18),la={href:"https://pan.baidu.com/s/1voa4MsLO3xzu8Y-DC1J3OQ",target:"_blank",rel:"noopener noreferrer"},pa={href:"https://pan.baidu.com/s/13T5tt842yjWaCk66cwV8Pg?pwd=pirq",target:"_blank",rel:"noopener noreferrer"},oa=p('<h4 id="_2、ds18b20温度传感器" tabindex="-1"><a class="header-anchor" href="#_2、ds18b20温度传感器" aria-hidden="true">#</a> 2、DS18B20温度传感器</h4><div style="display:flex;justify-content:center;gap:50px;"><img src="'+R+'" alt="图片1" width="300"><img src="'+N+'" alt="图片2" width="300"></div><h4 id="_3、ph监测模块-ph电极探头" tabindex="-1"><a class="header-anchor" href="#_3、ph监测模块-ph电极探头" aria-hidden="true">#</a> 3、PH监测模块+PH电极探头</h4><img src="'+O+'" alt="图片1" width="300"><p>使用资料：</p>',5),ea={href:"https://pan.baidu.com/s/1NQ1DHlxOauFRJ2vkfJrxow",target:"_blank",rel:"noopener noreferrer"},ta=p('<p>提取码：1234</p><h4 id="_4、浊度传感器" tabindex="-1"><a class="header-anchor" href="#_4、浊度传感器" aria-hidden="true">#</a> 4、浊度传感器</h4><div style="display:flex;justify-content:center;gap:50px;"><img src="'+M+'" width="300"><img src="'+j+'" width="300"></div><img src="'+U+'" width="300">',4),ca={href:"https://pan.baidu.com/s/1npfhQQ3SwOPjhHAwqtPSNw?pwd=egc8",target:"_blank",rel:"noopener noreferrer"},Ba=p('<h4 id="_5、oled显示屏-1" tabindex="-1"><a class="header-anchor" href="#_5、oled显示屏-1" aria-hidden="true">#</a> 5、OLED显示屏</h4><div style="display:flex;justify-content:center;gap:50px;"><img src="'+e+'" width="300"><img src="'+t+'" width="300"></div><h4 id="_6、wifi模块" tabindex="-1"><a class="header-anchor" href="#_6、wifi模块" aria-hidden="true">#</a> 6、WIFI模块</h4><div style="display:flex;justify-content:center;gap:50px;"><img src="'+V+'" width="300"><img src="'+H+'" width="300"></div>',4),ra={href:"https://www.bilibili.com/opus/1069977233630691330",target:"_blank",rel:"noopener noreferrer"},ia=p('<h4 id="_7、蜂鸣器" tabindex="-1"><a class="header-anchor" href="#_7、蜂鸣器" aria-hidden="true">#</a> 7、蜂鸣器</h4><div style="display:flex;justify-content:center;gap:50px;"><img src="'+G+'" width="300"><img src="'+W+'" width="300"></div><h4 id="_8、自锁开关" tabindex="-1"><a class="header-anchor" href="#_8、自锁开关" aria-hidden="true">#</a> 8、自锁开关</h4><div style="display:flex;justify-content:center;gap:50px;"><img src="'+z+'" width="300"><img src="'+K+'" width="300"></div><h3 id="环境监测" tabindex="-1"><a class="header-anchor" href="#环境监测" aria-hidden="true">#</a> 环境监测</h3><h4 id="_1、溶解氧传感器" tabindex="-1"><a class="header-anchor" href="#_1、溶解氧传感器" aria-hidden="true">#</a> 1、溶解氧传感器</h4><div style="display:flex;justify-content:center;gap:50px;"><img src="'+Y+'" width="300"><img src="'+X+'" width="300"></div>',7),ya={href:"https://yunya.site/",target:"_blank",rel:"noopener noreferrer"},Aa=s("br",null,null,-1),da=s("br",null,null,-1),Fa=p('<h4 id="_2、风速传感器" tabindex="-1"><a class="header-anchor" href="#_2、风速传感器" aria-hidden="true">#</a> 2、风速传感器</h4><div style="display:flex;justify-content:center;gap:50px;"><img src="'+J+'" width="300"><img src="'+$+'" width="300"></div><h4 id="_3、风向传感器" tabindex="-1"><a class="header-anchor" href="#_3、风向传感器" aria-hidden="true">#</a> 3、风向传感器</h4><div style="display:flex;justify-content:center;gap:50px;"><img src="'+Z+'" width="300"><img src="'+Q+'" width="300"></div><h4 id="_4、光照传感器" tabindex="-1"><a class="header-anchor" href="#_4、光照传感器" aria-hidden="true">#</a> 4、光照传感器</h4><div style="display:flex;justify-content:center;gap:50px;"><img src="'+ss+'" width="300"><img src="'+ns+'" width="300"></div><h4 id="_5、有线摄像头" tabindex="-1"><a class="header-anchor" href="#_5、有线摄像头" aria-hidden="true">#</a> 5、有线摄像头</h4><div style="display:flex;justify-content:center;gap:50px;"><img src="'+as+'" width="300"><img src="'+ls+'" width="300"></div><h4 id="_6、esp32-cam摄像头" tabindex="-1"><a class="header-anchor" href="#_6、esp32-cam摄像头" aria-hidden="true">#</a> 6、ESP32-CAM摄像头</h4><div style="display:flex;justify-content:center;gap:50px;"><img src="'+ps+'" width="300"><img src="'+os+'" width="300"></div>',10),va={href:"https://www.bilibili.com/opus/1011714834051366936",target:"_blank",rel:"noopener noreferrer"},ua={href:"https://pan.baidu.com/s/1sS52Y4oghFh8jwgl9YQ3eg?pwd=8889",target:"_blank",rel:"noopener noreferrer"},ma=p('<h3 id="供电系统" tabindex="-1"><a class="header-anchor" href="#供电系统" aria-hidden="true">#</a> 供电系统</h3><div style="display:flex;justify-content:center;gap:50px;"><img src="'+es+'" width="300"><img src="'+ts+'" width="300"></div><h3 id="土壤监测" tabindex="-1"><a class="header-anchor" href="#土壤监测" aria-hidden="true">#</a> 土壤监测</h3><div style="display:flex;justify-content:center;gap:50px;"><img src="'+cs+'" width="300"><img src="'+Bs+'" width="300"></div><h3 id="ai小农" tabindex="-1"><a class="header-anchor" href="#ai小农" aria-hidden="true">#</a> AI小农</h3><div style="display:flex;justify-content:center;gap:50px;"><img src="'+rs+'" width="300"><img src="'+is+'" width="300"></div><div style="display:flex;justify-content:center;gap:50px;"><img src="'+ys+'" width="300"><img src="'+As+'" width="300"></div><h3 id="驱鸟车" tabindex="-1"><a class="header-anchor" href="#驱鸟车" aria-hidden="true">#</a> 驱鸟车</h3><div style="display:flex;justify-content:center;gap:50px;"><img src="'+ds+'" width="300"><img src="'+Fs+'" width="300"></div><h3 id="无人机" tabindex="-1"><a class="header-anchor" href="#无人机" aria-hidden="true">#</a> 无人机</h3><img src="'+vs+'" width="300"><h3 id="巡航船" tabindex="-1"><a class="header-anchor" href="#巡航船" aria-hidden="true">#</a> 巡航船</h3><img src="'+us+'" width="300"><h2 id="二、物联网程序开发" tabindex="-1"><a class="header-anchor" href="#二、物联网程序开发" aria-hidden="true">#</a> 二、物联网程序开发</h2><h3 id="esp8266开发" tabindex="-1"><a class="header-anchor" href="#esp8266开发" aria-hidden="true">#</a> ESP8266开发</h3><h4 id="_1、ch340串口驱动" tabindex="-1"><a class="header-anchor" href="#_1、ch340串口驱动" aria-hidden="true">#</a> 1、CH340串口驱动</h4>',16),Ca={href:"https://pan.baidu.com/s/10xkZRh0lhhMzrGsPKYjVlw?pwd=l9hj",target:"_blank",rel:"noopener noreferrer"},Da=s("p",null,"文件描述",-1),ba=s("p",null,"USB转串口Windows一键式安装驱动程序，支持CH340和CH341，支持32/64位Windows 11/10/8.1/8/7/VISTA/XP，SERVER 2022/2019/2016/2012/2008/2003，2000/ME/98，通过微软数字签名认证，支持USB转UART的3线和9线SERIAL串口等，用于随产品发行到最终用户。",-1),Ea=s("p",null,"适用范围",-1),ga=s("p",null,"CH340G，CH340T，CH340C，CH340N, CH340K, CH340E，CH340B，CH341A，CH341F, CH341T，CH341B，CH341C，CH341U",-1),ha=s("h4",{id:"_2、开发软件arduino",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#_2、开发软件arduino","aria-hidden":"true"},"#"),n(" 2、开发软件arduino")],-1),fa=s("p",null,"安装Arduino IDE 、ESP32离线包、ESP8266离线包",-1),qa={href:"https://pan.baidu.com/s/1LymkbGFzdjkwvs4E7MMi2g?pwd=8889",target:"_blank",rel:"noopener noreferrer"},_a=s("p",null,"添加附加开发板地址打开Arduino IDE菜单 > 文件 >首选项，在 附加开发板管理器网址 输入框中，填入以下网址：",-1),xa={href:"https://arduino.me/packages/esp32.json",target:"_blank",rel:"noopener noreferrer"},wa={href:"https://arduino.me/packages/esp8266.json",target:"_blank",rel:"noopener noreferrer"},Sa=p(`<h4 id="_3、程序开发" tabindex="-1"><a class="header-anchor" href="#_3、程序开发" aria-hidden="true">#</a> 3、程序开发</h4><div class="language-c++ line-numbers-mode" data-ext="c++"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#C678DD;">#define</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">BLYNK_PRINT</span><span style="color:#ABB2BF;"> Serial</span></span>
<span class="line"><span style="color:#C678DD;">#include</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&lt;U8g2lib.h&gt;</span></span>
<span class="line"><span style="color:#C678DD;">#include</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&lt;Wire.h&gt;</span></span>
<span class="line"><span style="color:#C678DD;">#include</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&lt;ESP8266WiFi.h&gt;</span></span>
<span class="line"><span style="color:#C678DD;">#include</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&lt;BlynkSimpleEsp8266.h&gt;</span></span>
<span class="line"><span style="color:#C678DD;">#include</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&lt;DHT.h&gt;</span></span>
<span class="line"><span style="color:#C678DD;">#include</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&lt;ESP8266WebServer.h&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E5C07B;">ESP8266WebServer</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">localServer</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">80</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#E5C07B;">U8G2_SSD1306_128X64_NONAME_1_SW_I2C</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">u8g2</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">U8G2_R0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">U8X8_PIN_NONE</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// 配置信息</span></span>
<span class="line"><span style="color:#C678DD;">char</span><span style="color:#ABB2BF;"> auth[] </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;08cc7b9ef4f84ec9a17b87ee06594ffa&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">char</span><span style="color:#ABB2BF;"> ssid[] </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;test_wifi&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">char</span><span style="color:#ABB2BF;"> pass[] </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;123456888&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">BlynkTimer timer;</span></span>
<span class="line"><span style="color:#E5C07B;">DHT</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">dht02</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">11</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">int</span><span style="color:#ABB2BF;"> vpin_value;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// 传感器状态</span></span>
<span class="line"><span style="color:#C678DD;">struct</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">SensorStatus</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">bool</span><span style="color:#ABB2BF;"> dhtConnected </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">true</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">bool</span><span style="color:#ABB2BF;"> soilSensorConnected </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">true</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">unsigned</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">long</span><span style="color:#ABB2BF;"> lastDHTRead </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">SensorStatus sensorStatus;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">void</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">sendSensorData</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">float</span><span style="color:#ABB2BF;"> temp </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> NAN;</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">float</span><span style="color:#ABB2BF;"> humi </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> NAN;</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">int</span><span style="color:#ABB2BF;"> soil </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  // 读取DHT传感器（限制读取频率）</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#61AFEF;">millis</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">-</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">sensorStatus</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">lastDHTRead</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">&gt;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">2000</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">    temp </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">dht02</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">readTemperature</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">    humi </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">dht02</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">readHumidity</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">sensorStatus</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">lastDHTRead</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">millis</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#61AFEF;">isnan</span><span style="color:#ABB2BF;">(temp) </span><span style="color:#56B6C2;">||</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">isnan</span><span style="color:#ABB2BF;">(humi)) {</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E5C07B;">sensorStatus</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">dhtConnected</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">false</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    } </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E5C07B;">sensorStatus</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">dhtConnected</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">true</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">  soil </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">analogRead</span><span style="color:#ABB2BF;">(A0);</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">sensorStatus</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">soilSensorConnected</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> (soil </span><span style="color:#C678DD;">!=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">&amp;&amp;</span><span style="color:#ABB2BF;"> soil </span><span style="color:#C678DD;">!=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">1023</span><span style="color:#ABB2BF;">);</span><span style="color:#7F848E;font-style:italic;"> // 0或1023通常表示传感器问题</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  // 发送到Blynk</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">Blynk</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">virtualWrite</span><span style="color:#ABB2BF;">(V0, </span><span style="color:#E5C07B;">sensorStatus</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">dhtConnected</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">?</span><span style="color:#ABB2BF;"> temp </span><span style="color:#C678DD;">:</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">Blynk</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">virtualWrite</span><span style="color:#ABB2BF;">(V1, </span><span style="color:#E5C07B;">sensorStatus</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">dhtConnected</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">?</span><span style="color:#ABB2BF;"> humi </span><span style="color:#C678DD;">:</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">Blynk</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">virtualWrite</span><span style="color:#ABB2BF;">(V2, </span><span style="color:#E5C07B;">sensorStatus</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">soilSensorConnected</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">?</span><span style="color:#ABB2BF;"> soil </span><span style="color:#C678DD;">:</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">void</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">displaySensorData</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">u8g2</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">firstPage</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">do</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">u8g2</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">setFont</span><span style="color:#ABB2BF;">(u8g2_font_unifont_t_chinese3);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">u8g2</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">setFontPosTop</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    // 温度</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">u8g2</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">setCursor</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#56B6C2;">!</span><span style="color:#E5C07B;">sensorStatus</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">dhtConnected</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E5C07B;">u8g2</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;wendu: ERROR&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    } </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E5C07B;">u8g2</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">print</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">String</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;wendu: &quot;</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">String</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">dht02</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">readTemperature</span><span style="color:#ABB2BF;">()));</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E5C07B;">u8g2</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">drawCircle</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">95</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">, U8G2_DRAW_ALL);</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E5C07B;">u8g2</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">setCursor</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">100</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E5C07B;">u8g2</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;C&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    // 湿度</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">u8g2</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">setCursor</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">20</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#56B6C2;">!</span><span style="color:#E5C07B;">sensorStatus</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">dhtConnected</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E5C07B;">u8g2</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;shidu: ERROR&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    } </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E5C07B;">u8g2</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">print</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">String</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;shidu: &quot;</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">String</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">dht02</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">readHumidity</span><span style="color:#ABB2BF;">()) </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;%&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    // 水位</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">u8g2</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">setCursor</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">40</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#56B6C2;">!</span><span style="color:#E5C07B;">sensorStatus</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">soilSensorConnected</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E5C07B;">u8g2</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;shuiwei: ERROR&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    } </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E5C07B;">u8g2</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">print</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">String</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;shuiwei: &quot;</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">String</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">analogRead</span><span style="color:#ABB2BF;">(A0)));</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">  } </span><span style="color:#C678DD;">while</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">u8g2</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">nextPage</span><span style="color:#ABB2BF;">());</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">BLYNK_WRITE</span><span style="color:#ABB2BF;">(V3) {</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#61AFEF;">digitalWrite</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">param</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">asInt</span><span style="color:#ABB2BF;">() </span><span style="color:#C678DD;">?</span><span style="color:#ABB2BF;"> HIGH </span><span style="color:#C678DD;">:</span><span style="color:#ABB2BF;"> LOW);</span><span style="color:#7F848E;font-style:italic;">  // D1 → GPIO5</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#61AFEF;">BLYNK_WRITE</span><span style="color:#ABB2BF;">(V4) {</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#61AFEF;">digitalWrite</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">param</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">asInt</span><span style="color:#ABB2BF;">() </span><span style="color:#C678DD;">?</span><span style="color:#ABB2BF;"> HIGH </span><span style="color:#C678DD;">:</span><span style="color:#ABB2BF;"> LOW);</span><span style="color:#7F848E;font-style:italic;">  // D2 → GPIO4</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#61AFEF;">BLYNK_WRITE</span><span style="color:#ABB2BF;">(V5) {</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#61AFEF;">digitalWrite</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">param</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">asInt</span><span style="color:#ABB2BF;">() </span><span style="color:#C678DD;">?</span><span style="color:#ABB2BF;"> HIGH </span><span style="color:#C678DD;">:</span><span style="color:#ABB2BF;"> LOW);</span><span style="color:#7F848E;font-style:italic;">  // D3 → GPIO0</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#61AFEF;">BLYNK_WRITE</span><span style="color:#ABB2BF;">(V6) {</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#61AFEF;">digitalWrite</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">14</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">param</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">asInt</span><span style="color:#ABB2BF;">() </span><span style="color:#C678DD;">?</span><span style="color:#ABB2BF;"> HIGH </span><span style="color:#C678DD;">:</span><span style="color:#ABB2BF;"> LOW);</span><span style="color:#7F848E;font-style:italic;"> // D5 → GPIO14</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#61AFEF;">BLYNK_WRITE</span><span style="color:#ABB2BF;">(V7) {</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#61AFEF;">digitalWrite</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">12</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">param</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">asInt</span><span style="color:#ABB2BF;">() </span><span style="color:#C678DD;">?</span><span style="color:#ABB2BF;"> HIGH </span><span style="color:#C678DD;">:</span><span style="color:#ABB2BF;"> LOW);</span><span style="color:#7F848E;font-style:italic;"> // D6 → GPIO12</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#61AFEF;">BLYNK_WRITE</span><span style="color:#ABB2BF;">(V8) {</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#61AFEF;">digitalWrite</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">13</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">param</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">asInt</span><span style="color:#ABB2BF;">() </span><span style="color:#C678DD;">?</span><span style="color:#ABB2BF;"> HIGH </span><span style="color:#C678DD;">:</span><span style="color:#ABB2BF;"> LOW);</span><span style="color:#7F848E;font-style:italic;"> // D7 → GPIO13</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">void</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">handleSensors</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">float</span><span style="color:#ABB2BF;"> temp </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">dht02</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">readTemperature</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">float</span><span style="color:#ABB2BF;"> humi </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">dht02</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">readHumidity</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">int</span><span style="color:#ABB2BF;"> waterLevel </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">analogRead</span><span style="color:#ABB2BF;">(A0);</span></span>
<span class="line"><span style="color:#ABB2BF;">  String json </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;{&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">  json </span><span style="color:#C678DD;">+=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;</span><span style="color:#56B6C2;">\\&quot;</span><span style="color:#98C379;">status</span><span style="color:#56B6C2;">\\&quot;</span><span style="color:#98C379;">:{&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">  json </span><span style="color:#C678DD;">+=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;</span><span style="color:#56B6C2;">\\&quot;</span><span style="color:#98C379;">dht</span><span style="color:#56B6C2;">\\&quot;</span><span style="color:#98C379;">:&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">String</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">sensorStatus</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">dhtConnected</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">?</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">:</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;,&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">  json </span><span style="color:#C678DD;">+=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;</span><span style="color:#56B6C2;">\\&quot;</span><span style="color:#98C379;">soil</span><span style="color:#56B6C2;">\\&quot;</span><span style="color:#98C379;">:&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">String</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">sensorStatus</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">soilSensorConnected</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">?</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">:</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">  json </span><span style="color:#C678DD;">+=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;},&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">  json </span><span style="color:#C678DD;">+=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;</span><span style="color:#56B6C2;">\\&quot;</span><span style="color:#98C379;">data</span><span style="color:#56B6C2;">\\&quot;</span><span style="color:#98C379;">:{&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">  json </span><span style="color:#C678DD;">+=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;</span><span style="color:#56B6C2;">\\&quot;</span><span style="color:#98C379;">temperature</span><span style="color:#56B6C2;">\\&quot;</span><span style="color:#98C379;">:&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">sensorStatus</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">dhtConnected</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">?</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">String</span><span style="color:#ABB2BF;">(temp) </span><span style="color:#C678DD;">:</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;null&quot;</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;,&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">  json </span><span style="color:#C678DD;">+=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;</span><span style="color:#56B6C2;">\\&quot;</span><span style="color:#98C379;">humidity</span><span style="color:#56B6C2;">\\&quot;</span><span style="color:#98C379;">:&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">sensorStatus</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">dhtConnected</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">?</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">String</span><span style="color:#ABB2BF;">(humi) </span><span style="color:#C678DD;">:</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;null&quot;</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;,&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">  json </span><span style="color:#C678DD;">+=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;</span><span style="color:#56B6C2;">\\&quot;</span><span style="color:#98C379;">water_level</span><span style="color:#56B6C2;">\\&quot;</span><span style="color:#98C379;">:&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">sensorStatus</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">soilSensorConnected</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">?</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">String</span><span style="color:#ABB2BF;">(waterLevel) </span><span style="color:#C678DD;">:</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;null&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">  json </span><span style="color:#C678DD;">+=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;}}&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">localServer</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">send</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">200</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;application/json&quot;</span><span style="color:#ABB2BF;">, json);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">void</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">handleControl</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#56B6C2;">!</span><span style="color:#E5C07B;">localServer</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">hasArg</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;pin&quot;</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">||</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">!</span><span style="color:#E5C07B;">localServer</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">hasArg</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;state&quot;</span><span style="color:#ABB2BF;">)) {</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">localServer</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">send</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">400</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;application/json&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                     </span><span style="color:#98C379;">&quot;{</span><span style="color:#56B6C2;">\\&quot;</span><span style="color:#98C379;">code</span><span style="color:#56B6C2;">\\&quot;</span><span style="color:#98C379;">:400,</span><span style="color:#56B6C2;">\\&quot;</span><span style="color:#98C379;">error</span><span style="color:#56B6C2;">\\&quot;</span><span style="color:#98C379;">:</span><span style="color:#56B6C2;">\\&quot;</span><span style="color:#98C379;">Missing &#39;pin&#39; or &#39;state&#39;</span><span style="color:#56B6C2;">\\&quot;</span><span style="color:#98C379;">}&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">  String pinStr </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">localServer</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">arg</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;pin&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">  String stateStr </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">localServer</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">arg</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;state&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (pinStr </span><span style="color:#C678DD;">!=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;V3&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">&amp;&amp;</span><span style="color:#ABB2BF;"> pinStr </span><span style="color:#C678DD;">!=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;V4&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">&amp;&amp;</span><span style="color:#ABB2BF;"> pinStr </span><span style="color:#C678DD;">!=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;V5&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">&amp;&amp;</span></span>
<span class="line"><span style="color:#ABB2BF;">      pinStr </span><span style="color:#C678DD;">!=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;V6&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">&amp;&amp;</span><span style="color:#ABB2BF;"> pinStr </span><span style="color:#C678DD;">!=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;V7&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">&amp;&amp;</span><span style="color:#ABB2BF;"> pinStr </span><span style="color:#C678DD;">!=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;V8&quot;</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">localServer</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">send</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">400</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;application/json&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                     </span><span style="color:#98C379;">&quot;{</span><span style="color:#56B6C2;">\\&quot;</span><span style="color:#98C379;">code</span><span style="color:#56B6C2;">\\&quot;</span><span style="color:#98C379;">:400,</span><span style="color:#56B6C2;">\\&quot;</span><span style="color:#98C379;">error</span><span style="color:#56B6C2;">\\&quot;</span><span style="color:#98C379;">:</span><span style="color:#56B6C2;">\\&quot;</span><span style="color:#98C379;">Invalid &#39;pin&#39;</span><span style="color:#56B6C2;">\\&quot;</span><span style="color:#98C379;">}&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">int</span><span style="color:#ABB2BF;"> pin;</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (pinStr </span><span style="color:#C678DD;">==</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;V3&quot;</span><span style="color:#ABB2BF;">) pin </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (pinStr </span><span style="color:#C678DD;">==</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;V4&quot;</span><span style="color:#ABB2BF;">) pin </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (pinStr </span><span style="color:#C678DD;">==</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;V5&quot;</span><span style="color:#ABB2BF;">) pin </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (pinStr </span><span style="color:#C678DD;">==</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;V6&quot;</span><span style="color:#ABB2BF;">) pin </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">14</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (pinStr </span><span style="color:#C678DD;">==</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;V7&quot;</span><span style="color:#ABB2BF;">) pin </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">12</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (pinStr </span><span style="color:#C678DD;">==</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;V8&quot;</span><span style="color:#ABB2BF;">) pin </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">13</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">bool</span><span style="color:#ABB2BF;"> state </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> (stateStr </span><span style="color:#C678DD;">==</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;1&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#61AFEF;">digitalWrite</span><span style="color:#ABB2BF;">(pin, state </span><span style="color:#C678DD;">?</span><span style="color:#ABB2BF;"> HIGH </span><span style="color:#C678DD;">:</span><span style="color:#ABB2BF;"> LOW);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">  String response </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;{</span><span style="color:#56B6C2;">\\&quot;</span><span style="color:#98C379;">code</span><span style="color:#56B6C2;">\\&quot;</span><span style="color:#98C379;">:200,</span><span style="color:#56B6C2;">\\&quot;</span><span style="color:#98C379;">pin</span><span style="color:#56B6C2;">\\&quot;</span><span style="color:#98C379;">:</span><span style="color:#56B6C2;">\\&quot;</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> pinStr </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;</span><span style="color:#56B6C2;">\\&quot;</span><span style="color:#98C379;">,</span><span style="color:#56B6C2;">\\&quot;</span><span style="color:#98C379;">state</span><span style="color:#56B6C2;">\\&quot;</span><span style="color:#98C379;">:&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> stateStr </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;}&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">localServer</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">send</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">200</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;application/json&quot;</span><span style="color:#ABB2BF;">, response);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">void</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">setup</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">u8g2</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">setI2CAddress</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">0x</span><span style="color:#D19A66;">3C</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">*</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">u8g2</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">begin</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">Serial</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">begin</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">9600</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">Blynk</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">begin</span><span style="color:#ABB2BF;">(auth, ssid, pass, </span><span style="color:#61AFEF;">IPAddress</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">182</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">61</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">28</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">31</span><span style="color:#ABB2BF;">), </span><span style="color:#D19A66;">8080</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">dht02</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">begin</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">u8g2</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">enableUTF8Print</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#61AFEF;">pinMode</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">, OUTPUT);</span><span style="color:#7F848E;font-style:italic;">   // D1</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#61AFEF;">pinMode</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">, OUTPUT);</span><span style="color:#7F848E;font-style:italic;">   // D2</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#61AFEF;">pinMode</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, OUTPUT);</span><span style="color:#7F848E;font-style:italic;">   // D3</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#61AFEF;">pinMode</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">14</span><span style="color:#ABB2BF;">, OUTPUT);</span><span style="color:#7F848E;font-style:italic;">  // D5</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#61AFEF;">pinMode</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">12</span><span style="color:#ABB2BF;">, OUTPUT);</span><span style="color:#7F848E;font-style:italic;">  // D6</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#61AFEF;">pinMode</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">13</span><span style="color:#ABB2BF;">, OUTPUT);</span><span style="color:#7F848E;font-style:italic;">  // D7</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">timer</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">setInterval</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">2000</span><span style="color:#E06C75;">L</span><span style="color:#ABB2BF;">, sendSensorData);</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">timer</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">setInterval</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1000</span><span style="color:#E06C75;">L</span><span style="color:#ABB2BF;">, displaySensorData);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">localServer</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">on</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;/sensors&quot;</span><span style="color:#ABB2BF;">, handleSensors);</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">localServer</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">on</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;/control&quot;</span><span style="color:#ABB2BF;">, HTTP_GET, handleControl);</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">localServer</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">begin</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">void</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">loop</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">Blynk</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">run</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">timer</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">run</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">localServer</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">handleClient</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_4、烧录步骤" tabindex="-1"><a class="header-anchor" href="#_4、烧录步骤" aria-hidden="true">#</a> 4、烧录步骤</h4><p>将ESP8266通过USB链接电脑</p><img src="`+ms+'" width="800"><p>查询串行端口</p><img src="'+o+'" width="800"><img src="'+Cs+'" width="800"><p>选择库：打开开发工具--&gt;导入程序--&gt;工具栏(工具)--&gt;开发板--&gt;ESP8266</p><img src="'+Ds+'" width="800"><p>开发工具中选择端口：工具--&gt;端口--&gt;串行端口</p><img src="'+bs+'" width="800"><p>编译程序：①和②选择无误后，点击③，出现④表示程序正在编译</p><img src="'+Es+'" width="800"><p>程序上传至开发板：出现①中白色字体内容，表示编程成功，点击②的按钮上传程序到开发板</p><img src="'+gs+'" width="800"><p>程序烧录成功</p><img src="'+hs+'" width="800"><h3 id="stm32开发" tabindex="-1"><a class="header-anchor" href="#stm32开发" aria-hidden="true">#</a> STM32开发</h3><h4 id="_1、ch340串口驱动-1" tabindex="-1"><a class="header-anchor" href="#_1、ch340串口驱动-1" aria-hidden="true">#</a> 1、CH340串口驱动</h4>',20),ka={href:"https://pan.baidu.com/s/10xkZRh0lhhMzrGsPKYjVlw?pwd=l9hj",target:"_blank",rel:"noopener noreferrer"},Pa=s("p",null,"文件描述",-1),Ia=s("p",null,"USB转串口Windows一键式安装驱动程序，支持CH340和CH341，支持32/64位Windows 11/10/8.1/8/7/VISTA/XP，SERVER 2022/2019/2016/2012/2008/2003，2000/ME/98，通过微软数字签名认证，支持USB转UART的3线和9线SERIAL串口等，用于随产品发行到最终用户。",-1),Ta=s("p",null,"适用范围",-1),La=s("p",null,"CH340G，CH340T，CH340C，CH340N, CH340K, CH340E，CH340B，CH341A，CH341F, CH341T，CH341B，CH341C，CH341U",-1),Ra=s("h4",{id:"_2、开发软件keil",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#_2、开发软件keil","aria-hidden":"true"},"#"),n(" 2、开发软件Keil")],-1),Na=s("p",null,"Keil uVision 5 MDK版软件安装包下载及安装教程",-1),Oa={href:"https://zhuanlan.zhihu.com/p/1903019173711418696",target:"_blank",rel:"noopener noreferrer"},Ma=p(`<h4 id="_3、程序开发-1" tabindex="-1"><a class="header-anchor" href="#_3、程序开发-1" aria-hidden="true">#</a> 3、程序开发</h4><div class="language-c line-numbers-mode" data-ext="c"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// 主程序入口main.c</span></span>
<span class="line"><span style="color:#C678DD;">#include</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;sys.h&quot;</span></span>
<span class="line"><span style="color:#C678DD;">#include</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;delay.h&quot;</span></span>
<span class="line"><span style="color:#C678DD;">#include</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;gpio.h&quot;</span></span>
<span class="line"><span style="color:#C678DD;">#include</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;OLED_I2C.h&quot;</span></span>
<span class="line"><span style="color:#C678DD;">#include</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;ds18b20.h&quot;</span></span>
<span class="line"><span style="color:#C678DD;">#include</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;usart1.h&quot;</span></span>
<span class="line"><span style="color:#C678DD;">#include</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;usart3.h&quot;</span></span>
<span class="line"><span style="color:#C678DD;">#include</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;esp8266.h&quot;</span></span>
<span class="line"><span style="color:#C678DD;">#include</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;adc.h&quot;</span></span>
<span class="line"><span style="color:#C678DD;">#include</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&lt;stdio.h&gt;</span></span>
<span class="line"><span style="color:#C678DD;">#include</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&lt;stdlib.h&gt;</span></span>
<span class="line"><span style="color:#C678DD;">#include</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&lt;string.h&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">#define</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">RATIO</span><span style="color:#ABB2BF;">  </span><span style="color:#D19A66;">4.51</span><span style="color:#C678DD;">/</span><span style="color:#D19A66;">4.08</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2;">dataPoint_t</span><span style="color:#ABB2BF;"> DataPoint;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">u8    tempSetVal</span><span style="color:#C678DD;">=</span><span style="color:#D19A66;">40</span><span style="color:#ABB2BF;">;</span><span style="color:#7F848E;font-style:italic;">  //温度上限</span></span>
<span class="line"><span style="color:#ABB2BF;">u8 shuaxin </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">;</span><span style="color:#7F848E;font-style:italic;">  //刷新标志</span></span>
<span class="line"><span style="color:#ABB2BF;">u8 setFlag </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">;</span><span style="color:#7F848E;font-style:italic;">  //设置标志</span></span>
<span class="line"><span style="color:#ABB2BF;">u16 Ph_min </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">300</span><span style="color:#ABB2BF;">,Ph_max </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">900</span><span style="color:#ABB2BF;">;</span><span style="color:#7F848E;font-style:italic;">   //PH下限上限</span></span>
<span class="line"><span style="color:#ABB2BF;">u16 TurSetMax</span><span style="color:#C678DD;">=</span><span style="color:#D19A66;">1000</span><span style="color:#ABB2BF;">;</span><span style="color:#7F848E;font-style:italic;">  //浊度上限</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">unsigned</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">long</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">int</span><span style="color:#ABB2BF;"> avgValue;</span><span style="color:#7F848E;font-style:italic;">	//Store the average value of the sensor feedback </span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">char</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">display</span><span style="color:#ABB2BF;">[</span><span style="color:#D19A66;">16</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">void</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">InitDisplay</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">void</span><span style="color:#ABB2BF;">)</span><span style="color:#7F848E;font-style:italic;">   //初始化显示</span></span>
<span class="line"><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">	  </span><span style="color:#C678DD;">unsigned</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">char</span><span style="color:#ABB2BF;"> i</span><span style="color:#C678DD;">=</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">	  </span></span>
<span class="line"><span style="color:#ABB2BF;">	  </span><span style="color:#61AFEF;">OLED_ShowStr</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;PH:&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	  </span><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;">(i</span><span style="color:#C678DD;">=</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">;i</span><span style="color:#C678DD;">&lt;</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">;i</span><span style="color:#C678DD;">++</span><span style="color:#ABB2BF;">)</span><span style="color:#61AFEF;">OLED_ShowCN</span><span style="color:#ABB2BF;">(i</span><span style="color:#C678DD;">*</span><span style="color:#D19A66;">16</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">,i</span><span style="color:#C678DD;">+</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">);</span><span style="color:#7F848E;font-style:italic;">//显示中文：温度</span></span>
<span class="line"><span style="color:#ABB2BF;">	  </span><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;">(i</span><span style="color:#C678DD;">=</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">;i</span><span style="color:#C678DD;">&lt;</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">;i</span><span style="color:#C678DD;">++</span><span style="color:#ABB2BF;">)</span><span style="color:#61AFEF;">OLED_ShowCN</span><span style="color:#ABB2BF;">(i</span><span style="color:#C678DD;">*</span><span style="color:#D19A66;">16</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;">6</span><span style="color:#ABB2BF;">,i</span><span style="color:#C678DD;">+</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">);</span><span style="color:#7F848E;font-style:italic;">//显示中文：浊度</span></span>
<span class="line"><span style="color:#ABB2BF;">	  </span><span style="color:#61AFEF;">OLED_ShowChar</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">32</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">,</span><span style="color:#98C379;">&#39;:&#39;</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	  </span><span style="color:#61AFEF;">OLED_ShowChar</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">32</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;">6</span><span style="color:#ABB2BF;">,</span><span style="color:#98C379;">&#39;:&#39;</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">void</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">displaySetValue</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">void</span><span style="color:#ABB2BF;">)</span><span style="color:#7F848E;font-style:italic;">  //显示设置的值</span></span>
<span class="line"><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">	  </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;">(setFlag </span><span style="color:#C678DD;">==</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">||</span><span style="color:#ABB2BF;">setFlag </span><span style="color:#C678DD;">==</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">		{</span></span>
<span class="line"><span style="color:#ABB2BF;">				</span><span style="color:#61AFEF;">sprintf</span><span style="color:#ABB2BF;">(display,</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">%5.2f</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">,(</span><span style="color:#C678DD;">float</span><span style="color:#ABB2BF;">)Ph_min</span><span style="color:#C678DD;">/</span><span style="color:#D19A66;">100</span><span style="color:#ABB2BF;">); </span></span>
<span class="line"><span style="color:#ABB2BF;">				</span><span style="color:#61AFEF;">OLED_ShowStr</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">40</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">,(u8 </span><span style="color:#C678DD;">*</span><span style="color:#ABB2BF;">)display, </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">,setFlag</span><span style="color:#C678DD;">+</span><span style="color:#D19A66;">1</span><span style="color:#C678DD;">-</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">			</span></span>
<span class="line"><span style="color:#ABB2BF;">				</span><span style="color:#61AFEF;">sprintf</span><span style="color:#ABB2BF;">(display,</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">%5.2f</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">,(</span><span style="color:#C678DD;">float</span><span style="color:#ABB2BF;">)Ph_max</span><span style="color:#C678DD;">/</span><span style="color:#D19A66;">100</span><span style="color:#ABB2BF;">); </span></span>
<span class="line"><span style="color:#ABB2BF;">				</span><span style="color:#61AFEF;">OLED_ShowStr</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">40</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">6</span><span style="color:#ABB2BF;">,(u8 </span><span style="color:#C678DD;">*</span><span style="color:#ABB2BF;">)display, </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">,setFlag</span><span style="color:#C678DD;">+</span><span style="color:#D19A66;">1</span><span style="color:#C678DD;">-</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;">(setFlag </span><span style="color:#C678DD;">==</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">		{</span></span>
<span class="line"><span style="color:#ABB2BF;">				</span><span style="color:#61AFEF;">sprintf</span><span style="color:#ABB2BF;">(display,</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">%02d</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">,tempSetVal); </span></span>
<span class="line"><span style="color:#ABB2BF;">				</span><span style="color:#61AFEF;">OLED_ShowStr</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">40</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">,(u8 </span><span style="color:#C678DD;">*</span><span style="color:#ABB2BF;">)display, </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">,setFlag</span><span style="color:#C678DD;">+</span><span style="color:#D19A66;">1</span><span style="color:#C678DD;">-</span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;">(setFlag </span><span style="color:#C678DD;">==</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">		{</span></span>
<span class="line"><span style="color:#ABB2BF;">				</span><span style="color:#61AFEF;">sprintf</span><span style="color:#ABB2BF;">(display,</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">%04d</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">,TurSetMax); </span></span>
<span class="line"><span style="color:#ABB2BF;">				</span><span style="color:#61AFEF;">OLED_ShowStr</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">40</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">,(u8 </span><span style="color:#C678DD;">*</span><span style="color:#ABB2BF;">)display, </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">,setFlag</span><span style="color:#C678DD;">+</span><span style="color:#D19A66;">1</span><span style="color:#C678DD;">-</span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">void</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">keyscan</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">void</span><span style="color:#ABB2BF;">)</span><span style="color:#7F848E;font-style:italic;">   //按键扫描</span></span>
<span class="line"><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">	 </span><span style="color:#C678DD;">unsigned</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">char</span><span style="color:#ABB2BF;"> i</span><span style="color:#C678DD;">=</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span></span>
<span class="line"><span style="color:#ABB2BF;">	 </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;">(KEY1 </span><span style="color:#C678DD;">==</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">)</span><span style="color:#7F848E;font-style:italic;"> //设置键</span></span>
<span class="line"><span style="color:#ABB2BF;">	 {</span></span>
<span class="line"><span style="color:#ABB2BF;">			</span><span style="color:#61AFEF;">delay_ms</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">20</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">		  </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;">(KEY1 </span><span style="color:#C678DD;">==</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">			{</span></span>
<span class="line"><span style="color:#ABB2BF;">					</span><span style="color:#C678DD;">while</span><span style="color:#ABB2BF;">(KEY1 </span><span style="color:#C678DD;">==</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">				  BEEP</span><span style="color:#C678DD;">=</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">				  setFlag </span><span style="color:#C678DD;">++</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">				  </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;">(setFlag </span><span style="color:#C678DD;">==</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">					{</span></span>
<span class="line"><span style="color:#ABB2BF;">							</span><span style="color:#61AFEF;">OLED_CLS</span><span style="color:#ABB2BF;">();</span><span style="color:#7F848E;font-style:italic;">    //清屏</span></span>
<span class="line"><span style="color:#ABB2BF;">						  </span><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;">(i</span><span style="color:#C678DD;">=</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">;i</span><span style="color:#C678DD;">&lt;</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">;i</span><span style="color:#C678DD;">++</span><span style="color:#ABB2BF;">)</span><span style="color:#61AFEF;">OLED_ShowCN</span><span style="color:#ABB2BF;">(i</span><span style="color:#C678DD;">*</span><span style="color:#D19A66;">16</span><span style="color:#C678DD;">+</span><span style="color:#D19A66;">32</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">,i</span><span style="color:#C678DD;">+</span><span style="color:#D19A66;">8</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">);</span><span style="color:#7F848E;font-style:italic;">//显示中文：设置</span></span>
<span class="line"><span style="color:#ABB2BF;">						  </span><span style="color:#61AFEF;">OLED_ShowStr</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">62</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot; PH&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">						  </span><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;">(i</span><span style="color:#C678DD;">=</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">;i</span><span style="color:#C678DD;">&lt;</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">;i</span><span style="color:#C678DD;">++</span><span style="color:#ABB2BF;">)</span><span style="color:#61AFEF;">OLED_ShowCN</span><span style="color:#ABB2BF;">(i</span><span style="color:#C678DD;">*</span><span style="color:#D19A66;">16</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">,i</span><span style="color:#C678DD;">+</span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">);</span><span style="color:#7F848E;font-style:italic;">//显示中文：下限</span></span>
<span class="line"><span style="color:#ABB2BF;">							</span><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;">(i</span><span style="color:#C678DD;">=</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">;i</span><span style="color:#C678DD;">&lt;</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">;i</span><span style="color:#C678DD;">++</span><span style="color:#ABB2BF;">)</span><span style="color:#61AFEF;">OLED_ShowCN</span><span style="color:#ABB2BF;">(i</span><span style="color:#C678DD;">*</span><span style="color:#D19A66;">16</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;">6</span><span style="color:#ABB2BF;">,i</span><span style="color:#C678DD;">+</span><span style="color:#D19A66;">6</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">);</span><span style="color:#7F848E;font-style:italic;">//显示中文：上限</span></span>
<span class="line"><span style="color:#ABB2BF;">						  </span><span style="color:#61AFEF;">OLED_ShowChar</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">32</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">,</span><span style="color:#98C379;">&#39;:&#39;</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">						  </span><span style="color:#61AFEF;">OLED_ShowChar</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">32</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;">6</span><span style="color:#ABB2BF;">,</span><span style="color:#98C379;">&#39;:&#39;</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">						  </span></span>
<span class="line"><span style="color:#ABB2BF;">					}</span></span>
<span class="line"><span style="color:#ABB2BF;">					</span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;">(setFlag </span><span style="color:#C678DD;">==</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">					{</span></span>
<span class="line"><span style="color:#ABB2BF;">							</span><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;">(i</span><span style="color:#C678DD;">=</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">;i</span><span style="color:#C678DD;">&lt;</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">;i</span><span style="color:#C678DD;">++</span><span style="color:#ABB2BF;">)</span><span style="color:#61AFEF;">OLED_ShowCN</span><span style="color:#ABB2BF;">(i</span><span style="color:#C678DD;">*</span><span style="color:#D19A66;">16</span><span style="color:#C678DD;">+</span><span style="color:#D19A66;">64</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">,i</span><span style="color:#C678DD;">+</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">);</span><span style="color:#7F848E;font-style:italic;">//显示中文：温度</span></span>
<span class="line"><span style="color:#ABB2BF;">						  </span><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;">(i</span><span style="color:#C678DD;">=</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">;i</span><span style="color:#C678DD;">&lt;</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">;i</span><span style="color:#C678DD;">++</span><span style="color:#ABB2BF;">)</span><span style="color:#61AFEF;">OLED_ShowCN</span><span style="color:#ABB2BF;">(i</span><span style="color:#C678DD;">*</span><span style="color:#D19A66;">16</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">,i</span><span style="color:#C678DD;">+</span><span style="color:#D19A66;">6</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">);</span><span style="color:#7F848E;font-style:italic;">//显示中文：上限</span></span>
<span class="line"><span style="color:#ABB2BF;">						  </span><span style="color:#61AFEF;">OLED_ShowStr</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">56</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;        &quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">						  </span><span style="color:#61AFEF;">OLED_ShowCentigrade</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">56</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">);</span><span style="color:#7F848E;font-style:italic;">    //℃</span></span>
<span class="line"><span style="color:#ABB2BF;">						  </span><span style="color:#61AFEF;">OLED_ShowStr</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">6</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;                &quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">					}</span></span>
<span class="line"><span style="color:#ABB2BF;">					</span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;">(setFlag </span><span style="color:#C678DD;">==</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">					{</span></span>
<span class="line"><span style="color:#ABB2BF;">							</span><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;">(i</span><span style="color:#C678DD;">=</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">;i</span><span style="color:#C678DD;">&lt;</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">;i</span><span style="color:#C678DD;">++</span><span style="color:#ABB2BF;">)</span><span style="color:#61AFEF;">OLED_ShowCN</span><span style="color:#ABB2BF;">(i</span><span style="color:#C678DD;">*</span><span style="color:#D19A66;">16</span><span style="color:#C678DD;">+</span><span style="color:#D19A66;">64</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">,i</span><span style="color:#C678DD;">+</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">);</span><span style="color:#7F848E;font-style:italic;">//显示中文：浊度</span></span>
<span class="line"><span style="color:#ABB2BF;">						  </span><span style="color:#61AFEF;">OLED_ShowStr</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">72</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;NTU&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">					}</span></span>
<span class="line"><span style="color:#ABB2BF;">					</span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;">(setFlag </span><span style="color:#C678DD;">&gt;=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">					{</span></span>
<span class="line"><span style="color:#ABB2BF;">						  setFlag </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">							</span><span style="color:#61AFEF;">OLED_CLS</span><span style="color:#ABB2BF;">();</span><span style="color:#7F848E;font-style:italic;">    //清屏</span></span>
<span class="line"><span style="color:#ABB2BF;">						  </span><span style="color:#61AFEF;">InitDisplay</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">						  </span></span>
<span class="line"><span style="color:#ABB2BF;">					}</span></span>
<span class="line"><span style="color:#ABB2BF;">					</span><span style="color:#61AFEF;">displaySetValue</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">			}</span></span>
<span class="line"><span style="color:#ABB2BF;">	 }</span></span>
<span class="line"><span style="color:#ABB2BF;">	 </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;">(KEY2 </span><span style="color:#C678DD;">==</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">)</span><span style="color:#7F848E;font-style:italic;"> //加键</span></span>
<span class="line"><span style="color:#ABB2BF;">	 {</span></span>
<span class="line"><span style="color:#ABB2BF;">			</span><span style="color:#61AFEF;">delay_ms</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">100</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">		  </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;">(KEY2 </span><span style="color:#C678DD;">==</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">			{</span></span>
<span class="line"><span style="color:#ABB2BF;">					</span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;">(setFlag </span><span style="color:#C678DD;">==</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">					{</span></span>
<span class="line"><span style="color:#ABB2BF;">						  </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;">(Ph_max</span><span style="color:#C678DD;">-</span><span style="color:#ABB2BF;">Ph_min </span><span style="color:#C678DD;">&gt;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">)Ph_min</span><span style="color:#C678DD;">+=</span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">					}</span></span>
<span class="line"><span style="color:#ABB2BF;">					</span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;">(setFlag </span><span style="color:#C678DD;">==</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">					{</span></span>
<span class="line"><span style="color:#ABB2BF;">							</span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;">(Ph_max </span><span style="color:#C678DD;">&lt;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">1400</span><span style="color:#ABB2BF;">)Ph_max</span><span style="color:#C678DD;">+=</span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">					}</span></span>
<span class="line"><span style="color:#ABB2BF;">					</span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;">(setFlag </span><span style="color:#C678DD;">==</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">					{</span></span>
<span class="line"><span style="color:#ABB2BF;">							</span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;">(tempSetVal</span><span style="color:#C678DD;">&lt;</span><span style="color:#D19A66;">99</span><span style="color:#ABB2BF;">)tempSetVal</span><span style="color:#C678DD;">++</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">					}</span></span>
<span class="line"><span style="color:#ABB2BF;">					</span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;">(setFlag </span><span style="color:#C678DD;">==</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">					{</span></span>
<span class="line"><span style="color:#ABB2BF;">						  </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;">(TurSetMax</span><span style="color:#C678DD;">&lt;</span><span style="color:#D19A66;">3000</span><span style="color:#ABB2BF;">)TurSetMax</span><span style="color:#C678DD;">+=</span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">					}</span></span>
<span class="line"><span style="color:#ABB2BF;">					</span><span style="color:#61AFEF;">displaySetValue</span><span style="color:#ABB2BF;">();</span><span style="color:#7F848E;font-style:italic;">   //显示没有设置值</span></span>
<span class="line"><span style="color:#ABB2BF;">			}</span></span>
<span class="line"><span style="color:#ABB2BF;">	 }</span></span>
<span class="line"><span style="color:#ABB2BF;">	 </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;">(KEY3 </span><span style="color:#C678DD;">==</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">)</span><span style="color:#7F848E;font-style:italic;"> //减键</span></span>
<span class="line"><span style="color:#ABB2BF;">	 {</span></span>
<span class="line"><span style="color:#ABB2BF;">			</span><span style="color:#61AFEF;">delay_ms</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">100</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">		  </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;">(KEY3 </span><span style="color:#C678DD;">==</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">			{</span></span>
<span class="line"><span style="color:#ABB2BF;">					</span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;">(setFlag </span><span style="color:#C678DD;">==</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">					{</span></span>
<span class="line"><span style="color:#ABB2BF;">						  </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;">(Ph_min </span><span style="color:#C678DD;">&gt;=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">)Ph_min</span><span style="color:#C678DD;">-=</span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">					}</span></span>
<span class="line"><span style="color:#ABB2BF;">					</span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;">(setFlag </span><span style="color:#C678DD;">==</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">					{</span></span>
<span class="line"><span style="color:#ABB2BF;">							</span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;">(Ph_max</span><span style="color:#C678DD;">-</span><span style="color:#ABB2BF;">Ph_min </span><span style="color:#C678DD;">&gt;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">)Ph_max</span><span style="color:#C678DD;">-=</span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">					}</span></span>
<span class="line"><span style="color:#ABB2BF;">					</span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;">(setFlag </span><span style="color:#C678DD;">==</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">					{</span></span>
<span class="line"><span style="color:#ABB2BF;">							</span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;">(tempSetVal</span><span style="color:#C678DD;">&gt;</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">)tempSetVal</span><span style="color:#C678DD;">--</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">					}</span></span>
<span class="line"><span style="color:#ABB2BF;">					</span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;">(setFlag </span><span style="color:#C678DD;">==</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">					{</span></span>
<span class="line"><span style="color:#ABB2BF;">						  </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;">(TurSetMax</span><span style="color:#C678DD;">&gt;=</span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">)TurSetMax</span><span style="color:#C678DD;">-=</span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">					}</span></span>
<span class="line"><span style="color:#ABB2BF;">					</span><span style="color:#61AFEF;">displaySetValue</span><span style="color:#ABB2BF;">();</span><span style="color:#7F848E;font-style:italic;">   //显示没有设置值</span></span>
<span class="line"><span style="color:#ABB2BF;">			}</span></span>
<span class="line"><span style="color:#ABB2BF;">	 }</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">void</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">Get_PH</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">void</span><span style="color:#ABB2BF;">)</span><span style="color:#7F848E;font-style:italic;">    //获取PH</span></span>
<span class="line"><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">	  u16 </span><span style="color:#E06C75;">buf</span><span style="color:#ABB2BF;">[</span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">];</span><span style="color:#7F848E;font-style:italic;">//buffer for read analog</span></span>
<span class="line"><span style="color:#ABB2BF;">	  u8 i,j;	</span></span>
<span class="line"><span style="color:#ABB2BF;">	  </span><span style="color:#C678DD;">float</span><span style="color:#ABB2BF;"> phValue</span><span style="color:#C678DD;">=</span><span style="color:#D19A66;">0.0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;">(i</span><span style="color:#C678DD;">=</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">;i</span><span style="color:#C678DD;">&lt;</span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">;i</span><span style="color:#C678DD;">++</span><span style="color:#ABB2BF;">)</span><span style="color:#7F848E;font-style:italic;">	//Get 10 sample value from the sensor for smooth the value</span></span>
<span class="line"><span style="color:#ABB2BF;">		{</span></span>
<span class="line"><span style="color:#ABB2BF;">			</span><span style="color:#E06C75;">buf</span><span style="color:#ABB2BF;">[i]</span><span style="color:#C678DD;">=</span><span style="color:#61AFEF;">Get_Adc_Average</span><span style="color:#ABB2BF;">(ADC_Channel_8,</span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">); </span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;">(i</span><span style="color:#C678DD;">=</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">;i</span><span style="color:#C678DD;">&lt;</span><span style="color:#D19A66;">9</span><span style="color:#ABB2BF;">;i</span><span style="color:#C678DD;">++</span><span style="color:#ABB2BF;">)</span><span style="color:#7F848E;font-style:italic;">	//sort the analog from small to large</span></span>
<span class="line"><span style="color:#ABB2BF;">		{</span></span>
<span class="line"><span style="color:#ABB2BF;">				</span><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;">(j</span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;">i</span><span style="color:#C678DD;">+</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">;j</span><span style="color:#C678DD;">&lt;</span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">;j</span><span style="color:#C678DD;">++</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">				{</span></span>
<span class="line"><span style="color:#ABB2BF;">						</span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">buf</span><span style="color:#ABB2BF;">[i]</span><span style="color:#C678DD;">&gt;</span><span style="color:#E06C75;">buf</span><span style="color:#ABB2BF;">[j])</span></span>
<span class="line"><span style="color:#ABB2BF;">						{</span></span>
<span class="line"><span style="color:#ABB2BF;">							</span><span style="color:#C678DD;">int</span><span style="color:#ABB2BF;"> temp</span><span style="color:#C678DD;">=</span><span style="color:#E06C75;">buf</span><span style="color:#ABB2BF;">[i];</span></span>
<span class="line"><span style="color:#ABB2BF;">							</span><span style="color:#E06C75;">buf</span><span style="color:#ABB2BF;">[i]</span><span style="color:#C678DD;">=</span><span style="color:#E06C75;">buf</span><span style="color:#ABB2BF;">[j]; </span></span>
<span class="line"><span style="color:#ABB2BF;">							</span><span style="color:#E06C75;">buf</span><span style="color:#ABB2BF;">[j]</span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;">temp;</span></span>
<span class="line"><span style="color:#ABB2BF;">						}</span></span>
<span class="line"><span style="color:#ABB2BF;">				}</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#ABB2BF;">		avgValue</span><span style="color:#C678DD;">=</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;">(i</span><span style="color:#C678DD;">=</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">;i</span><span style="color:#C678DD;">&lt;</span><span style="color:#D19A66;">8</span><span style="color:#ABB2BF;">;i</span><span style="color:#C678DD;">++</span><span style="color:#ABB2BF;">)</span><span style="color:#7F848E;font-style:italic;">	//take the average value of 6 center sample </span></span>
<span class="line"><span style="color:#ABB2BF;">		avgValue</span><span style="color:#C678DD;">+=</span><span style="color:#E06C75;">buf</span><span style="color:#ABB2BF;">[i];</span></span>
<span class="line"><span style="color:#ABB2BF;">    phValue</span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;">((</span><span style="color:#C678DD;">float</span><span style="color:#ABB2BF;">)avgValue</span><span style="color:#C678DD;">*</span><span style="color:#D19A66;">5.0</span><span style="color:#C678DD;">/</span><span style="color:#D19A66;">4095</span><span style="color:#C678DD;">/</span><span style="color:#D19A66;">6</span><span style="color:#ABB2BF;">)</span><span style="color:#C678DD;">*</span><span style="color:#ABB2BF;">RATIO;</span><span style="color:#7F848E;font-style:italic;"> //convert the analog into millivolt</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#E5C07B;">DataPoint</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">PH</span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;">(phValue</span><span style="color:#C678DD;">*</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">-</span><span style="color:#D19A66;">5.290</span><span style="color:#ABB2BF;">))</span><span style="color:#C678DD;">+</span><span style="color:#D19A66;">23.053</span><span style="color:#ABB2BF;">;</span><span style="color:#7F848E;font-style:italic;">	//convert the millivolt into pH value </span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#E5C07B;">DataPoint</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">PH</span><span style="color:#C678DD;">=</span><span style="color:#E5C07B;">DataPoint</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">PH</span><span style="color:#C678DD;">*</span><span style="color:#D19A66;">100</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">DataPoint</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">PH</span><span style="color:#C678DD;">&lt;</span><span style="color:#D19A66;">0.0</span><span style="color:#ABB2BF;">)</span><span style="color:#E5C07B;">DataPoint</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">PH</span><span style="color:#C678DD;">=</span><span style="color:#D19A66;">0.0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">DataPoint</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">PH</span><span style="color:#C678DD;">&gt;</span><span style="color:#D19A66;">1400.0</span><span style="color:#ABB2BF;">)</span><span style="color:#E5C07B;">DataPoint</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">PH</span><span style="color:#C678DD;">=</span><span style="color:#D19A66;">1400.0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">void</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">Get_Turbidity</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">void</span><span style="color:#ABB2BF;">)</span><span style="color:#7F848E;font-style:italic;">   //获取浑浊度</span></span>
<span class="line"><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#C678DD;">float</span><span style="color:#ABB2BF;"> T;</span></span>
<span class="line"><span style="color:#ABB2BF;">	  u16 adcx </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span></span>
<span class="line"><span style="color:#ABB2BF;">	  adcx </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">Get_Adc_Average</span><span style="color:#ABB2BF;">(ADC_Channel_9,</span><span style="color:#D19A66;">20</span><span style="color:#ABB2BF;">);</span><span style="color:#7F848E;font-style:italic;">//读取AD值</span></span>
<span class="line"><span style="color:#ABB2BF;">		T </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> adcx;</span></span>
<span class="line"><span style="color:#ABB2BF;">		T </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> T</span><span style="color:#C678DD;">*</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">3.3</span><span style="color:#C678DD;">/</span><span style="color:#D19A66;">4096</span><span style="color:#ABB2BF;">)</span><span style="color:#C678DD;">+</span><span style="color:#D19A66;">1.72</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;">(T </span><span style="color:#C678DD;">&lt;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">2.5</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">		{</span></span>
<span class="line"><span style="color:#ABB2BF;">				T </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">3000</span><span style="color:#ABB2BF;">;	</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> </span></span>
<span class="line"><span style="color:#ABB2BF;">		{</span></span>
<span class="line"><span style="color:#ABB2BF;">				T </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">-</span><span style="color:#D19A66;">1120.4</span><span style="color:#C678DD;">*</span><span style="color:#ABB2BF;">T</span><span style="color:#C678DD;">*</span><span style="color:#ABB2BF;">T</span><span style="color:#C678DD;">+</span><span style="color:#D19A66;">5742.3</span><span style="color:#C678DD;">*</span><span style="color:#ABB2BF;">T</span><span style="color:#C678DD;">-</span><span style="color:#D19A66;">4352.9</span><span style="color:#ABB2BF;">);</span><span style="color:#7F848E;font-style:italic;">	//Tul是AD值</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;">(T </span><span style="color:#C678DD;">&lt;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">		{</span></span>
<span class="line"><span style="color:#ABB2BF;">			T </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#E5C07B;">DataPoint</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">Turbidity</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> (u16)T;</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">DataPoint</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">Turbidity</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">&gt;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">3000</span><span style="color:#ABB2BF;">)</span><span style="color:#E5C07B;">DataPoint</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">Turbidity</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">3000</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">int</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">main</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">void</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">	  u16 timeCount1 </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">300</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">	  u16 timeCount2 </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">	  u8 shanshuo</span><span style="color:#C678DD;">=</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#61AFEF;">delay_init</span><span style="color:#ABB2BF;">();</span><span style="color:#7F848E;font-style:italic;">	           //延时函数初始化	 </span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#61AFEF;">NVIC_Configuration</span><span style="color:#ABB2BF;">();</span><span style="color:#7F848E;font-style:italic;">	   //中断优先级配置</span></span>
<span class="line"><span style="color:#ABB2BF;">	  </span><span style="color:#61AFEF;">delay_ms</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">200</span><span style="color:#ABB2BF;">); </span></span>
<span class="line"><span style="color:#ABB2BF;">	  </span><span style="color:#61AFEF;">I2C_Configuration</span><span style="color:#ABB2BF;">();</span><span style="color:#7F848E;font-style:italic;">     //IIC初始化</span></span>
<span class="line"><span style="color:#ABB2BF;">	  </span><span style="color:#61AFEF;">Adc_Init</span><span style="color:#ABB2BF;">();</span><span style="color:#7F848E;font-style:italic;">		  	      	//ADC初始化	</span></span>
<span class="line"><span style="color:#ABB2BF;">	  </span><span style="color:#61AFEF;">OLED_Init</span><span style="color:#ABB2BF;">();</span><span style="color:#7F848E;font-style:italic;">             //OLED液晶初始化</span></span>
<span class="line"><span style="color:#ABB2BF;">	  </span><span style="color:#61AFEF;">OLED_CLS</span><span style="color:#ABB2BF;">();</span><span style="color:#7F848E;font-style:italic;">              //清屏</span></span>
<span class="line"><span style="color:#ABB2BF;">	  </span><span style="color:#61AFEF;">OLED_ShowStr</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">,</span><span style="color:#98C379;">&quot;   loading...   &quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	  </span><span style="color:#61AFEF;">ESP8266_Init</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">	  </span><span style="color:#61AFEF;">OLED_CLS</span><span style="color:#ABB2BF;">();</span><span style="color:#7F848E;font-style:italic;">              //清屏</span></span>
<span class="line"><span style="color:#ABB2BF;">	  </span><span style="color:#61AFEF;">InitDisplay</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#61AFEF;">KEY_GPIO_Init</span><span style="color:#ABB2BF;">();</span><span style="color:#7F848E;font-style:italic;">        //按键引脚初始化</span></span>
<span class="line"><span style="color:#ABB2BF;">	  </span><span style="color:#61AFEF;">DS18B20_GPIO_Init</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">	  </span><span style="color:#61AFEF;">DS18B20_Init</span><span style="color:#ABB2BF;">();</span><span style="color:#7F848E;font-style:italic;">         //初始化显示</span></span>
<span class="line"><span style="color:#ABB2BF;">	  </span><span style="color:#61AFEF;">uart1_Init</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">9600</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#C678DD;">while</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">		{ </span></span>
<span class="line"><span style="color:#ABB2BF;">			   </span><span style="color:#61AFEF;">keyscan</span><span style="color:#ABB2BF;">();</span><span style="color:#7F848E;font-style:italic;">  //按键扫描</span></span>
<span class="line"><span style="color:#ABB2BF;">         timeCount1 </span><span style="color:#C678DD;">++</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">			   </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;">(timeCount1 </span><span style="color:#C678DD;">&gt;=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">300</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">&amp;&amp;</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">!</span><span style="color:#ABB2BF;">setFlag)</span><span style="color:#7F848E;font-style:italic;">   //延时一段时间读取</span></span>
<span class="line"><span style="color:#ABB2BF;">				 {</span></span>
<span class="line"><span style="color:#ABB2BF;">						timeCount1 </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">					 </span></span>
<span class="line"><span style="color:#ABB2BF;">					  shanshuo</span><span style="color:#C678DD;">=</span><span style="color:#56B6C2;">!</span><span style="color:#ABB2BF;">shanshuo;</span></span>
<span class="line"><span style="color:#ABB2BF;">					 </span></span>
<span class="line"><span style="color:#ABB2BF;">					  </span><span style="color:#61AFEF;">Get_PH</span><span style="color:#ABB2BF;">() ;</span><span style="color:#7F848E;font-style:italic;">      //获取PH</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">					  /*超限的时候闪烁显示*/</span></span>
<span class="line"><span style="color:#ABB2BF;">					  </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;">((</span><span style="color:#E5C07B;">DataPoint</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">PH</span><span style="color:#C678DD;">&lt;=</span><span style="color:#ABB2BF;">Ph_min </span><span style="color:#56B6C2;">||</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">DataPoint</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">PH</span><span style="color:#C678DD;">&gt;=</span><span style="color:#ABB2BF;">Ph_max) </span><span style="color:#56B6C2;">&amp;&amp;</span><span style="color:#ABB2BF;"> shanshuo)</span></span>
<span class="line"><span style="color:#ABB2BF;">						{</span></span>
<span class="line"><span style="color:#ABB2BF;">								</span><span style="color:#61AFEF;">OLED_ShowStr</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">32</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">,</span><span style="color:#98C379;">&quot;     &quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">						}</span></span>
<span class="line"><span style="color:#ABB2BF;">						</span><span style="color:#C678DD;">else</span></span>
<span class="line"><span style="color:#ABB2BF;">						{</span></span>
<span class="line"><span style="color:#ABB2BF;">								</span><span style="color:#61AFEF;">sprintf</span><span style="color:#ABB2BF;">(display,</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">%5.2f</span><span style="color:#98C379;"> &quot;</span><span style="color:#ABB2BF;">,(</span><span style="color:#C678DD;">float</span><span style="color:#ABB2BF;">)</span><span style="color:#E5C07B;">DataPoint</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">PH</span><span style="color:#C678DD;">/</span><span style="color:#D19A66;">100</span><span style="color:#ABB2BF;">); </span></span>
<span class="line"><span style="color:#ABB2BF;">								</span><span style="color:#61AFEF;">OLED_ShowStr</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">32</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">,(u8 </span><span style="color:#C678DD;">*</span><span style="color:#ABB2BF;">)display, </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">						}</span></span>
<span class="line"><span style="color:#ABB2BF;">					</span></span>
<span class="line"><span style="color:#ABB2BF;">					 </span></span>
<span class="line"><span style="color:#ABB2BF;">					  </span><span style="color:#E5C07B;">DataPoint</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">temperature</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">ReadTemperature</span><span style="color:#ABB2BF;">();</span><span style="color:#7F848E;font-style:italic;">//读取温度</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">						/*超限的时候闪烁显示*/</span></span>
<span class="line"><span style="color:#ABB2BF;">						</span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;">((</span><span style="color:#E5C07B;">DataPoint</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">temperature</span><span style="color:#C678DD;">&gt;=</span><span style="color:#ABB2BF;">tempSetVal) </span><span style="color:#56B6C2;">&amp;&amp;</span><span style="color:#ABB2BF;"> shanshuo)</span></span>
<span class="line"><span style="color:#ABB2BF;">						{</span></span>
<span class="line"><span style="color:#ABB2BF;">								</span><span style="color:#61AFEF;">OLED_ShowStr</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">40</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">,</span><span style="color:#98C379;">&quot;    &quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">						}</span></span>
<span class="line"><span style="color:#ABB2BF;">						</span><span style="color:#C678DD;">else</span></span>
<span class="line"><span style="color:#ABB2BF;">						{</span></span>
<span class="line"><span style="color:#ABB2BF;">								</span><span style="color:#61AFEF;">sprintf</span><span style="color:#ABB2BF;">(display,</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">%02d</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">,</span><span style="color:#E5C07B;">DataPoint</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">temperature</span><span style="color:#ABB2BF;">); </span></span>
<span class="line"><span style="color:#ABB2BF;">								</span><span style="color:#61AFEF;">OLED_ShowStr</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">40</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">,(u8 </span><span style="color:#C678DD;">*</span><span style="color:#ABB2BF;">)display, </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">							  </span><span style="color:#61AFEF;">OLED_ShowCentigrade</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">56</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">);</span><span style="color:#7F848E;font-style:italic;">    //℃</span></span>
<span class="line"><span style="color:#ABB2BF;">						}</span></span>
<span class="line"><span style="color:#ABB2BF;">					 </span></span>
<span class="line"><span style="color:#ABB2BF;">					  </span><span style="color:#61AFEF;">Get_Turbidity</span><span style="color:#ABB2BF;">() ;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">						/*超限的时候闪烁显示*/</span></span>
<span class="line"><span style="color:#ABB2BF;">						</span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;">((</span><span style="color:#E5C07B;">DataPoint</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">Turbidity</span><span style="color:#C678DD;">&gt;=</span><span style="color:#ABB2BF;">TurSetMax) </span><span style="color:#56B6C2;">&amp;&amp;</span><span style="color:#ABB2BF;"> shanshuo)</span></span>
<span class="line"><span style="color:#ABB2BF;">						{</span></span>
<span class="line"><span style="color:#ABB2BF;">								</span><span style="color:#61AFEF;">OLED_ShowStr</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">40</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">6</span><span style="color:#ABB2BF;">,</span><span style="color:#98C379;">&quot;       &quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">						}</span></span>
<span class="line"><span style="color:#ABB2BF;">						</span><span style="color:#C678DD;">else</span></span>
<span class="line"><span style="color:#ABB2BF;">						{</span></span>
<span class="line"><span style="color:#ABB2BF;">								</span><span style="color:#61AFEF;">sprintf</span><span style="color:#ABB2BF;">(display,</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">NTU   &quot;</span><span style="color:#ABB2BF;">,</span><span style="color:#E5C07B;">DataPoint</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">Turbidity</span><span style="color:#ABB2BF;">); </span></span>
<span class="line"><span style="color:#ABB2BF;">								</span><span style="color:#61AFEF;">OLED_ShowStr</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">40</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">6</span><span style="color:#ABB2BF;">,(u8 </span><span style="color:#C678DD;">*</span><span style="color:#ABB2BF;">)display, </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">,</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">						}</span></span>
<span class="line"><span style="color:#ABB2BF;">						</span></span>
<span class="line"><span style="color:#ABB2BF;">						</span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;">((</span><span style="color:#E5C07B;">DataPoint</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">PH</span><span style="color:#C678DD;">&lt;=</span><span style="color:#ABB2BF;">Ph_min </span><span style="color:#56B6C2;">||</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">DataPoint</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">PH</span><span style="color:#C678DD;">&gt;=</span><span style="color:#ABB2BF;">Ph_max)</span><span style="color:#56B6C2;">||</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">DataPoint</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">temperature</span><span style="color:#C678DD;">&gt;=</span><span style="color:#ABB2BF;">tempSetVal)</span><span style="color:#56B6C2;">||</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">DataPoint</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">Turbidity</span><span style="color:#C678DD;">&gt;=</span><span style="color:#ABB2BF;">TurSetMax))BEEP</span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">~</span><span style="color:#ABB2BF;">BEEP;</span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> BEEP</span><span style="color:#C678DD;">=</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">;</span><span style="color:#7F848E;font-style:italic;">  //超限蜂鸣器报警</span></span>
<span class="line"><span style="color:#ABB2BF;">				 }</span></span>
<span class="line"><span style="color:#ABB2BF;">				 timeCount2 </span><span style="color:#C678DD;">++</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">				 </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;">(timeCount2 </span><span style="color:#C678DD;">&gt;=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">900</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">				 {</span></span>
<span class="line"><span style="color:#ABB2BF;">							timeCount2 </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">							</span><span style="color:#61AFEF;">CloudPlatform_SendData</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">&amp;</span><span style="color:#ABB2BF;">DataPoint);</span><span style="color:#7F848E;font-style:italic;">  //上报数据到云平台</span></span>
<span class="line"><span style="color:#ABB2BF;">				 }</span></span>
<span class="line"><span style="color:#ABB2BF;">			   </span><span style="color:#61AFEF;">delay_ms</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-c line-numbers-mode" data-ext="c"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// WIFI模块 esp8266.c</span></span>
<span class="line"><span style="color:#C678DD;">#include</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;stm32f10x.h&quot;</span></span>
<span class="line"><span style="color:#C678DD;">#include</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;usart3.h&quot;</span></span>
<span class="line"><span style="color:#C678DD;">#include</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;esp8266.h&quot;</span></span>
<span class="line"><span style="color:#C678DD;">#include</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;delay.h&quot;</span></span>
<span class="line"><span style="color:#C678DD;">#include</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&lt;string.h&gt;</span></span>
<span class="line"><span style="color:#C678DD;">#include</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&lt;stdio.h&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">#define</span><span style="color:#ABB2BF;">  </span><span style="color:#61AFEF;">ESP8266_BUF</span><span style="color:#ABB2BF;">         Usart3RecBuf </span></span>
<span class="line"><span style="color:#C678DD;">#define</span><span style="color:#ABB2BF;">  </span><span style="color:#61AFEF;">ESP8266_CNT</span><span style="color:#ABB2BF;">         Rx3Counter</span></span>
<span class="line"><span style="color:#C678DD;">#define</span><span style="color:#ABB2BF;">  </span><span style="color:#61AFEF;">STM32_RX1BUFF_SIZE</span><span style="color:#ABB2BF;">  USART3_RXBUFF_SIZE</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">#define</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">ESP8266_WIFI_INFO</span><span style="color:#ABB2BF;">	  	</span><span style="color:#98C379;">&quot;AT+CWJAP=</span><span style="color:#56B6C2;">\\&quot;</span><span style="color:#98C379;">test_wifi</span><span style="color:#56B6C2;">\\&quot;</span><span style="color:#98C379;">,</span><span style="color:#56B6C2;">\\&quot;</span><span style="color:#98C379;">123456888</span><span style="color:#56B6C2;">\\&quot;\\r\\n</span><span style="color:#98C379;">&quot;</span><span style="color:#7F848E;font-style:italic;">        //接入的WIFI名称和密码</span></span>
<span class="line"><span style="color:#C678DD;">#define</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">ESP8266_SERVER_INFO</span><span style="color:#ABB2BF;">		</span><span style="color:#98C379;">&quot;AT+CIPSTART=</span><span style="color:#56B6C2;">\\&quot;</span><span style="color:#98C379;">TCP</span><span style="color:#56B6C2;">\\&quot;</span><span style="color:#98C379;">,</span><span style="color:#56B6C2;">\\&quot;</span><span style="color:#98C379;">www.wztdzmcu.com</span><span style="color:#56B6C2;">\\&quot;</span><span style="color:#98C379;">,6002</span><span style="color:#56B6C2;">\\r\\n</span><span style="color:#98C379;">&quot;</span><span style="color:#7F848E;font-style:italic;">      //云平台的IP和端口</span></span>
<span class="line"><span style="color:#C678DD;">#define</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">DEVID</span><span style="color:#ABB2BF;">		</span><span style="color:#98C379;">&quot;82525****3680&quot;</span><span style="color:#7F848E;font-style:italic;">	       //云平台的设备ID</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">unsigned</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">short</span><span style="color:#ABB2BF;"> esp8266_cntPre </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//==========================================================</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//	函数名称：	ESP8266_Clear</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//	函数功能：	清空缓存</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//	入口参数：	无</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//	返回参数：	无</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//	说明：	</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//==========================================================</span></span>
<span class="line"><span style="color:#C678DD;">void</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">ESP8266_Clear</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">void</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span><span style="color:#61AFEF;">memset</span><span style="color:#ABB2BF;">(ESP8266_BUF, </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#C678DD;">sizeof</span><span style="color:#ABB2BF;">(ESP8266_BUF));</span></span>
<span class="line"><span style="color:#ABB2BF;">	ESP8266_CNT </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//==========================================================</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//	函数名称：	ESP8266_WaitRecive</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//	函数功能：	等待接收完成</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//	入口参数：	无</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//	返回参数：	REV_OK-接收完成		REV_WAIT-接收超时未完成</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//	说明：		循环调用检测是否接收完成</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//==========================================================</span></span>
<span class="line"><span style="color:#C678DD;">_Bool</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">ESP8266_WaitRecive</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">void</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;">(ESP8266_CNT </span><span style="color:#C678DD;">==</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">)</span><span style="color:#7F848E;font-style:italic;"> 							//如果接收计数为0 则说明没有处于接收数据中，所以直接跳出，结束函数</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> REV_WAIT;</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;">(ESP8266_CNT </span><span style="color:#C678DD;">==</span><span style="color:#ABB2BF;"> esp8266_cntPre)</span><span style="color:#7F848E;font-style:italic;">				//如果上一次的值和这次相同，则说明接收完毕</span></span>
<span class="line"><span style="color:#ABB2BF;">	{</span></span>
<span class="line"><span style="color:#ABB2BF;">		ESP8266_CNT </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">;</span><span style="color:#7F848E;font-style:italic;">							//清0接收计数</span></span>
<span class="line"><span style="color:#ABB2BF;">			</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> REV_OK;</span><span style="color:#7F848E;font-style:italic;">								//返回接收完成标志</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span></span>
<span class="line"><span style="color:#ABB2BF;">	esp8266_cntPre </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> ESP8266_CNT;</span><span style="color:#7F848E;font-style:italic;">					//置为相同</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> REV_WAIT;</span><span style="color:#7F848E;font-style:italic;">								//返回接收未完成标志</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//==========================================================</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//	函数名称：	ESP8266_SendCmd</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//	函数功能：	发送命令</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//	入口参数：	cmd：命令</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//				res：需要检查的返回指令</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//	返回参数：	0-成功	1-失败</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//	说明：		</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//==========================================================</span></span>
<span class="line"><span style="color:#C678DD;">_Bool</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">ESP8266_SendCmd</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">char</span><span style="color:#E06C75;"> </span><span style="color:#C678DD;">*</span><span style="color:#E06C75;font-style:italic;">cmd</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;"> </span><span style="color:#C678DD;">char</span><span style="color:#E06C75;"> </span><span style="color:#C678DD;">*</span><span style="color:#E06C75;font-style:italic;">res</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;"> u16 </span><span style="color:#E06C75;font-style:italic;">time</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">{	</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#61AFEF;">uart3_send</span><span style="color:#ABB2BF;">((</span><span style="color:#C678DD;">unsigned</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">char</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">*</span><span style="color:#ABB2BF;">)cmd,</span><span style="color:#61AFEF;">strlen</span><span style="color:#ABB2BF;">((</span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">char</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">*</span><span style="color:#ABB2BF;">)cmd));</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span><span style="color:#C678DD;">while</span><span style="color:#ABB2BF;">(time</span><span style="color:#C678DD;">--</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">	{</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">ESP8266_WaitRecive</span><span style="color:#ABB2BF;">() </span><span style="color:#C678DD;">==</span><span style="color:#ABB2BF;"> REV_OK)</span><span style="color:#7F848E;font-style:italic;">							//如果收到数据</span></span>
<span class="line"><span style="color:#ABB2BF;">		{</span></span>
<span class="line"><span style="color:#ABB2BF;">			</span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">strstr</span><span style="color:#ABB2BF;">((</span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">char</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">*</span><span style="color:#ABB2BF;">)ESP8266_BUF, res) </span><span style="color:#C678DD;">!=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">NULL</span><span style="color:#ABB2BF;">)</span><span style="color:#7F848E;font-style:italic;">		//如果检索到关键词</span></span>
<span class="line"><span style="color:#ABB2BF;">			{</span></span>
<span class="line"><span style="color:#ABB2BF;">				</span><span style="color:#61AFEF;">ESP8266_Clear</span><span style="color:#ABB2BF;">();</span><span style="color:#7F848E;font-style:italic;">									//清空缓存</span></span>
<span class="line"><span style="color:#ABB2BF;">				</span></span>
<span class="line"><span style="color:#ABB2BF;">				</span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">			}</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#61AFEF;">delay_ms</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//==========================================================</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//	函数名称：	ESP8266_SendData</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//	函数功能：	发送数据</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//	入口参数：	data：数据</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//				len：长度</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//	返回参数：	无</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//	说明：		</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//==========================================================</span></span>
<span class="line"><span style="color:#C678DD;">void</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">ESP8266_SendData</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">unsigned</span><span style="color:#E06C75;"> </span><span style="color:#C678DD;">char</span><span style="color:#E06C75;"> </span><span style="color:#C678DD;">*</span><span style="color:#E06C75;font-style:italic;">data</span><span style="color:#ABB2BF;">,</span><span style="color:#E06C75;"> </span><span style="color:#C678DD;">unsigned</span><span style="color:#E06C75;"> </span><span style="color:#C678DD;">short</span><span style="color:#E06C75;"> </span><span style="color:#E06C75;font-style:italic;">len</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">	</span><span style="color:#C678DD;">char</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">cmdBuf</span><span style="color:#ABB2BF;">[</span><span style="color:#D19A66;">32</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span><span style="color:#61AFEF;">ESP8266_Clear</span><span style="color:#ABB2BF;">();</span><span style="color:#7F848E;font-style:italic;">								//清空接收缓存</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span><span style="color:#61AFEF;">sprintf</span><span style="color:#ABB2BF;">(cmdBuf, </span><span style="color:#98C379;">&quot;AT+CIPSEND=</span><span style="color:#D19A66;">%d</span><span style="color:#56B6C2;">\\r\\n</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">, len);</span><span style="color:#7F848E;font-style:italic;">		//发送命令</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">!</span><span style="color:#61AFEF;">ESP8266_SendCmd</span><span style="color:#ABB2BF;">(cmdBuf, </span><span style="color:#98C379;">&quot;&gt;&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">200</span><span style="color:#ABB2BF;">))</span><span style="color:#7F848E;font-style:italic;">				//收到‘&gt;’时可以发送数据</span></span>
<span class="line"><span style="color:#ABB2BF;">	{</span></span>
<span class="line"><span style="color:#ABB2BF;">			</span><span style="color:#61AFEF;">uart3_send</span><span style="color:#ABB2BF;">(data , len);</span><span style="color:#7F848E;font-style:italic;">         //发送设备连接请求数据</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//==========================================================</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//	函数名称：	CloudPlatform_SendData</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//	函数功能：	上传数据到平台</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//	返回参数：	无</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//	说明：		</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//==========================================================</span></span>
<span class="line"><span style="color:#C678DD;">void</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">CloudPlatform_SendData</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">const</span><span style="color:#E06C75;"> </span><span style="color:#56B6C2;">dataPoint_t</span><span style="color:#E06C75;"> </span><span style="color:#C678DD;">*</span><span style="color:#E06C75;"> </span><span style="color:#C678DD;">const</span><span style="color:#E06C75;"> </span><span style="color:#E06C75;font-style:italic;">data</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#C678DD;">char</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">cmdBuf</span><span style="color:#ABB2BF;">[</span><span style="color:#D19A66;">512</span><span style="color:#ABB2BF;">],</span><span style="color:#E06C75;">buf</span><span style="color:#ABB2BF;">[</span><span style="color:#D19A66;">128</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#ABB2BF;">	  </span><span style="color:#C678DD;">unsigned</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">char</span><span style="color:#ABB2BF;"> len</span><span style="color:#C678DD;">=</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">	  </span><span style="color:#61AFEF;">memset</span><span style="color:#ABB2BF;">(cmdBuf, </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#C678DD;">sizeof</span><span style="color:#ABB2BF;">(cmdBuf));</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#61AFEF;">sprintf</span><span style="color:#ABB2BF;">(cmdBuf,</span><span style="color:#98C379;">&quot;MQTT|</span><span style="color:#D19A66;">%s</span><span style="color:#98C379;">|test|&quot;</span><span style="color:#ABB2BF;">,DEVID);</span></span>
<span class="line"><span style="color:#ABB2BF;">	  len </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">strlen</span><span style="color:#ABB2BF;">(cmdBuf);</span></span>
<span class="line"><span style="color:#ABB2BF;">	  </span><span style="color:#E06C75;">cmdBuf</span><span style="color:#ABB2BF;">[len] </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&#39;{&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">	  </span></span>
<span class="line"><span style="color:#ABB2BF;">	  </span><span style="color:#61AFEF;">memset</span><span style="color:#ABB2BF;">(buf, </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#C678DD;">sizeof</span><span style="color:#ABB2BF;">(buf));</span></span>
<span class="line"><span style="color:#ABB2BF;">	  </span><span style="color:#61AFEF;">sprintf</span><span style="color:#ABB2BF;">(buf,</span><span style="color:#98C379;">&quot;</span><span style="color:#56B6C2;">\\&quot;</span><span style="color:#98C379;">ph</span><span style="color:#56B6C2;">\\&quot;</span><span style="color:#98C379;">:</span><span style="color:#D19A66;">%.2f</span><span style="color:#98C379;">,&quot;</span><span style="color:#ABB2BF;">,(</span><span style="color:#C678DD;">float</span><span style="color:#ABB2BF;">)(</span><span style="color:#E5C07B;">data</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#E06C75;">PH</span><span style="color:#ABB2BF;">)</span><span style="color:#C678DD;">/</span><span style="color:#D19A66;">100</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	  </span><span style="color:#61AFEF;">strcat</span><span style="color:#ABB2BF;">(cmdBuf, buf);</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span></span>
<span class="line"><span style="color:#ABB2BF;">	  </span><span style="color:#61AFEF;">memset</span><span style="color:#ABB2BF;">(buf, </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#C678DD;">sizeof</span><span style="color:#ABB2BF;">(buf));</span></span>
<span class="line"><span style="color:#ABB2BF;">	  </span><span style="color:#61AFEF;">sprintf</span><span style="color:#ABB2BF;">(buf,</span><span style="color:#98C379;">&quot;</span><span style="color:#56B6C2;">\\&quot;</span><span style="color:#98C379;">temp</span><span style="color:#56B6C2;">\\&quot;</span><span style="color:#98C379;">:</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">,&quot;</span><span style="color:#ABB2BF;">,</span><span style="color:#E5C07B;">data</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#E06C75;">temperature</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	  </span><span style="color:#61AFEF;">strcat</span><span style="color:#ABB2BF;">(cmdBuf, buf);</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span></span>
<span class="line"><span style="color:#ABB2BF;">	  </span><span style="color:#61AFEF;">memset</span><span style="color:#ABB2BF;">(buf, </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#C678DD;">sizeof</span><span style="color:#ABB2BF;">(buf));</span></span>
<span class="line"><span style="color:#ABB2BF;">	  </span><span style="color:#61AFEF;">sprintf</span><span style="color:#ABB2BF;">(buf,</span><span style="color:#98C379;">&quot;</span><span style="color:#56B6C2;">\\&quot;</span><span style="color:#98C379;">tur</span><span style="color:#56B6C2;">\\&quot;</span><span style="color:#98C379;">:</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">,</span><span style="color:#E5C07B;">data</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#E06C75;">Turbidity</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	  </span><span style="color:#61AFEF;">strcat</span><span style="color:#ABB2BF;">(cmdBuf, buf);</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span></span>
<span class="line"><span style="color:#ABB2BF;">	  len </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">strlen</span><span style="color:#ABB2BF;">(cmdBuf);</span></span>
<span class="line"><span style="color:#ABB2BF;">	  </span><span style="color:#E06C75;">cmdBuf</span><span style="color:#ABB2BF;">[len] </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&#39;}&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span></span>
<span class="line"><span style="color:#ABB2BF;">	  </span><span style="color:#61AFEF;">strcat</span><span style="color:#ABB2BF;">(cmdBuf, </span><span style="color:#98C379;">&quot;</span><span style="color:#56B6C2;">\\r\\n</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	  len </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">strlen</span><span style="color:#ABB2BF;">(cmdBuf);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">	  </span><span style="color:#61AFEF;">ESP8266_SendData</span><span style="color:#ABB2BF;">((</span><span style="color:#C678DD;">unsigned</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">char</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">*</span><span style="color:#ABB2BF;">)cmdBuf, len);  </span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//==========================================================</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//	函数名称：	ESP8266_GetIPD</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//	函数功能：	获取平台返回的数据</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//	入口参数：	等待的时间(乘以10ms)</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//	返回参数：	平台返回的原始数据</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//	说明：		不同网络设备返回的格式不同，需要去调试</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//				如ESP8266的返回格式为	&quot;+IPD,x:yyy&quot;	x代表数据长度，yyy是数据内容</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//==========================================================</span></span>
<span class="line"><span style="color:#C678DD;">unsigned</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">char</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">*</span><span style="color:#61AFEF;">ESP8266_GetIPD</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">unsigned</span><span style="color:#E06C75;"> </span><span style="color:#C678DD;">short</span><span style="color:#E06C75;"> </span><span style="color:#E06C75;font-style:italic;">timeOut</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">{</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">	</span><span style="color:#C678DD;">char</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">*</span><span style="color:#ABB2BF;">ptrIPD </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">NULL</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span><span style="color:#C678DD;">do</span></span>
<span class="line"><span style="color:#ABB2BF;">	{</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">ESP8266_WaitRecive</span><span style="color:#ABB2BF;">() </span><span style="color:#C678DD;">==</span><span style="color:#ABB2BF;"> REV_OK)</span><span style="color:#7F848E;font-style:italic;">								//如果接收完成</span></span>
<span class="line"><span style="color:#ABB2BF;">		{</span></span>
<span class="line"><span style="color:#ABB2BF;">			ptrIPD </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">strstr</span><span style="color:#ABB2BF;">((</span><span style="color:#C678DD;">char</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">*</span><span style="color:#ABB2BF;">)ESP8266_BUF, </span><span style="color:#98C379;">&quot;IPD,&quot;</span><span style="color:#ABB2BF;">);</span><span style="color:#7F848E;font-style:italic;">				//搜索“IPD”头</span></span>
<span class="line"><span style="color:#ABB2BF;">			</span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;">(ptrIPD </span><span style="color:#C678DD;">==</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">NULL</span><span style="color:#ABB2BF;">)</span><span style="color:#7F848E;font-style:italic;">											//如果没找到，可能是IPD头的延迟，还是需要等待一会，但不会超过设定的时间</span></span>
<span class="line"><span style="color:#ABB2BF;">			{</span></span>
<span class="line"><span style="color:#ABB2BF;">				</span><span style="color:#7F848E;font-style:italic;">//printf(&quot;\\&quot;IPD\\&quot; not found\\r\\n&quot;);</span></span>
<span class="line"><span style="color:#ABB2BF;">			}</span></span>
<span class="line"><span style="color:#ABB2BF;">			</span><span style="color:#C678DD;">else</span></span>
<span class="line"><span style="color:#ABB2BF;">			{</span></span>
<span class="line"><span style="color:#ABB2BF;">				ptrIPD </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">strchr</span><span style="color:#ABB2BF;">(ptrIPD, </span><span style="color:#98C379;">&#39;:&#39;</span><span style="color:#ABB2BF;">);</span><span style="color:#7F848E;font-style:italic;">							//找到&#39;:&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">				</span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;">(ptrIPD </span><span style="color:#C678DD;">!=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">NULL</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">				{</span></span>
<span class="line"><span style="color:#ABB2BF;">					ptrIPD</span><span style="color:#C678DD;">++</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">					</span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">unsigned</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">char</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">*</span><span style="color:#ABB2BF;">)(ptrIPD);</span></span>
<span class="line"><span style="color:#ABB2BF;">				}</span></span>
<span class="line"><span style="color:#ABB2BF;">				</span><span style="color:#C678DD;">else</span></span>
<span class="line"><span style="color:#ABB2BF;">					</span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">NULL</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">				</span></span>
<span class="line"><span style="color:#ABB2BF;">			}</span></span>
<span class="line"><span style="color:#ABB2BF;">		}</span></span>
<span class="line"><span style="color:#ABB2BF;">		</span><span style="color:#61AFEF;">delay_ms</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">);</span><span style="color:#7F848E;font-style:italic;">													//延时等待</span></span>
<span class="line"><span style="color:#ABB2BF;">	} </span><span style="color:#C678DD;">while</span><span style="color:#ABB2BF;">(timeOut</span><span style="color:#C678DD;">--</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">NULL</span><span style="color:#ABB2BF;">;</span><span style="color:#7F848E;font-style:italic;">														//超时还未找到，返回空指针</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//==========================================================</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//	函数名称：	ESP8266_Init</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//	函数功能：	初始化ESP8266</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//	入口参数：	无</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//	返回参数：	无</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//	说明：		</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">//==========================================================</span></span>
<span class="line"><span style="color:#C678DD;">void</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">ESP8266_Init</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">void</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span><span style="color:#61AFEF;">USART3_Init</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">115200</span><span style="color:#ABB2BF;">);</span><span style="color:#7F848E;font-style:italic;">   //串口初始化</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span><span style="color:#61AFEF;">ESP8266_Clear</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span><span style="color:#C678DD;">while</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">ESP8266_SendCmd</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;AT</span><span style="color:#56B6C2;">\\r\\n\\r</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;OK&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">500</span><span style="color:#ABB2BF;">))</span><span style="color:#7F848E;font-style:italic;">         //测试</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span><span style="color:#61AFEF;">delay_ms</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">500</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span><span style="color:#C678DD;">while</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">ESP8266_SendCmd</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;AT+RESTORE</span><span style="color:#56B6C2;">\\r\\n</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;OK&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">2000</span><span style="color:#ABB2BF;">))</span><span style="color:#7F848E;font-style:italic;"> //先清除一下数据</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span><span style="color:#61AFEF;">delay_ms</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1000</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span><span style="color:#C678DD;">while</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">ESP8266_SendCmd</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;AT+RST</span><span style="color:#56B6C2;">\\r\\n\\r</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;ready&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">1000</span><span style="color:#ABB2BF;">))</span><span style="color:#7F848E;font-style:italic;"> //复位</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span><span style="color:#61AFEF;">delay_ms</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">500</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">	</span><span style="color:#C678DD;">while</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">ESP8266_SendCmd</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;AT+CWMODE=1</span><span style="color:#56B6C2;">\\r\\n</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;OK&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">500</span><span style="color:#ABB2BF;">))</span><span style="color:#7F848E;font-style:italic;">  //设置为STA模式</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span><span style="color:#61AFEF;">delay_ms</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1000</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">	</span><span style="color:#C678DD;">while</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">ESP8266_SendCmd</span><span style="color:#ABB2BF;">(ESP8266_WIFI_INFO, </span><span style="color:#98C379;">&quot;WIFI CONNECTED&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">2000</span><span style="color:#ABB2BF;">))</span><span style="color:#7F848E;font-style:italic;"> //设置wifi名称，密码</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span><span style="color:#61AFEF;">delay_ms</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1000</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span><span style="color:#61AFEF;">delay_ms</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1000</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span><span style="color:#C678DD;">do</span></span>
<span class="line"><span style="color:#ABB2BF;">	{</span></span>
<span class="line"><span style="color:#ABB2BF;">			</span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">ESP8266_WaitRecive</span><span style="color:#ABB2BF;">() </span><span style="color:#C678DD;">==</span><span style="color:#ABB2BF;"> REV_OK)</span></span>
<span class="line"><span style="color:#ABB2BF;">			{</span></span>
<span class="line"><span style="color:#ABB2BF;">					 </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">strstr</span><span style="color:#ABB2BF;">((</span><span style="color:#C678DD;">char</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">*</span><span style="color:#ABB2BF;">)ESP8266_BUF, </span><span style="color:#98C379;">&quot;WIFI GOT IP&quot;</span><span style="color:#ABB2BF;">)</span><span style="color:#C678DD;">!=</span><span style="color:#D19A66;">NULL</span><span style="color:#ABB2BF;">)</span><span style="color:#7F848E;font-style:italic;"> //等待WIFI连接成功</span></span>
<span class="line"><span style="color:#ABB2BF;">					 {</span></span>
<span class="line"><span style="color:#ABB2BF;">							</span><span style="color:#C678DD;">break</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">					 }</span></span>
<span class="line"><span style="color:#ABB2BF;">			}</span></span>
<span class="line"><span style="color:#ABB2BF;">			</span><span style="color:#61AFEF;">delay_ms</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1000</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	}</span><span style="color:#C678DD;">while</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span><span style="color:#C678DD;">while</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">ESP8266_SendCmd</span><span style="color:#ABB2BF;">(ESP8266_SERVER_INFO, </span><span style="color:#98C379;">&quot;CONNECT&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">1000</span><span style="color:#ABB2BF;">))</span><span style="color:#7F848E;font-style:italic;">  //接入服务器</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span><span style="color:#61AFEF;">delay_ms</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1000</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">	</span><span style="color:#61AFEF;">delay_ms</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1000</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_4、程序构建" tabindex="-1"><a class="header-anchor" href="#_4、程序构建" aria-hidden="true">#</a> 4、程序构建</h4><p>修改程序参数：接入的WIFI名称和密码、云平台的IP和端口、平台设备ID</p><img src="`+fs+'" width="800"><p>配置目标选项：</p><p>点击①目标选项按钮--&gt;点击②Device按钮--&gt;选择③STM32F103C8</p><img src="'+qs+'" width="800"><p>继续选择①Output选项--&gt;点击②选择输出文件位置--&gt;填写③输出的文件名--&gt;勾选④创建HEX文件</p><img src="'+_s+'" width="800"><p>点击①构建，出现②程序构建成功</p><img src="'+xs+'" width="800"><p>找到可烧录的单片机程序</p><img src="'+ws+'" width="800"><h4 id="_5、烧录步骤" tabindex="-1"><a class="header-anchor" href="#_5、烧录步骤" aria-hidden="true">#</a> 5、烧录步骤</h4><p>使用USB转TTL串口下载器链接STM32</p><div style="display:flex;justify-content:center;gap:50px;"><img src="'+Ss+'" width="400"><img src="'+ks+'" width="400"></div><table><thead><tr><th style="text-align:center;">串口下载器</th><th style="text-align:center;">STM32</th></tr></thead><tbody><tr><td style="text-align:center;">5V</td><td style="text-align:center;">5V</td></tr><tr><td style="text-align:center;">GND</td><td style="text-align:center;">GND</td></tr><tr><td style="text-align:center;">TXD</td><td style="text-align:center;">A10</td></tr><tr><td style="text-align:center;">RXD</td><td style="text-align:center;">A9</td></tr><tr><td style="text-align:center;"></td><td style="text-align:center;">BOOT0切到1，烧录程序后复原</td></tr></tbody></table><p>链接到电脑</p><img src="'+Ps+'" width="800"><p>查询串行端口</p><img src="'+o+'" width="800"><img src="'+Is+'" width="800"><p>打开mcuisp烧录软件，选择HEX烧录程序</p><img src="'+Ts+'" width="800"><p>在mcuisp选项栏选择PROT--&gt;选择查询到串行端口</p><img src="'+Ls+'" width="800"><p>按下①开始编程，烧录程序，如果在等待没反映，按下STM32开发板上的RESET按钮，出现②表示程序烧录成功</p><img src="'+Rs+'" width="800"><h3 id="esp32-cam摄像头开发" tabindex="-1"><a class="header-anchor" href="#esp32-cam摄像头开发" aria-hidden="true">#</a> ESP32-CAM摄像头开发</h3><h4 id="_1、ch340串口驱动-2" tabindex="-1"><a class="header-anchor" href="#_1、ch340串口驱动-2" aria-hidden="true">#</a> 1、CH340串口驱动</h4>',32),ja={href:"https://pan.baidu.com/s/10xkZRh0lhhMzrGsPKYjVlw?pwd=l9hj",target:"_blank",rel:"noopener noreferrer"},Ua=s("p",null,"文件描述",-1),Va=s("p",null,"USB转串口Windows一键式安装驱动程序，支持CH340和CH341，支持32/64位Windows 11/10/8.1/8/7/VISTA/XP，SERVER 2022/2019/2016/2012/2008/2003，2000/ME/98，通过微软数字签名认证，支持USB转UART的3线和9线SERIAL串口等，用于随产品发行到最终用户。",-1),Ha=s("p",null,"适用范围",-1),Ga=s("p",null,"CH340G，CH340T，CH340C，CH340N, CH340K, CH340E，CH340B，CH341A，CH341F, CH341T，CH341B，CH341C，CH341U",-1),Wa=s("h4",{id:"_2、开发软件arduino-1",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#_2、开发软件arduino-1","aria-hidden":"true"},"#"),n(" 2、开发软件arduino")],-1),za=s("p",null,"安装Arduino IDE 、ESP32离线包、ESP8266离线包",-1),Ka={href:"https://pan.baidu.com/s/1LymkbGFzdjkwvs4E7MMi2g?pwd=8889",target:"_blank",rel:"noopener noreferrer"},Ya=s("p",null,"添加附加开发板地址打开Arduino IDE菜单 > 文件 >首选项，在 附加开发板管理器网址 输入框中，填入以下网址：",-1),Xa={href:"https://arduino.me/packages/esp32.json",target:"_blank",rel:"noopener noreferrer"},Ja={href:"https://arduino.me/packages/esp8266.json",target:"_blank",rel:"noopener noreferrer"},$a=p('<h4 id="_3、程序开发-2" tabindex="-1"><a class="header-anchor" href="#_3、程序开发-2" aria-hidden="true">#</a> 3、程序开发</h4><p>选择ESP32-CAM示例：文件--&gt;示例--&gt;ESP32--&gt;Camera--&gt;CameraWebServer</p><img src="'+Ns+'" width="800"><p>生成四个文件</p><img src="'+Os+`" width="800"><p>替换CameraWebServer.ino中的代码程序</p><div class="language-c++ line-numbers-mode" data-ext="c++"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#C678DD;">#include</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;esp_camera.h&quot;</span></span>
<span class="line"><span style="color:#C678DD;">#include</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&lt;WiFi.h&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">#define</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">CAMERA_MODEL_AI_THINKER</span><span style="color:#ABB2BF;"> // Has PSRAM 这是ESP32-CAM</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">#include</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;camera_pins.h&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// ===========================</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// Enter your WiFi credentials</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// ===========================</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">char</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">*</span><span style="color:#ABB2BF;">ssid </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;test_wifi&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">char</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">*</span><span style="color:#ABB2BF;">password </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;123456888&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">void</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">startCameraServer</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#C678DD;">void</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">setupLedFlash</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">int</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;font-style:italic;">pin</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">void</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">setup</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">Serial</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">begin</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">115200</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">Serial</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">setDebugOutput</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">true</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">Serial</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">println</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#56B6C2;">camera_config_t</span><span style="color:#ABB2BF;"> config;</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">config</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">ledc_channel</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> LEDC_CHANNEL_0;</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">config</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">ledc_timer</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> LEDC_TIMER_0;</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">config</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">pin_d0</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> Y2_GPIO_NUM;</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">config</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">pin_d1</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> Y3_GPIO_NUM;</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">config</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">pin_d2</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> Y4_GPIO_NUM;</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">config</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">pin_d3</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> Y5_GPIO_NUM;</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">config</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">pin_d4</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> Y6_GPIO_NUM;</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">config</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">pin_d5</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> Y7_GPIO_NUM;</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">config</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">pin_d6</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> Y8_GPIO_NUM;</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">config</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">pin_d7</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> Y9_GPIO_NUM;</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">config</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">pin_xclk</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> XCLK_GPIO_NUM;</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">config</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">pin_pclk</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> PCLK_GPIO_NUM;</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">config</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">pin_vsync</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> VSYNC_GPIO_NUM;</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">config</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">pin_href</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> HREF_GPIO_NUM;</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">config</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">pin_sccb_sda</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> SIOD_GPIO_NUM;</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">config</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">pin_sccb_scl</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> SIOC_GPIO_NUM;</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">config</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">pin_pwdn</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> PWDN_GPIO_NUM;</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">config</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">pin_reset</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> RESET_GPIO_NUM;</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">config</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">xclk_freq_hz</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">20000000</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">config</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">frame_size</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> FRAMESIZE_UXGA;</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">config</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">pixel_format</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> PIXFORMAT_JPEG;</span><span style="color:#7F848E;font-style:italic;">  // for streaming</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  //config.pixel_format = PIXFORMAT_RGB565; // for face detection/recognition</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">config</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">grab_mode</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> CAMERA_GRAB_WHEN_EMPTY;</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">config</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">fb_location</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> CAMERA_FB_IN_PSRAM;</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">config</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">jpeg_quality</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">12</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">config</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">fb_count</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  // if PSRAM IC present, init with UXGA resolution and higher JPEG quality</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  //                      for larger pre-allocated frame buffer.</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">config</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">pixel_format</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">==</span><span style="color:#ABB2BF;"> PIXFORMAT_JPEG) {</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#61AFEF;">psramFound</span><span style="color:#ABB2BF;">()) {</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E5C07B;">config</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">jpeg_quality</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E5C07B;">config</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">fb_count</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E5C07B;">config</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">grab_mode</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> CAMERA_GRAB_LATEST;</span></span>
<span class="line"><span style="color:#ABB2BF;">    } </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">      // Limit the frame size when PSRAM is not available</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E5C07B;">config</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">frame_size</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> FRAMESIZE_SVGA;</span></span>
<span class="line"><span style="color:#ABB2BF;">      </span><span style="color:#E5C07B;">config</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">fb_location</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> CAMERA_FB_IN_DRAM;</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">  } </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">    // Best option for face detection/recognition</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">config</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">frame_size</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> FRAMESIZE_240X240;</span></span>
<span class="line"><span style="color:#C678DD;">#if</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">CONFIG_IDF_TARGET_ESP32S3</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">config</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">fb_count</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#C678DD;">#endif</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">#if</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">defined</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">CAMERA_MODEL_ESP_EYE</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#61AFEF;">pinMode</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">13</span><span style="color:#ABB2BF;">, INPUT_PULLUP);</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#61AFEF;">pinMode</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">14</span><span style="color:#ABB2BF;">, INPUT_PULLUP);</span></span>
<span class="line"><span style="color:#C678DD;">#endif</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  // camera init</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#56B6C2;">esp_err_t</span><span style="color:#ABB2BF;"> err </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">esp_camera_init</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">&amp;</span><span style="color:#ABB2BF;">config);</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (err </span><span style="color:#C678DD;">!=</span><span style="color:#ABB2BF;"> ESP_OK) {</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">Serial</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">printf</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Camera init failed with error 0x</span><span style="color:#D19A66;">%x</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">, err);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#56B6C2;">sensor_t</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">*</span><span style="color:#ABB2BF;">s </span><span style="color:#C678DD;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">esp_camera_sensor_get</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  // initial sensors are flipped vertically and colors are a bit saturated</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">s</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#E5C07B;">id</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">PID</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">==</span><span style="color:#ABB2BF;"> OV3660_PID) {</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">s</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#61AFEF;">set_vflip</span><span style="color:#ABB2BF;">(s, </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">);</span><span style="color:#7F848E;font-style:italic;">        // flip it back</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">s</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#61AFEF;">set_brightness</span><span style="color:#ABB2BF;">(s, </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">);</span><span style="color:#7F848E;font-style:italic;">   // up the brightness just a bit</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">s</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#61AFEF;">set_saturation</span><span style="color:#ABB2BF;">(s, </span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">);</span><span style="color:#7F848E;font-style:italic;">  // lower the saturation</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  // drop down frame size for higher initial frame rate</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">config</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">pixel_format</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">==</span><span style="color:#ABB2BF;"> PIXFORMAT_JPEG) {</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">s</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#61AFEF;">set_framesize</span><span style="color:#ABB2BF;">(s, FRAMESIZE_QVGA);</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">#if</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">defined</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">CAMERA_MODEL_M5STACK_WIDE</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">||</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">defined</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">CAMERA_MODEL_M5STACK_ESP32CAM</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">s</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#61AFEF;">set_vflip</span><span style="color:#ABB2BF;">(s, </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">s</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#61AFEF;">set_hmirror</span><span style="color:#ABB2BF;">(s, </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">#endif</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">#if</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">defined</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">CAMERA_MODEL_ESP32S3_EYE</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">s</span><span style="color:#ABB2BF;">-&gt;</span><span style="color:#61AFEF;">set_vflip</span><span style="color:#ABB2BF;">(s, </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#C678DD;">#endif</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">// Setup LED FLash if LED pin is defined in camera_pins.h</span></span>
<span class="line"><span style="color:#C678DD;">#if</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">defined</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">LED_GPIO_NUM</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#61AFEF;">setupLedFlash</span><span style="color:#ABB2BF;">(LED_GPIO_NUM);</span></span>
<span class="line"><span style="color:#C678DD;">#endif</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">WiFi</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">begin</span><span style="color:#ABB2BF;">(ssid, password);</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">WiFi</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">setSleep</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">false</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">Serial</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;WiFi connecting&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">while</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">WiFi</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">status</span><span style="color:#ABB2BF;">() </span><span style="color:#C678DD;">!=</span><span style="color:#ABB2BF;"> WL_CONNECTED) {</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#61AFEF;">delay</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">500</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E5C07B;">Serial</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;.&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">  }</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">Serial</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">println</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">Serial</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">println</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;WiFi connected&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#61AFEF;">startCameraServer</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"> // 点亮 ESP32-CAM 板载 LED 灯</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#61AFEF;">pinMode</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">, OUTPUT);</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#61AFEF;">digitalWrite</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">, HIGH);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">Serial</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Camera Ready! Use &#39;http://&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">Serial</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">print</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">WiFi</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">localIP</span><span style="color:#ABB2BF;">());</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">Serial</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">println</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;&#39; to connect&quot;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">void</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">loop</span><span style="color:#ABB2BF;">() {</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">  // Do nothing. Everything is done in another task by the web server</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#61AFEF;">delay</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">10000</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_4、烧录步骤-1" tabindex="-1"><a class="header-anchor" href="#_4、烧录步骤-1" aria-hidden="true">#</a> 4、烧录步骤</h4><p>使用USB转TTL串口下载器链接ESP32-CAM开发板</p><div style="display:flex;justify-content:center;gap:50px;"><img src="`+Ms+'" width="400"><img src="'+js+'" width="400"></div><table><thead><tr><th style="text-align:center;">串口下载器</th><th style="text-align:center;">ESP32-CAM</th></tr></thead><tbody><tr><td style="text-align:center;">5V</td><td style="text-align:center;">5V</td></tr><tr><td style="text-align:center;">GND</td><td style="text-align:center;">GND</td></tr><tr><td style="text-align:center;">TXD</td><td style="text-align:center;">UOR</td></tr><tr><td style="text-align:center;">RXD</td><td style="text-align:center;">UOT</td></tr><tr><td style="text-align:center;"></td><td style="text-align:center;">IO0和GND短接（烧录完成后移除）</td></tr></tbody></table><p>链接到电脑</p><img src="'+Us+'" width="800"><p>查询串行端口</p><img src="'+o+'" width="800"><img src="'+Vs+'" width="800"><p>选择库：工具--&gt;开发板--&gt;AI Thinker ESP32-CAM</p><img src="'+Hs+'" width="800"><p>开发工具中选择端口：工具--&gt;端口--&gt;串行端口</p><img src="'+Gs+'" width="800"><p>编译程序：①和②选择无误后，点击③，出现④表示程序正在编译</p><img src="'+Ws+'" width="800"><p>程序上传至开发板：出现①中白色字体内容，表示编程成功，点击②的按钮上传程序到开发板</p><img src="'+zs+'" width="800"><p>程序烧录成功</p><img src="'+Ks+'" width="800"><h2 id="三、物联网模块组装" tabindex="-1"><a class="header-anchor" href="#三、物联网模块组装" aria-hidden="true">#</a> 三、物联网模块组装</h2><h3 id="esp8266主控组装" tabindex="-1"><a class="header-anchor" href="#esp8266主控组装" aria-hidden="true">#</a> ESP8266主控组装</h3><img src="'+Ys+'" width="900"><table><thead><tr><th style="text-align:center;">序号</th><th style="text-align:center;">模块</th><th style="text-align:center;">序号</th><th style="text-align:center;">模块</th><th style="text-align:center;">序号</th><th style="text-align:center;">模块</th></tr></thead><tbody><tr><td style="text-align:center;">1</td><td style="text-align:center;">5V锂电池</td><td style="text-align:center;">2</td><td style="text-align:center;">XH2.54转USB</td><td style="text-align:center;">3</td><td style="text-align:center;">micro USB数据线</td></tr><tr><td style="text-align:center;">4</td><td style="text-align:center;">ESP8266主控</td><td style="text-align:center;">5</td><td style="text-align:center;">ESP8266扩展板</td><td style="text-align:center;">6</td><td style="text-align:center;">数模转换器</td></tr><tr><td style="text-align:center;">7</td><td style="text-align:center;">水位探头</td><td style="text-align:center;">8</td><td style="text-align:center;">环境温湿度传感器</td><td style="text-align:center;">9</td><td style="text-align:center;">0.96寸OLED显示屏</td></tr><tr><td style="text-align:center;">10</td><td style="text-align:center;">8路继电器</td><td style="text-align:center;">11</td><td style="text-align:center;">12V锂电池</td><td style="text-align:center;">12</td><td style="text-align:center;">报警器</td></tr><tr><td style="text-align:center;">13</td><td style="text-align:center;">5V锂电池</td><td style="text-align:center;">14</td><td style="text-align:center;">增氧泵1</td><td style="text-align:center;">15</td><td style="text-align:center;">增氧泵2</td></tr><tr><td style="text-align:center;">16</td><td style="text-align:center;">雾化驱动1</td><td style="text-align:center;">17</td><td style="text-align:center;">雾化驱动2</td><td style="text-align:center;">18</td><td style="text-align:center;">水泵</td></tr></tbody></table><h3 id="stm32水质检测组装" tabindex="-1"><a class="header-anchor" href="#stm32水质检测组装" aria-hidden="true">#</a> STM32水质检测组装</h3><img src="'+Xs+'" width="900"><table><thead><tr><th style="text-align:center;">序号</th><th style="text-align:center;">模块</th><th style="text-align:center;">序号</th><th style="text-align:center;">模块</th><th style="text-align:center;">序号</th><th style="text-align:center;">模块</th></tr></thead><tbody><tr><td style="text-align:center;">1</td><td style="text-align:center;">5V锂电池</td><td style="text-align:center;">2</td><td style="text-align:center;">XH2.54转USB</td><td style="text-align:center;">3</td><td style="text-align:center;">DC3.5mm电源线</td></tr><tr><td style="text-align:center;">4</td><td style="text-align:center;">开关按键</td><td style="text-align:center;">5</td><td style="text-align:center;">DC3.5mm母座</td><td style="text-align:center;">6</td><td style="text-align:center;">STM32单片机</td></tr><tr><td style="text-align:center;">7</td><td style="text-align:center;">0.96寸OLED显示屏</td><td style="text-align:center;">8</td><td style="text-align:center;">ESP-01Swifi模块</td><td style="text-align:center;">9</td><td style="text-align:center;">数模转换器</td></tr><tr><td style="text-align:center;">10</td><td style="text-align:center;">XH2.54端子线</td><td style="text-align:center;">11</td><td style="text-align:center;">浊度传感器</td><td style="text-align:center;">12</td><td style="text-align:center;">DS18B20温度传感</td></tr><tr><td style="text-align:center;">13</td><td style="text-align:center;">蜂鸣器</td><td style="text-align:center;">14</td><td style="text-align:center;">PH监测模块</td><td style="text-align:center;">15</td><td style="text-align:center;">PH电极探头</td></tr></tbody></table><h3 id="系统总装" tabindex="-1"><a class="header-anchor" href="#系统总装" aria-hidden="true">#</a> 系统总装</h3><img src="'+Js+'" width="900"><table><thead><tr><th style="text-align:center;">序号</th><th style="text-align:center;">模块</th><th style="text-align:center;">序号</th><th style="text-align:center;">模块</th><th style="text-align:center;">序号</th><th style="text-align:center;">模块</th></tr></thead><tbody><tr><td style="text-align:center;">1</td><td style="text-align:center;">无线网络/局域网</td><td style="text-align:center;">2</td><td style="text-align:center;">ESP8266主控组</td><td style="text-align:center;">3</td><td style="text-align:center;">STM32水质检测组</td></tr><tr><td style="text-align:center;">4</td><td style="text-align:center;">服务器</td><td style="text-align:center;">5</td><td style="text-align:center;">4G模块</td><td style="text-align:center;">6</td><td style="text-align:center;">溶解氧传感器</td></tr><tr><td style="text-align:center;">7</td><td style="text-align:center;">溶解氧探头</td><td style="text-align:center;">8</td><td style="text-align:center;">12V锂电池</td><td style="text-align:center;">9</td><td style="text-align:center;">ESP32-CAM开发板</td></tr><tr><td style="text-align:center;">10</td><td style="text-align:center;">3V电池盒</td><td style="text-align:center;">11</td><td style="text-align:center;">平板电脑</td><td style="text-align:center;">12</td><td style="text-align:center;">电脑</td></tr><tr><td style="text-align:center;">13</td><td style="text-align:center;">拓展坞</td><td style="text-align:center;">14</td><td style="text-align:center;">USB摄像头1</td><td style="text-align:center;">15</td><td style="text-align:center;">USB摄像头2</td></tr><tr><td style="text-align:center;">16</td><td style="text-align:center;">USB转485模块</td><td style="text-align:center;">17</td><td style="text-align:center;">土壤传感器</td><td style="text-align:center;">18</td><td style="text-align:center;">12V锂电池</td></tr></tbody></table><h2 id="四、接口开发" tabindex="-1"><a class="header-anchor" href="#四、接口开发" aria-hidden="true">#</a> 四、接口开发</h2><h3 id="环境搭建" tabindex="-1"><a class="header-anchor" href="#环境搭建" aria-hidden="true">#</a> 环境搭建</h3><h4 id="_1、开发工具" tabindex="-1"><a class="header-anchor" href="#_1、开发工具" aria-hidden="true">#</a> 1、开发工具</h4><ul><li><p>Python 3.12</p></li><li><p>PyCharm 2021.3.1</p></li></ul><h4 id="_2、项目结构" tabindex="-1"><a class="header-anchor" href="#_2、项目结构" aria-hidden="true">#</a> 2、项目结构</h4><img src="'+$s+`" width="600"><h3 id="接口开发" tabindex="-1"><a class="header-anchor" href="#接口开发" aria-hidden="true">#</a> 接口开发</h3><h4 id="_1、项目依赖-requirements-txt" tabindex="-1"><a class="header-anchor" href="#_1、项目依赖-requirements-txt" aria-hidden="true">#</a> 1、项目依赖 | requirements.txt</h4><div class="language-txt line-numbers-mode" data-ext="txt"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#abb2bf;">flask~=3.0.0</span></span>
<span class="line"><span style="color:#abb2bf;">minimalmodbus~=2.1.1</span></span>
<span class="line"><span style="color:#abb2bf;">pyserial~=3.5</span></span>
<span class="line"><span style="color:#abb2bf;">requests~=2.31.0</span></span>
<span class="line"><span style="color:#abb2bf;">paho-mqtt~=2.1.0</span></span>
<span class="line"><span style="color:#abb2bf;">blynklib~=0.2.6</span></span>
<span class="line"><span style="color:#abb2bf;">opencv-python~=4.8.1.78</span></span>
<span class="line"><span style="color:#abb2bf;">comtypes~=1.4.11</span></span>
<span class="line"><span style="color:#abb2bf;">pygrabber~=0.2</span></span>
<span class="line"><span style="color:#abb2bf;">PyYAML~=6.0.1</span></span>
<span class="line"><span style="color:#abb2bf;"></span></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>安装依赖命令</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">pip</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">install</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">-r</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">requirements.txt</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="_2、配置文件-config-yaml" tabindex="-1"><a class="header-anchor" href="#_2、配置文件-config-yaml" aria-hidden="true">#</a> 2、配置文件 | config.yaml</h4><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;"># 程序启动端口</span></span>
<span class="line"><span style="color:#E06C75;">API</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E06C75;">host</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;0.0.0.0&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E06C75;">port</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">5000</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># 土壤传感器配置 port通过“电脑”&gt;“管理”&gt;“设备管理”&gt;“端口”</span></span>
<span class="line"><span style="color:#E06C75;">SOIL</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E06C75;">port</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;COM5&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E06C75;">baudRate</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">9600</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E06C75;">timeout</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">1.0</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E06C75;">slaveAddress</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># 水质传感器 token获取登录“https://www.wztdzmcu.com”；账号密码：“8252******680”</span></span>
<span class="line"><span style="color:#E06C75;">WATER</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E06C75;">device_id</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;8252******680&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E06C75;">token</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;5a0ee803******************24fd313&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># 溶解氧传感器</span></span>
<span class="line"><span style="color:#E06C75;">OXY</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E06C75;">base_url</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;http://123.*.*.104:9922&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E06C75;">serial_no</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;A20******RJ&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E06C75;">device_no</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;862************0611&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E06C75;">collection_time</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;2025-06-12&quot;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># ESP8266主板 联网后通过网络设备查</span></span>
<span class="line"><span style="color:#E06C75;">ESP8266</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E06C75;">host</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;192.168.43.212&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># 摄像头设备列表 联网后通过网络设备查</span></span>
<span class="line"><span style="color:#E06C75;">cameras</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">  - </span><span style="color:#E06C75;">id</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">1</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;北区稻田&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">ip</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;192.168.43.120&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">  - </span><span style="color:#E06C75;">id</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">2</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;南区稻田&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">ip</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;192.168.43.154&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">  - </span><span style="color:#E06C75;">id</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">3</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;吊笼检测&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">ip</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;192.168.43.237&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">  - </span><span style="color:#E06C75;">id</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">4</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;巡航船&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">ip</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;192.168.43.85&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,49),Za={id:"_3、主程序-main-py",tabindex:"-1"},Qa=s("a",{class:"header-anchor",href:"#_3、主程序-main-py","aria-hidden":"true"},"#",-1),sl={href:"http://main.py",target:"_blank",rel:"noopener noreferrer"},nl=p(`<div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> flask </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> Flask, jsonify, request</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> data.envData </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> get_envData</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> data.execute </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> DeviceController</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> data.soilData </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> read_sensor_data</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> data.videoData </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> get_video_urls, list_cameras, handle_stream</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> data.waterData </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> get_device_info, get_history_data, get_real_time_data, query_device_data</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> flask_cors </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">CORS</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> utils.configUtils </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> config</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># 本地API配置</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">host </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> config[</span><span style="color:#98C379;">&#39;API&#39;</span><span style="color:#ABB2BF;">][</span><span style="color:#98C379;">&#39;host&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">port </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> config[</span><span style="color:#98C379;">&#39;API&#39;</span><span style="color:#ABB2BF;">][</span><span style="color:#98C379;">&#39;port&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">app </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">Flask</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">__name__</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#61AFEF;">CORS</span><span style="color:#ABB2BF;">(app)  </span><span style="color:#7F848E;font-style:italic;"># 允许所有来源访问所有路由</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># === 土壤数据接口 ===</span></span>
<span class="line"><span style="color:#61AFEF;">@app</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">route</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;/api/soilData&#39;</span><span style="color:#ABB2BF;">,</span><span style="color:#61AFEF;"> </span><span style="color:#E06C75;font-style:italic;">methods</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">[</span><span style="color:#98C379;">&#39;GET&#39;</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">get_sensor_data</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">jsonify</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">read_sensor_data</span><span style="color:#ABB2BF;">())</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># === 水质溶解氧设备基本信息 ===</span></span>
<span class="line"><span style="color:#61AFEF;">@app</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">route</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;/api/waterOxyInfo&#39;</span><span style="color:#ABB2BF;">,</span><span style="color:#61AFEF;"> </span><span style="color:#E06C75;font-style:italic;">methods</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">[</span><span style="color:#98C379;">&#39;GET&#39;</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">proxy_device_data</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">jsonify</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">get_device_info</span><span style="color:#ABB2BF;">())</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># === 水质溶解氧历史数据（可配置时间） ===</span></span>
<span class="line"><span style="color:#61AFEF;">@app</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">route</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;/api/waterOxyHistory&#39;</span><span style="color:#ABB2BF;">,</span><span style="color:#61AFEF;"> </span><span style="color:#E06C75;font-style:italic;">methods</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">[</span><span style="color:#98C379;">&#39;GET&#39;</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">proxy_history_data</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">jsonify</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">get_history_data</span><span style="color:#ABB2BF;">())</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># === 水质溶解氧实时数据 ===</span></span>
<span class="line"><span style="color:#61AFEF;">@app</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">route</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;/api/waterOxyNow&#39;</span><span style="color:#ABB2BF;">,</span><span style="color:#61AFEF;"> </span><span style="color:#E06C75;font-style:italic;">methods</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">[</span><span style="color:#98C379;">&#39;GET&#39;</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">proxy_real_time_data</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">jsonify</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">get_real_time_data</span><span style="color:#ABB2BF;">())</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># === 水质数据 ===</span></span>
<span class="line"><span style="color:#61AFEF;">@app</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">route</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;/api/waterData&#39;</span><span style="color:#ABB2BF;">,</span><span style="color:#61AFEF;"> </span><span style="color:#E06C75;font-style:italic;">methods</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">[</span><span style="color:#98C379;">&#39;GET&#39;</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">get_iot_device_data</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">jsonify</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">query_device_data</span><span style="color:#ABB2BF;">())</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># === 环境数据 ===</span></span>
<span class="line"><span style="color:#61AFEF;">@app</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">route</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;/api/envData&#39;</span><span style="color:#ABB2BF;">,</span><span style="color:#61AFEF;"> </span><span style="color:#E06C75;font-style:italic;">methods</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">[</span><span style="color:#98C379;">&#39;GET&#39;</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">env_data</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">jsonify</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">get_envData</span><span style="color:#ABB2BF;">())</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># === esp32视频 ===</span></span>
<span class="line"><span style="color:#61AFEF;">@app</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">route</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;/api/videoUrl&#39;</span><span style="color:#ABB2BF;">,</span><span style="color:#61AFEF;"> </span><span style="color:#E06C75;font-style:italic;">methods</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">[</span><span style="color:#98C379;">&#39;GET&#39;</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">get_video_stream_url</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">jsonify</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">get_video_urls</span><span style="color:#ABB2BF;">())</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># 获取视屏流列表</span></span>
<span class="line"><span style="color:#61AFEF;">@app</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">route</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;/api/cameraList&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">camera_list</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">jsonify</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">list_cameras</span><span style="color:#ABB2BF;">())</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># 通过索引查看视频流</span></span>
<span class="line"><span style="color:#61AFEF;">@app</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">route</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;/api/stream&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">stream</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#ABB2BF;">    index </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> request.args.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;index&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">default</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;0&#39;</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># 默认是字符串 &#39;0&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">handle_stream</span><span style="color:#ABB2BF;">(index)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># ESP8266指令请求</span></span>
<span class="line"><span style="color:#61AFEF;">@app</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">route</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;/api/execute&#39;</span><span style="color:#ABB2BF;">,</span><span style="color:#61AFEF;"> </span><span style="color:#E06C75;font-style:italic;">methods</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">[</span><span style="color:#98C379;">&#39;GET&#39;</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">execute</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#ABB2BF;">    pin </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> request.args.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;pin&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    state </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> request.args.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;state&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">jsonify</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">DeviceController</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">control_by_pin</span><span style="color:#ABB2BF;">(pin, state))</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">__name__</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">==</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&#39;__main__&#39;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">    app.</span><span style="color:#61AFEF;">run</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">host</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">host, </span><span style="color:#E06C75;font-style:italic;">port</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">port)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),al={id:"_4、摄像头管理器-cameramanager-py",tabindex:"-1"},ll=s("a",{class:"header-anchor",href:"#_4、摄像头管理器-cameramanager-py","aria-hidden":"true"},"#",-1),pl={href:"http://CameraManager.py",target:"_blank",rel:"noopener noreferrer"},ol=p(`<div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;"># 工具类-全局摄像头管理器</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> cv2</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> threading</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> typing </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> Dict</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> collections </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> defaultdict</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">class</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">CameraManager</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">    _instance </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">None</span></span>
<span class="line"><span style="color:#ABB2BF;">    _lock </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> threading.</span><span style="color:#61AFEF;">Lock</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    _cameras: Dict[</span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">, cv2.VideoCapture] </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {}</span></span>
<span class="line"><span style="color:#ABB2BF;">    _ref_counts: Dict[</span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">, </span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">defaultdict</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">def</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">__new__</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">cls</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">cls</span><span style="color:#ABB2BF;">._instance </span><span style="color:#C678DD;">is</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#C678DD;">with</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">cls</span><span style="color:#ABB2BF;">._lock:</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">cls</span><span style="color:#ABB2BF;">._instance </span><span style="color:#C678DD;">is</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#E5C07B;">cls</span><span style="color:#ABB2BF;">._instance </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">super</span><span style="color:#ABB2BF;">().</span><span style="color:#56B6C2;">__new__</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">cls</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">cls</span><span style="color:#ABB2BF;">._instance</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">def</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">get_camera</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">camera_index</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">) -&gt; cv2.VideoCapture:</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">with</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">._lock:</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> camera_index </span><span style="color:#C678DD;">not</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">._cameras:</span></span>
<span class="line"><span style="color:#ABB2BF;">                cap </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> cv2.</span><span style="color:#61AFEF;">VideoCapture</span><span style="color:#ABB2BF;">(camera_index)</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">not</span><span style="color:#ABB2BF;"> cap.</span><span style="color:#61AFEF;">isOpened</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#C678DD;">raise</span><span style="color:#ABB2BF;"> RuntimeError(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;无法打开摄像头 </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">camera_index</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">._cameras[camera_index] </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> cap</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">._ref_counts[camera_index] </span><span style="color:#56B6C2;">+=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">1</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">._cameras[camera_index]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">def</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">release</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">camera_index</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">):  </span><span style="color:#7F848E;font-style:italic;"># 修改了方法名</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">with</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">._lock:</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> camera_index </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">._ref_counts:</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">._ref_counts[camera_index] </span><span style="color:#56B6C2;">-=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">1</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">._ref_counts[camera_index] </span><span style="color:#56B6C2;">&lt;=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> camera_index </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">._cameras:</span></span>
<span class="line"><span style="color:#ABB2BF;">                        </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">._cameras[camera_index].</span><span style="color:#61AFEF;">release</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">                        </span><span style="color:#C678DD;">del</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">._cameras[camera_index]</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#C678DD;">del</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">._ref_counts[camera_index]</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),el={id:"_5、全局配置获取-configutils-py",tabindex:"-1"},tl=s("a",{class:"header-anchor",href:"#_5、全局配置获取-configutils-py","aria-hidden":"true"},"#",-1),cl={href:"http://configUtils.py",target:"_blank",rel:"noopener noreferrer"},Bl=p(`<div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;"># 工具类-全局配置获取</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> pathlib </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> Path</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> yaml</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">load_yaml_config</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#ABB2BF;">    config_path </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">Path</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">__file__</span><span style="color:#ABB2BF;">).parent.parent </span><span style="color:#56B6C2;">/</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;config.yaml&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#56B6C2;">print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;配置文件绝对路径：&quot;</span><span style="color:#ABB2BF;">, config_path.</span><span style="color:#61AFEF;">resolve</span><span style="color:#ABB2BF;">())</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">not</span><span style="color:#ABB2BF;"> config_path.</span><span style="color:#61AFEF;">exists</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">raise</span><span style="color:#ABB2BF;"> FileNotFoundError(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;配置文件不存在于：</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">config_path</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">with</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">open</span><span style="color:#ABB2BF;">(config_path, </span><span style="color:#98C379;">&#39;r&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">encoding</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;utf-8&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> f:</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> yaml.</span><span style="color:#61AFEF;">safe_load</span><span style="color:#ABB2BF;">(f)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># 全局配置对象</span></span>
<span class="line"><span style="color:#ABB2BF;">config </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">load_yaml_config</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),rl={id:"_6、封装返回结果-resputils-py",tabindex:"-1"},il=s("a",{class:"header-anchor",href:"#_6、封装返回结果-resputils-py","aria-hidden":"true"},"#",-1),yl={href:"http://respUtils.py",target:"_blank",rel:"noopener noreferrer"},Al=p(`<div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;"># 工具类-封装返回结果</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> typing </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> Any, Dict, Optional</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> datetime </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> datetime</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">res</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#D19A66;font-style:italic;">success</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">bool</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#D19A66;font-style:italic;">data</span><span style="color:#ABB2BF;">: Any </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#D19A66;font-style:italic;">message</span><span style="color:#ABB2BF;">: Optional[</span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#D19A66;font-style:italic;">custom_code</span><span style="color:#ABB2BF;">: Optional[</span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">None</span></span>
<span class="line"><span style="color:#ABB2BF;">) -&gt; Dict[</span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">, Any]:</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#98C379;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">    统一API响应格式</span></span>
<span class="line"></span>
<span class="line"><span style="color:#98C379;">    :param success: 请求是否成功</span></span>
<span class="line"><span style="color:#98C379;">    :param data: 返回的数据，默认为None</span></span>
<span class="line"><span style="color:#98C379;">    :param message: 自定义错误信息，默认为None（失败时默认使用&quot;请求失败&quot;）</span></span>
<span class="line"><span style="color:#98C379;">    :param custom_code: 自定义状态码，默认为None（成功200，失败400）</span></span>
<span class="line"><span style="color:#98C379;">    :return: 包含code、message、data和timestamp的字典</span></span>
<span class="line"><span style="color:#98C379;">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> success:</span></span>
<span class="line"><span style="color:#ABB2BF;">        response </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#98C379;">&quot;code&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">200</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#98C379;">&quot;message&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;请求成功&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#98C379;">&quot;data&quot;</span><span style="color:#ABB2BF;">: data,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#98C379;">&quot;timestamp&quot;</span><span style="color:#ABB2BF;">: datetime.</span><span style="color:#61AFEF;">now</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;"> %H:%M:%S&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        response </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#98C379;">&quot;code&quot;</span><span style="color:#ABB2BF;">: custom_code </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> custom_code </span><span style="color:#C678DD;">is</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">not</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">400</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#98C379;">&quot;message&quot;</span><span style="color:#ABB2BF;">: message </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> message </span><span style="color:#C678DD;">is</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">not</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;请求失败&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#98C379;">&quot;data&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#98C379;">&quot;timestamp&quot;</span><span style="color:#ABB2BF;">: datetime.</span><span style="color:#61AFEF;">now</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;"> %H:%M:%S&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#7F848E;font-style:italic;"># 如果提供了自定义状态码，则覆盖默认值</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> custom_code </span><span style="color:#C678DD;">is</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">not</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        response[</span><span style="color:#98C379;">&quot;code&quot;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> custom_code</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> response</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),dl={id:"_7、环境数据-envdata-py",tabindex:"-1"},Fl=s("a",{class:"header-anchor",href:"#_7、环境数据-envdata-py","aria-hidden":"true"},"#",-1),vl={href:"http://envData.py",target:"_blank",rel:"noopener noreferrer"},ul=p(`<div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;"># 环境</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> requests</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> datetime </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> datetime, timedelta</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> utils.configUtils </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> config</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> utils.respUtils </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> res</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">class</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">ESP8266SensorReader</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">def</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">__init__</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">ip</span><span style="color:#ABB2BF;">=</span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">timeout</span><span style="color:#ABB2BF;">=</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.base_url </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;http://</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">ip </span><span style="color:#C678DD;">or</span><span style="color:#ABB2BF;"> config[</span><span style="color:#98C379;">&#39;ESP8266&#39;</span><span style="color:#ABB2BF;">][</span><span style="color:#98C379;">&#39;host&#39;</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">strip</span><span style="color:#ABB2BF;">()</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.timeout </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> timeout</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.cache </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#98C379;">&#39;temperature&#39;</span><span style="color:#ABB2BF;">: {</span><span style="color:#98C379;">&#39;value&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;status&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;timestamp&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;">},</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#98C379;">&#39;humidity&#39;</span><span style="color:#ABB2BF;">: {</span><span style="color:#98C379;">&#39;value&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;status&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;timestamp&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;">},</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#98C379;">&#39;water_level&#39;</span><span style="color:#ABB2BF;">: {</span><span style="color:#98C379;">&#39;value&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;status&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;timestamp&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;">},</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#98C379;">&#39;water_percent&#39;</span><span style="color:#ABB2BF;">: {</span><span style="color:#98C379;">&#39;value&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;status&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;timestamp&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;"># 水位传感器校准值（根据实际测量调整）</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.water_calibration </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#98C379;">&#39;dry&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">200</span><span style="color:#ABB2BF;">,  </span><span style="color:#7F848E;font-style:italic;"># 空水位ADC值</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#98C379;">&#39;wet&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">800</span><span style="color:#ABB2BF;">,  </span><span style="color:#7F848E;font-style:italic;"># 满水位ADC值</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#98C379;">&#39;min_percent&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#98C379;">&#39;max_percent&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">100</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">def</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">_fetch_sensor_data</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#98C379;">&quot;&quot;&quot;从ESP8266获取传感器数据&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            response </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> requests.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">{</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.base_url</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">/sensors&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#E06C75;font-style:italic;">timeout</span><span style="color:#56B6C2;">=</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.timeout</span></span>
<span class="line"><span style="color:#ABB2BF;">            )</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> response.status_code </span><span style="color:#56B6C2;">==</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">200</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                data </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#98C379;">&#39;status&#39;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#ABB2BF;">                        </span><span style="color:#98C379;">&#39;dht&#39;</span><span style="color:#ABB2BF;">: data.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;status&#39;</span><span style="color:#ABB2BF;">, {}).</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;dht&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">==</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                        </span><span style="color:#98C379;">&#39;soil&#39;</span><span style="color:#ABB2BF;">: data.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;status&#39;</span><span style="color:#ABB2BF;">, {}).</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;soil&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">==</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">1</span></span>
<span class="line"><span style="color:#ABB2BF;">                    },</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#98C379;">&#39;data&#39;</span><span style="color:#ABB2BF;">: data.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;data&#39;</span><span style="color:#ABB2BF;">, {})</span></span>
<span class="line"><span style="color:#ABB2BF;">                }</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">None</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#56B6C2;">print</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;传感器请求异常: </span><span style="color:#D19A66;">{</span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">(e)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">None</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">def</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">_calibrate_water</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">raw_value</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#98C379;">&quot;&quot;&quot;水位传感器校准&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> raw_value </span><span style="color:#C678DD;">is</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">None</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        dry </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.water_calibration[</span><span style="color:#98C379;">&#39;dry&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">        wet </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.water_calibration[</span><span style="color:#98C379;">&#39;wet&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">        min_p </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.water_calibration[</span><span style="color:#98C379;">&#39;min_percent&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">        max_p </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.water_calibration[</span><span style="color:#98C379;">&#39;max_percent&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;"># 计算百分比并限制在范围内</span></span>
<span class="line"><span style="color:#ABB2BF;">        percent </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> (raw_value </span><span style="color:#56B6C2;">-</span><span style="color:#ABB2BF;"> dry) </span><span style="color:#56B6C2;">/</span><span style="color:#ABB2BF;"> (wet </span><span style="color:#56B6C2;">-</span><span style="color:#ABB2BF;"> dry) </span><span style="color:#56B6C2;">*</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">100</span></span>
<span class="line"><span style="color:#ABB2BF;">        percent </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">max</span><span style="color:#ABB2BF;">(min_p, </span><span style="color:#56B6C2;">min</span><span style="color:#ABB2BF;">(max_p, percent))</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">(percent)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">def</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">get_cached_data</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">max_age_seconds</span><span style="color:#ABB2BF;">=</span><span style="color:#D19A66;">30</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#98C379;">&quot;&quot;&quot;获取带缓存的传感器数据&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        now </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> datetime.</span><span style="color:#61AFEF;">now</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        need_refresh </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">False</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;"># 检查是否需要刷新缓存</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> key </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.cache:</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.cache[key][</span><span style="color:#98C379;">&#39;timestamp&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#C678DD;">is</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">or</span></span>
<span class="line"><span style="color:#ABB2BF;">                    (now </span><span style="color:#56B6C2;">-</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.cache[key][</span><span style="color:#98C379;">&#39;timestamp&#39;</span><span style="color:#ABB2BF;">]) </span><span style="color:#56B6C2;">&gt;</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">timedelta</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">seconds</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">max_age_seconds)):</span></span>
<span class="line"><span style="color:#ABB2BF;">                need_refresh </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">True</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#C678DD;">break</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> need_refresh:</span></span>
<span class="line"><span style="color:#ABB2BF;">            fresh_data </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">_fetch_sensor_data</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> fresh_data:</span></span>
<span class="line"><span style="color:#ABB2BF;">                timestamp </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> now</span></span>
<span class="line"><span style="color:#ABB2BF;">                dht_status </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> fresh_data[</span><span style="color:#98C379;">&#39;status&#39;</span><span style="color:#ABB2BF;">][</span><span style="color:#98C379;">&#39;dht&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">                soil_status </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> fresh_data[</span><span style="color:#98C379;">&#39;status&#39;</span><span style="color:#ABB2BF;">][</span><span style="color:#98C379;">&#39;soil&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#7F848E;font-style:italic;"># 更新温度</span></span>
<span class="line"><span style="color:#ABB2BF;">                temp </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> fresh_data[</span><span style="color:#98C379;">&#39;data&#39;</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;temperature&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.cache[</span><span style="color:#98C379;">&#39;temperature&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#98C379;">&#39;value&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">float</span><span style="color:#ABB2BF;">(temp) </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> dht_status </span><span style="color:#C678DD;">and</span><span style="color:#ABB2BF;"> temp </span><span style="color:#C678DD;">is</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">not</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#98C379;">&#39;status&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> dht_status </span><span style="color:#C678DD;">and</span><span style="color:#ABB2BF;"> temp </span><span style="color:#C678DD;">is</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">not</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#98C379;">&#39;timestamp&#39;</span><span style="color:#ABB2BF;">: timestamp</span></span>
<span class="line"><span style="color:#ABB2BF;">                }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#7F848E;font-style:italic;"># 更新湿度</span></span>
<span class="line"><span style="color:#ABB2BF;">                humi </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> fresh_data[</span><span style="color:#98C379;">&#39;data&#39;</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;humidity&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.cache[</span><span style="color:#98C379;">&#39;humidity&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#98C379;">&#39;value&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">float</span><span style="color:#ABB2BF;">(humi) </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> dht_status </span><span style="color:#C678DD;">and</span><span style="color:#ABB2BF;"> humi </span><span style="color:#C678DD;">is</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">not</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#98C379;">&#39;status&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> dht_status </span><span style="color:#C678DD;">and</span><span style="color:#ABB2BF;"> humi </span><span style="color:#C678DD;">is</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">not</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#98C379;">&#39;timestamp&#39;</span><span style="color:#ABB2BF;">: timestamp</span></span>
<span class="line"><span style="color:#ABB2BF;">                }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#7F848E;font-style:italic;"># 更新水位原始值</span></span>
<span class="line"><span style="color:#ABB2BF;">                water_level </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> fresh_data[</span><span style="color:#98C379;">&#39;data&#39;</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;water_level&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.cache[</span><span style="color:#98C379;">&#39;water_level&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#98C379;">&#39;value&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">(water_level) </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> soil_status </span><span style="color:#C678DD;">and</span><span style="color:#ABB2BF;"> water_level </span><span style="color:#C678DD;">is</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">not</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#98C379;">&#39;status&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> soil_status </span><span style="color:#C678DD;">and</span><span style="color:#ABB2BF;"> water_level </span><span style="color:#C678DD;">is</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">not</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#98C379;">&#39;timestamp&#39;</span><span style="color:#ABB2BF;">: timestamp</span></span>
<span class="line"><span style="color:#ABB2BF;">                }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#7F848E;font-style:italic;"># 更新水位百分比</span></span>
<span class="line"><span style="color:#ABB2BF;">                water_percent </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">None</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> soil_status </span><span style="color:#C678DD;">and</span><span style="color:#ABB2BF;"> water_level </span><span style="color:#C678DD;">is</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">not</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                    water_percent </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">_calibrate_water</span><span style="color:#ABB2BF;">(water_level)</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.cache[</span><span style="color:#98C379;">&#39;water_percent&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#98C379;">&#39;value&#39;</span><span style="color:#ABB2BF;">: water_percent,</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#98C379;">&#39;status&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> water_percent </span><span style="color:#C678DD;">is</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">not</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#98C379;">&#39;timestamp&#39;</span><span style="color:#ABB2BF;">: timestamp</span></span>
<span class="line"><span style="color:#ABB2BF;">                }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#98C379;">&#39;temperature&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.cache[</span><span style="color:#98C379;">&#39;temperature&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#98C379;">&#39;humidity&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.cache[</span><span style="color:#98C379;">&#39;humidity&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#98C379;">&#39;water_level&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.cache[</span><span style="color:#98C379;">&#39;water_level&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#98C379;">&#39;water_percent&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.cache[</span><span style="color:#98C379;">&#39;water_percent&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">get_envData</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#ABB2BF;">    sensor_reader </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">ESP8266SensorReader</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    sensor_data </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> sensor_reader.</span><span style="color:#61AFEF;">get_cached_data</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">res</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;font-style:italic;">success</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;font-style:italic;">data</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#98C379;">&quot;speed&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#98C379;">&quot;status&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#98C379;">&quot;value&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;3.2-5.7m/s&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">            },</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#98C379;">&quot;direction&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#98C379;">&quot;status&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#98C379;">&quot;value&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;西北&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            },</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#98C379;">&quot;light&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#98C379;">&quot;status&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#98C379;">&quot;value&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">450</span></span>
<span class="line"><span style="color:#ABB2BF;">            },</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#98C379;">&quot;temp&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#98C379;">&quot;status&quot;</span><span style="color:#ABB2BF;">: sensor_data[</span><span style="color:#98C379;">&#39;temperature&#39;</span><span style="color:#ABB2BF;">][</span><span style="color:#98C379;">&#39;status&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#98C379;">&quot;value&quot;</span><span style="color:#ABB2BF;">: sensor_data[</span><span style="color:#98C379;">&#39;temperature&#39;</span><span style="color:#ABB2BF;">][</span><span style="color:#98C379;">&#39;value&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> sensor_data[</span><span style="color:#98C379;">&#39;temperature&#39;</span><span style="color:#ABB2BF;">][</span><span style="color:#98C379;">&#39;status&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">None</span></span>
<span class="line"><span style="color:#ABB2BF;">            },</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#98C379;">&quot;humidity&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#98C379;">&quot;status&quot;</span><span style="color:#ABB2BF;">: sensor_data[</span><span style="color:#98C379;">&#39;humidity&#39;</span><span style="color:#ABB2BF;">][</span><span style="color:#98C379;">&#39;status&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#98C379;">&quot;value&quot;</span><span style="color:#ABB2BF;">: sensor_data[</span><span style="color:#98C379;">&#39;humidity&#39;</span><span style="color:#ABB2BF;">][</span><span style="color:#98C379;">&#39;value&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> sensor_data[</span><span style="color:#98C379;">&#39;humidity&#39;</span><span style="color:#ABB2BF;">][</span><span style="color:#98C379;">&#39;status&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">None</span></span>
<span class="line"><span style="color:#ABB2BF;">            },</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#98C379;">&quot;water&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#98C379;">&quot;status&quot;</span><span style="color:#ABB2BF;">: sensor_data[</span><span style="color:#98C379;">&#39;water_level&#39;</span><span style="color:#ABB2BF;">][</span><span style="color:#98C379;">&#39;status&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#98C379;">&quot;deep&quot;</span><span style="color:#ABB2BF;">: sensor_data[</span><span style="color:#98C379;">&#39;water_level&#39;</span><span style="color:#ABB2BF;">][</span><span style="color:#98C379;">&#39;value&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> sensor_data[</span><span style="color:#98C379;">&#39;water_level&#39;</span><span style="color:#ABB2BF;">][</span><span style="color:#98C379;">&#39;status&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#98C379;">&quot;value&quot;</span><span style="color:#ABB2BF;">: sensor_data[</span><span style="color:#98C379;">&#39;water_percent&#39;</span><span style="color:#ABB2BF;">][</span><span style="color:#98C379;">&#39;value&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> sensor_data[</span><span style="color:#98C379;">&#39;water_percent&#39;</span><span style="color:#ABB2BF;">][</span><span style="color:#98C379;">&#39;status&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">None</span></span>
<span class="line"><span style="color:#ABB2BF;">            }</span></span>
<span class="line"><span style="color:#ABB2BF;">        },</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;font-style:italic;">message</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;请求成功&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    )</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),ml={id:"_8、土壤数据-soildata-py",tabindex:"-1"},Cl=s("a",{class:"header-anchor",href:"#_8、土壤数据-soildata-py","aria-hidden":"true"},"#",-1),Dl={href:"http://soilData.py",target:"_blank",rel:"noopener noreferrer"},bl=p(`<div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;"># 土壤传感器</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> minimalmodbus</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> serial</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> typing </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> Dict, Any</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> utils.configUtils </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> config</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> utils.respUtils </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> res</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># 读取配置</span></span>
<span class="line"><span style="color:#ABB2BF;">port </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> config[</span><span style="color:#98C379;">&#39;SOIL&#39;</span><span style="color:#ABB2BF;">][</span><span style="color:#98C379;">&#39;port&#39;</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">strip</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">baudRate </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> config[</span><span style="color:#98C379;">&#39;SOIL&#39;</span><span style="color:#ABB2BF;">][</span><span style="color:#98C379;">&#39;baudRate&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">timeout </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> config[</span><span style="color:#98C379;">&#39;SOIL&#39;</span><span style="color:#ABB2BF;">][</span><span style="color:#98C379;">&#39;timeout&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">slaveAddress </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> config[</span><span style="color:#98C379;">&#39;SOIL&#39;</span><span style="color:#ABB2BF;">][</span><span style="color:#98C379;">&#39;slaveAddress&#39;</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">REGISTER_MAP</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#98C379;">&#39;temperature&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">48</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#98C379;">&#39;humidity&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">49</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#98C379;">&#39;conductivity&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">50</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#98C379;">&#39;ph&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">52</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#98C379;">&#39;nitrogen&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">53</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#98C379;">&#39;phosphorus&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">54</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#98C379;">&#39;potassium&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">55</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">read_sensor_data</span><span style="color:#ABB2BF;">() -&gt; Dict[</span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">, Any]:</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#98C379;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">    读取传感器数据</span></span>
<span class="line"><span style="color:#98C379;">    :return: 统一格式的响应字典</span></span>
<span class="line"><span style="color:#98C379;">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        instrument </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> minimalmodbus.</span><span style="color:#61AFEF;">Instrument</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">port</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">port, </span><span style="color:#E06C75;font-style:italic;">slaveaddress</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">slaveAddress)</span></span>
<span class="line"><span style="color:#ABB2BF;">        instrument.serial.baudrate </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> baudRate</span></span>
<span class="line"><span style="color:#ABB2BF;">        instrument.serial.timeout </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> timeout</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">not</span><span style="color:#ABB2BF;"> instrument.serial.is_open:</span></span>
<span class="line"><span style="color:#ABB2BF;">            instrument.serial.</span><span style="color:#61AFEF;">open</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        sensor_data </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#98C379;">&#39;temperature&#39;</span><span style="color:#ABB2BF;">: instrument.</span><span style="color:#61AFEF;">read_register</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">REGISTER_MAP</span><span style="color:#ABB2BF;">[</span><span style="color:#98C379;">&#39;temperature&#39;</span><span style="color:#ABB2BF;">], </span><span style="color:#E06C75;font-style:italic;">number_of_decimals</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">),</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#98C379;">&#39;humidity&#39;</span><span style="color:#ABB2BF;">: instrument.</span><span style="color:#61AFEF;">read_register</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">REGISTER_MAP</span><span style="color:#ABB2BF;">[</span><span style="color:#98C379;">&#39;humidity&#39;</span><span style="color:#ABB2BF;">], </span><span style="color:#E06C75;font-style:italic;">number_of_decimals</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">),</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#98C379;">&#39;conductivity&#39;</span><span style="color:#ABB2BF;">: instrument.</span><span style="color:#61AFEF;">read_register</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">REGISTER_MAP</span><span style="color:#ABB2BF;">[</span><span style="color:#98C379;">&#39;conductivity&#39;</span><span style="color:#ABB2BF;">]),</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#98C379;">&#39;ph&#39;</span><span style="color:#ABB2BF;">: instrument.</span><span style="color:#61AFEF;">read_register</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">REGISTER_MAP</span><span style="color:#ABB2BF;">[</span><span style="color:#98C379;">&#39;ph&#39;</span><span style="color:#ABB2BF;">], </span><span style="color:#E06C75;font-style:italic;">number_of_decimals</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">),</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#98C379;">&#39;nitrogen&#39;</span><span style="color:#ABB2BF;">: instrument.</span><span style="color:#61AFEF;">read_register</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">REGISTER_MAP</span><span style="color:#ABB2BF;">[</span><span style="color:#98C379;">&#39;nitrogen&#39;</span><span style="color:#ABB2BF;">]),</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#98C379;">&#39;phosphorus&#39;</span><span style="color:#ABB2BF;">: instrument.</span><span style="color:#61AFEF;">read_register</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">REGISTER_MAP</span><span style="color:#ABB2BF;">[</span><span style="color:#98C379;">&#39;phosphorus&#39;</span><span style="color:#ABB2BF;">]),</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#98C379;">&#39;potassium&#39;</span><span style="color:#ABB2BF;">: instrument.</span><span style="color:#61AFEF;">read_register</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">REGISTER_MAP</span><span style="color:#ABB2BF;">[</span><span style="color:#98C379;">&#39;potassium&#39;</span><span style="color:#ABB2BF;">])</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        instrument.serial.</span><span style="color:#61AFEF;">close</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">res</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;font-style:italic;">success</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;font-style:italic;">data</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#98C379;">&#39;status&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">,  </span><span style="color:#7F848E;font-style:italic;"># 连接正常</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#98C379;">&#39;sensor_data&#39;</span><span style="color:#ABB2BF;">: sensor_data  </span><span style="color:#7F848E;font-style:italic;"># 传感器数据</span></span>
<span class="line"><span style="color:#ABB2BF;">            },</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;font-style:italic;">message</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;数据读取成功&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">except</span><span style="color:#ABB2BF;"> (serial.SerialException, FileNotFoundError):</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;"># 串口异常返回：空数据 + status=0</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">res</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;font-style:italic;">success</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;font-style:italic;">data</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#98C379;">&#39;status&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">,  </span><span style="color:#7F848E;font-style:italic;"># 连接异常</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#98C379;">&#39;sensor_data&#39;</span><span style="color:#ABB2BF;">: {}  </span><span style="color:#7F848E;font-style:italic;"># 空数据</span></span>
<span class="line"><span style="color:#ABB2BF;">            },</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;font-style:italic;">message</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;设备离线，请检查土壤传感器连接&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        )</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;"># 其他异常返回：空数据 + status=0</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">res</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;font-style:italic;">success</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">False</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;font-style:italic;">data</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#98C379;">&#39;status&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">,  </span><span style="color:#7F848E;font-style:italic;"># 连接异常</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#98C379;">&#39;sensor_data&#39;</span><span style="color:#ABB2BF;">: {}  </span><span style="color:#7F848E;font-style:italic;"># 空数据</span></span>
<span class="line"><span style="color:#ABB2BF;">            },</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;font-style:italic;">message</span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;读取数据时发生错误: </span><span style="color:#D19A66;">{</span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">(e)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;font-style:italic;">custom_code</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">500</span></span>
<span class="line"><span style="color:#ABB2BF;">        )</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),El={id:"_9、视屏流数据-videodata-py",tabindex:"-1"},gl=s("a",{class:"header-anchor",href:"#_9、视屏流数据-videodata-py","aria-hidden":"true"},"#",-1),hl={href:"http://videoData.py",target:"_blank",rel:"noopener noreferrer"},fl=p(`<div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;"># 视频流</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> flask </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> Response</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> utils.CameraManager </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> CameraManager</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> utils.configUtils </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> config</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> utils.respUtils </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> res</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> pygrabber.dshow_graph </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> FilterGraph</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> comtypes</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> typing </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> Any, Dict, Generator</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> cv2</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># esp32-cam视频画面</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">get_video_urls</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">res</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;font-style:italic;">success</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;font-style:italic;">data</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">config[</span><span style="color:#98C379;">&#39;cameras&#39;</span><span style="color:#ABB2BF;">],</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;font-style:italic;">message</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;视频流地址获取成功&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    )</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># 本地摄像头列表</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">list_cameras</span><span style="color:#ABB2BF;">() -&gt; Dict[</span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">, Any]:</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#98C379;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">    获取摄像头列表，封装为统一响应格式</span></span>
<span class="line"><span style="color:#98C379;">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        comtypes.</span><span style="color:#61AFEF;">CoInitialize</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        graph </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">FilterGraph</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        devices </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> graph.</span><span style="color:#61AFEF;">get_input_devices</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        comtypes.</span><span style="color:#61AFEF;">CoUninitialize</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">res</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;font-style:italic;">success</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;font-style:italic;">data</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">[</span></span>
<span class="line"><span style="color:#ABB2BF;">                {</span><span style="color:#98C379;">&quot;index&quot;</span><span style="color:#ABB2BF;">: idx, </span><span style="color:#98C379;">&quot;label&quot;</span><span style="color:#ABB2BF;">: name}</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> idx, name </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">enumerate</span><span style="color:#ABB2BF;">(devices)</span></span>
<span class="line"><span style="color:#ABB2BF;">            ],</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;font-style:italic;">message</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;摄像头列表获取成功&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        )</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">res</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;font-style:italic;">success</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">False</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;font-style:italic;">message</span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;获取摄像头失败: </span><span style="color:#D19A66;">{</span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">(e)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;font-style:italic;">custom_code</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">500</span></span>
<span class="line"><span style="color:#ABB2BF;">        )</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># 初始化全局摄像头管理器</span></span>
<span class="line"><span style="color:#ABB2BF;">camera_manager </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">CameraManager</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">gen_frames</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">camera_index</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">) -&gt; Generator[</span><span style="color:#56B6C2;">bytes</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;">]:</span></span>
<span class="line"><span style="color:#ABB2BF;">    cap </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">None</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        cap </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> camera_manager.</span><span style="color:#61AFEF;">get_camera</span><span style="color:#ABB2BF;">(camera_index)</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">while</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            success, frame </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> cap.</span><span style="color:#61AFEF;">read</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">not</span><span style="color:#ABB2BF;"> success:</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#C678DD;">break</span></span>
<span class="line"><span style="color:#ABB2BF;">            ret, buffer </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> cv2.</span><span style="color:#61AFEF;">imencode</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;.jpg&#39;</span><span style="color:#ABB2BF;">, frame)</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">not</span><span style="color:#ABB2BF;"> ret:</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#C678DD;">continue</span></span>
<span class="line"><span style="color:#ABB2BF;">            frame_bytes </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> buffer.</span><span style="color:#61AFEF;">tobytes</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#C678DD;">yield</span><span style="color:#ABB2BF;"> (</span><span style="color:#C678DD;">b</span><span style="color:#98C379;">&#39;--frame</span><span style="color:#56B6C2;">\\r\\n</span><span style="color:#98C379;">&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">                   </span><span style="color:#C678DD;">b</span><span style="color:#98C379;">&#39;Content-Type: image/jpeg</span><span style="color:#56B6C2;">\\r\\n\\r\\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> frame_bytes </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">b</span><span style="color:#98C379;">&#39;</span><span style="color:#56B6C2;">\\r\\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">finally</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> cap </span><span style="color:#C678DD;">is</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">not</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            camera_manager.</span><span style="color:#61AFEF;">release</span><span style="color:#ABB2BF;">(camera_index)  </span><span style="color:#7F848E;font-style:italic;"># 使用正确的方法名</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">handle_stream</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">index</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        camera_index </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">(index)</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">Response</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#61AFEF;">gen_frames</span><span style="color:#ABB2BF;">(camera_index),</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;font-style:italic;">mimetype</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;multipart/x-mixed-replace; boundary=frame&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">        )</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> flask </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> jsonify</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">jsonify</span><span style="color:#ABB2BF;">({</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#98C379;">&quot;success&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">False</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#98C379;">&quot;message&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;视频流启动失败: </span><span style="color:#D19A66;">{</span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">(e)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#98C379;">&quot;code&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">500</span></span>
<span class="line"><span style="color:#ABB2BF;">        })</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),ql={id:"_10、水质数据-waterdata-py",tabindex:"-1"},_l=s("a",{class:"header-anchor",href:"#_10、水质数据-waterdata-py","aria-hidden":"true"},"#",-1),xl={href:"http://waterData.py",target:"_blank",rel:"noopener noreferrer"},wl=p(`<div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;"># 水质检测</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> requests</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> utils.configUtils </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> config</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> utils.respUtils </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> res</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> time</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> datetime</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># === 读取配置 ===</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># WATER配置</span></span>
<span class="line"><span style="color:#D19A66;">DEVICE_ID</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> config[</span><span style="color:#98C379;">&#39;WATER&#39;</span><span style="color:#ABB2BF;">][</span><span style="color:#98C379;">&#39;device_id&#39;</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">strip</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#D19A66;">DEVICE_TOKEN</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> config[</span><span style="color:#98C379;">&#39;WATER&#39;</span><span style="color:#ABB2BF;">][</span><span style="color:#98C379;">&#39;token&#39;</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">strip</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># OXY配置</span></span>
<span class="line"><span style="color:#D19A66;">BASE_URL</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> config[</span><span style="color:#98C379;">&#39;OXY&#39;</span><span style="color:#ABB2BF;">][</span><span style="color:#98C379;">&#39;base_url&#39;</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">strip</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#D19A66;">DEFAULT_SERIAL_NO</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> config[</span><span style="color:#98C379;">&#39;OXY&#39;</span><span style="color:#ABB2BF;">][</span><span style="color:#98C379;">&#39;serial_no&#39;</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">strip</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#D19A66;">DEFAULT_DEVICE_NO</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> config[</span><span style="color:#98C379;">&#39;OXY&#39;</span><span style="color:#ABB2BF;">][</span><span style="color:#98C379;">&#39;device_no&#39;</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">strip</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># 溶解氧传感器信息</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">get_device_info</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        response </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> requests.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">{BASE_URL}</span><span style="color:#98C379;">/deviceData&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;font-style:italic;">params</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">{</span><span style="color:#98C379;">&#39;serialNo&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">DEFAULT_SERIAL_NO</span><span style="color:#ABB2BF;">},</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;font-style:italic;">timeout</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">5</span></span>
<span class="line"><span style="color:#ABB2BF;">        )</span></span>
<span class="line"><span style="color:#ABB2BF;">        response.</span><span style="color:#61AFEF;">raise_for_status</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">res</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">success</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">data</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">(), </span><span style="color:#E06C75;font-style:italic;">message</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;设备信息获取成功&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">except</span><span style="color:#ABB2BF;"> requests.exceptions.RequestException </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">res</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">success</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">False</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">message</span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;设备信息获取失败: </span><span style="color:#D19A66;">{</span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">(e)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">custom_code</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">500</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># 溶解氧传感器采集的历史信息</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">get_history_data</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        response </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> requests.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">{BASE_URL}</span><span style="color:#98C379;">/historyData&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;font-style:italic;">params</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#98C379;">&#39;serialNo&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">DEFAULT_SERIAL_NO</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#98C379;">&#39;deviceNo&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">DEFAULT_DEVICE_NO</span></span>
<span class="line"><span style="color:#ABB2BF;">            },</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;font-style:italic;">timeout</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">5</span></span>
<span class="line"><span style="color:#ABB2BF;">        )</span></span>
<span class="line"><span style="color:#ABB2BF;">        response.</span><span style="color:#61AFEF;">raise_for_status</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;"># 获取所有数据，并取最后 20 条</span></span>
<span class="line"><span style="color:#ABB2BF;">        all_data </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        last_20_data </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> all_data[</span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">20</span><span style="color:#ABB2BF;">:] </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">isinstance</span><span style="color:#ABB2BF;">(all_data, </span><span style="color:#56B6C2;">list</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> []</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">res</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">success</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">data</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">last_20_data, </span><span style="color:#E06C75;font-style:italic;">message</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;历史数据获取成功&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">except</span><span style="color:#ABB2BF;"> requests.exceptions.RequestException </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">res</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">success</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">False</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">message</span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;历史数据获取失败: </span><span style="color:#D19A66;">{</span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">(e)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">custom_code</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">500</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># 溶解氧传感器采集的当前信息</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">get_real_time_data</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        response </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> requests.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">{BASE_URL}</span><span style="color:#98C379;">/realTimeData&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;font-style:italic;">params</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#98C379;">&#39;serialNo&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">DEFAULT_SERIAL_NO</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#98C379;">&#39;deviceNo&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">DEFAULT_DEVICE_NO</span></span>
<span class="line"><span style="color:#ABB2BF;">            },</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;font-style:italic;">timeout</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">5</span></span>
<span class="line"><span style="color:#ABB2BF;">        )</span></span>
<span class="line"><span style="color:#ABB2BF;">        response.</span><span style="color:#61AFEF;">raise_for_status</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">res</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">success</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">data</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">(), </span><span style="color:#E06C75;font-style:italic;">message</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;实时数据获取成功&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">except</span><span style="color:#ABB2BF;"> requests.exceptions.RequestException </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">res</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">success</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">False</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">message</span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;实时数据获取失败: </span><span style="color:#D19A66;">{</span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">(e)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">custom_code</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">500</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># stem32传感器PH、温度、浊度</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">query_device_data</span><span style="color:#ABB2BF;">() -&gt; </span><span style="color:#56B6C2;">dict</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">    url </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;https://www.wztdzmcu.com/renren-admin/api/device/queryAllByProductIdAndDeviceId&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    params </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#98C379;">&quot;deviceId&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">DEVICE_ID</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#98C379;">&quot;_t&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">(time.</span><span style="color:#61AFEF;">time</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">*</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">1000</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">    headers </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#98C379;">&quot;User-Agent&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#98C379;">&quot;Referer&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;https://www.wztdzmcu.com/&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#98C379;">&quot;Origin&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;https://www.wztdzmcu.com&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#98C379;">&quot;token&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">DEVICE_TOKEN</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        response </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> requests.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(url, </span><span style="color:#E06C75;font-style:italic;">headers</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">headers, </span><span style="color:#E06C75;font-style:italic;">params</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">params, </span><span style="color:#E06C75;font-style:italic;">timeout</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">10</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        response.</span><span style="color:#61AFEF;">raise_for_status</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        response_data </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        status </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">  </span><span style="color:#7F848E;font-style:italic;"># 默认状态</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> response_data.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;code&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">==</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">and</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&#39;data&#39;</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> response_data:</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;"># 设备状态检查</span></span>
<span class="line"><span style="color:#ABB2BF;">            last_item </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> response_data[</span><span style="color:#98C379;">&#39;data&#39;</span><span style="color:#ABB2BF;">][</span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&#39;createTime&#39;</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> last_item:</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#C678DD;">try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                    current_timestamp </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">(time.</span><span style="color:#61AFEF;">time</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">*</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">1000</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># 当前时间戳（毫秒）</span></span>
<span class="line"><span style="color:#ABB2BF;">                    last_timestamp </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">(last_item[</span><span style="color:#98C379;">&#39;createTime&#39;</span><span style="color:#ABB2BF;">])  </span><span style="color:#7F848E;font-style:italic;"># 数据时间戳</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> current_timestamp </span><span style="color:#56B6C2;">-</span><span style="color:#ABB2BF;"> last_timestamp </span><span style="color:#56B6C2;">&lt;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">5000</span><span style="color:#ABB2BF;">:  </span><span style="color:#7F848E;font-style:italic;"># 如果数据时间比当前时间晚5秒以内（5000毫秒）</span></span>
<span class="line"><span style="color:#ABB2BF;">                        status </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">1</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#C678DD;">except</span><span style="color:#ABB2BF;"> (ValueError, TypeError):</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#C678DD;">pass</span><span style="color:#ABB2BF;">  </span><span style="color:#7F848E;font-style:italic;"># 时间戳转换失败保持status=0</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;"># 设备状态检查</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#C678DD;">for</span><span style="color:#ABB2BF;"> item </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> response_data[</span><span style="color:#98C379;">&#39;data&#39;</span><span style="color:#ABB2BF;">]:</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&#39;createTime&#39;</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> item:</span></span>
<span class="line"><span style="color:#ABB2BF;">                    item[</span><span style="color:#98C379;">&#39;createTime&#39;</span><span style="color:#ABB2BF;">] </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> datetime.datetime.</span><span style="color:#61AFEF;">fromtimestamp</span><span style="color:#ABB2BF;">(</span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">(item[</span><span style="color:#98C379;">&#39;createTime&#39;</span><span style="color:#ABB2BF;">]) </span><span style="color:#56B6C2;">/</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">1000</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">strftime</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                        </span><span style="color:#98C379;">&quot;%Y-%m-</span><span style="color:#D19A66;">%d</span><span style="color:#98C379;"> %H:%M:%S&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;"># 构建标准响应</span></span>
<span class="line"><span style="color:#ABB2BF;">        modelData </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#98C379;">&#39;status&#39;</span><span style="color:#ABB2BF;">: status,  </span><span style="color:#7F848E;font-style:italic;"># 0=离线/滞后，1=在线</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#98C379;">&#39;list&#39;</span><span style="color:#ABB2BF;">: response_data[</span><span style="color:#98C379;">&#39;data&#39;</span><span style="color:#ABB2BF;">]  </span><span style="color:#7F848E;font-style:italic;"># 设备数据列表</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">res</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">success</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">data</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">modelData, </span><span style="color:#E06C75;font-style:italic;">message</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;设备数据获取成功&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">except</span><span style="color:#ABB2BF;"> requests.exceptions.RequestException </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">res</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">success</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">False</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">message</span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;设备数据获取失败: </span><span style="color:#D19A66;">{</span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">(e)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">custom_code</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">500</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),Sl={id:"_11、发送指令-execute-py",tabindex:"-1"},kl=s("a",{class:"header-anchor",href:"#_11、发送指令-execute-py","aria-hidden":"true"},"#",-1),Pl={href:"http://execute.py",target:"_blank",rel:"noopener noreferrer"},Il=p(`<div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> requests</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> typing </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> Any, Dict</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> utils.configUtils </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> config</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> utils.respUtils </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> res</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">class</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">DeviceController</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">def</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">__init__</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;"># 直接使用全局配置</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.base_url </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;http://</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">config[</span><span style="color:#98C379;">&#39;ESP8266&#39;</span><span style="color:#ABB2BF;">][</span><span style="color:#98C379;">&#39;host&#39;</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">strip</span><span style="color:#ABB2BF;">()</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">/control&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">def</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">control_by_pin</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">pin</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">state</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">) -&gt; Dict[</span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">, Any]:</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;"># 参数验证</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">not</span><span style="color:#ABB2BF;"> pin </span><span style="color:#C678DD;">or</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">not</span><span style="color:#ABB2BF;"> state:</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">res</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#E06C75;font-style:italic;">success</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">False</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#E06C75;font-style:italic;">custom_code</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">400</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#E06C75;font-style:italic;">message</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;参数pin和state不能为空&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">            )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;"># 状态参数转换</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            state_bool </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">_parse_state</span><span style="color:#ABB2BF;">(state)</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">except</span><span style="color:#ABB2BF;"> ValueError </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">res</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#E06C75;font-style:italic;">success</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">False</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#E06C75;font-style:italic;">custom_code</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">400</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#E06C75;font-style:italic;">message</span><span style="color:#56B6C2;">=str</span><span style="color:#ABB2BF;">(e)</span></span>
<span class="line"><span style="color:#ABB2BF;">            )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;"># 发送控制请求</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            params </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span><span style="color:#98C379;">&quot;pin&quot;</span><span style="color:#ABB2BF;">: pin, </span><span style="color:#98C379;">&quot;state&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> state_bool </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#ABB2BF;">            response </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> requests.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.base_url, </span><span style="color:#E06C75;font-style:italic;">params</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">params, </span><span style="color:#E06C75;font-style:italic;">timeout</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">            response.</span><span style="color:#61AFEF;">raise_for_status</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">            device_resp </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;"># 验证设备响应（但不返回给前端）</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">not</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">self</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">_validate_device_response</span><span style="color:#ABB2BF;">(device_resp, pin, state_bool):</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">res</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#E06C75;font-style:italic;">success</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">False</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#E06C75;font-style:italic;">custom_code</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">502</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#E06C75;font-style:italic;">message</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;设备返回无效响应&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">                )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;"># 优化后的返回数据，只包含pin和state</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">res</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#E06C75;font-style:italic;">success</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#E06C75;font-style:italic;">data</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#98C379;">&quot;pin&quot;</span><span style="color:#ABB2BF;">: pin,</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#98C379;">&quot;state&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> state_bool </span><span style="color:#C678DD;">is</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">False</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">  </span><span style="color:#7F848E;font-style:italic;"># 直接返回设备状态值</span></span>
<span class="line"><span style="color:#ABB2BF;">                },</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#E06C75;font-style:italic;">message</span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;引脚 </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">pin</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> 控制成功&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">            )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">except</span><span style="color:#ABB2BF;"> requests.exceptions.RequestException </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">res</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#E06C75;font-style:italic;">success</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">False</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#E06C75;font-style:italic;">custom_code</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">503</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#E06C75;font-style:italic;">message</span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;设备通信失败: </span><span style="color:#D19A66;">{</span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">(e)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">            )</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">except</span><span style="color:#ABB2BF;"> ValueError </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">res</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#E06C75;font-style:italic;">success</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">False</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#E06C75;font-style:italic;">custom_code</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">500</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#E06C75;font-style:italic;">message</span><span style="color:#56B6C2;">=</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;响应解析失败: </span><span style="color:#D19A66;">{</span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">(e)</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">            )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">def</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">_parse_state</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">state</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">) -&gt; </span><span style="color:#56B6C2;">bool</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#98C379;">&quot;&quot;&quot;解析状态字符串&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        state </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">(state).</span><span style="color:#61AFEF;">lower</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">strip</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> state </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> (</span><span style="color:#98C379;">&#39;1&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;true&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;on&#39;</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">True</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">elif</span><span style="color:#ABB2BF;"> state </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> (</span><span style="color:#98C379;">&#39;0&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;false&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;off&#39;</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">False</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">raise</span><span style="color:#ABB2BF;"> ValueError(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;无效的state参数: </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">state</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> (请使用1/0, true/false或on/off)&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">def</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">_validate_device_response</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;font-style:italic;">self</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">response</span><span style="color:#ABB2BF;">: Dict, </span><span style="color:#D19A66;font-style:italic;">pin</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">target_state</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">bool</span><span style="color:#ABB2BF;">) -&gt; </span><span style="color:#56B6C2;">bool</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#98C379;">&quot;&quot;&quot;验证设备返回的响应是否有效（内部使用）&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> (</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#56B6C2;">isinstance</span><span style="color:#ABB2BF;">(response, </span><span style="color:#56B6C2;">dict</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">and</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">(response.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;pin&quot;</span><span style="color:#ABB2BF;">)) </span><span style="color:#56B6C2;">==</span><span style="color:#ABB2BF;"> pin </span><span style="color:#C678DD;">and</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#56B6C2;">int</span><span style="color:#ABB2BF;">(response.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;state&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#56B6C2;">-</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">)) </span><span style="color:#56B6C2;">==</span><span style="color:#ABB2BF;"> (</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> target_state </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        )</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="程序运行" tabindex="-1"><a class="header-anchor" href="#程序运行" aria-hidden="true">#</a> 程序运行</h3><p>通过备注的信息，完善配置信息</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># 土壤传感器配置 port通过“电脑”&gt;“管理”&gt;“设备管理”&gt;“端口”</span></span>
<span class="line"><span style="color:#E06C75;">SOIL</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E06C75;">port</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;COM5&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># 水质传感器 token获取登录“https://www.wztdzmcu.com”；账号密码：“8252560513680”</span></span>
<span class="line"><span style="color:#E06C75;">WATER</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E06C75;">token</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;5a0ee803df301693dde1d305d24fd313&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># ESP8266主板 联网后通过网络设备查</span></span>
<span class="line"><span style="color:#E06C75;">ESP8266</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E06C75;">host</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;192.168.43.212&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># 摄像头设备列表 联网后通过网络设备查</span></span>
<span class="line"><span style="color:#E06C75;">cameras</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">  - </span><span style="color:#E06C75;">id</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">1</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;北区稻田&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">ip</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;192.168.43.120&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">  - </span><span style="color:#E06C75;">id</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">2</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;南区稻田&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">ip</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;192.168.43.154&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">  - </span><span style="color:#E06C75;">id</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">3</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;吊笼检测&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">ip</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;192.168.43.237&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">  - </span><span style="color:#E06C75;">id</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">4</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;巡航船&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">ip</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;192.168.43.85&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>选择Python解释器</p><img src="`+Zs+'" width="800">',6),Tl={href:"http://xn--main-4g1g2865a.py",target:"_blank",rel:"noopener noreferrer"},Ll=s("img",{src:Qs,width:"800"},null,-1),Rl=s("p",null,"启动成功",-1),Nl=s("img",{src:sn,width:"800"},null,-1),Ol={href:"http://127.0.0.1:5000",target:"_blank",rel:"noopener noreferrer"},Ml=p('<p>例如：</p><img src="'+nn+`" width="800"><h3 id="接口文档" tabindex="-1"><a class="header-anchor" href="#接口文档" aria-hidden="true">#</a> 接口文档</h3><h4 id="_1、土壤数据" tabindex="-1"><a class="header-anchor" href="#_1、土壤数据" aria-hidden="true">#</a> 1、土壤数据</h4><p><code>GET</code> <code>/api/soilData</code></p><div class="language-json line-numbers-mode" data-ext="json"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">&quot;code&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">200</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">&quot;data&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">&quot;sensor_data&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;conductivity&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">,  </span><span style="color:#FFFFFF;">#</span><span style="color:#ABB2BF;"> </span><span style="color:#FFFFFF;">电导率</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;humidity&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">,      </span><span style="color:#FFFFFF;">#</span><span style="color:#ABB2BF;"> </span><span style="color:#FFFFFF;">湿度</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;nitrogen&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">,      </span><span style="color:#FFFFFF;">#</span><span style="color:#ABB2BF;"> </span><span style="color:#FFFFFF;">氮</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;ph&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">70</span><span style="color:#ABB2BF;">,			</span><span style="color:#FFFFFF;">#</span><span style="color:#ABB2BF;"> </span><span style="color:#FFFFFF;">PH值</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;phosphorus&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">,    </span><span style="color:#FFFFFF;">#</span><span style="color:#ABB2BF;"> </span><span style="color:#FFFFFF;">磷</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;potassium&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, 	</span><span style="color:#FFFFFF;">#</span><span style="color:#ABB2BF;"> </span><span style="color:#FFFFFF;">钾</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;temperature&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">26.6</span><span style="color:#ABB2BF;"> </span><span style="color:#FFFFFF;">#</span><span style="color:#ABB2BF;"> </span><span style="color:#FFFFFF;">温度</span></span>
<span class="line"><span style="color:#ABB2BF;">        },</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">&quot;status&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">1</span></span>
<span class="line"><span style="color:#ABB2BF;">    },</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">&quot;message&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;请求成功&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">&quot;timestamp&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;2025-06-13 17:41:50&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2、溶解氧设备信息" tabindex="-1"><a class="header-anchor" href="#_2、溶解氧设备信息" aria-hidden="true">#</a> 2、溶解氧设备信息</h4><p><code>GET</code> <code>/api/waterOxyInfo</code></p><div class="language-json line-numbers-mode" data-ext="json"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">&quot;code&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">200</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">&quot;data&quot;</span><span style="color:#ABB2BF;">: [</span></span>
<span class="line"><span style="color:#ABB2BF;">        {</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;address&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;安徽省芜湖市弋江区香樟东路&quot;</span><span style="color:#ABB2BF;">,  </span><span style="color:#FFFFFF;">#</span><span style="color:#ABB2BF;"> </span><span style="color:#FFFFFF;">设备位置</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;createTime&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;2025-06-06 22:02:10&quot;</span><span style="color:#ABB2BF;">, </span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;deviceNo&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;862538064340611&quot;</span><span style="color:#ABB2BF;">,		 </span><span style="color:#FFFFFF;">#</span><span style="color:#ABB2BF;"> </span><span style="color:#FFFFFF;">设备编码</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;id&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">37</span><span style="color:#ABB2BF;">,							 </span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;isDeleted&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">,      				 </span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;latitude&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">31.285111</span><span style="color:#ABB2BF;">,				 </span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;longitude&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">118.376905</span><span style="color:#ABB2BF;">,			 </span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;水质溶解氧传感器&quot;</span><span style="color:#ABB2BF;">,				</span><span style="color:#FFFFFF;">#</span><span style="color:#ABB2BF;"> </span><span style="color:#FFFFFF;">设备名称</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;status&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">,						 </span><span style="color:#FFFFFF;">#</span><span style="color:#ABB2BF;"> </span><span style="color:#FFFFFF;">溶解氧传感器设备状态</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;templateId&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">6</span><span style="color:#ABB2BF;">,					</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;updateTime&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;2025-06-10 13:34:54&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;userId&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">11</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">    ],</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">&quot;message&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;请求成功&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">&quot;timestamp&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;2025-06-13 17:52:48&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3、溶解氧历史数据" tabindex="-1"><a class="header-anchor" href="#_3、溶解氧历史数据" aria-hidden="true">#</a> 3、溶解氧历史数据</h4><p><code>GET</code> <code>/api/waterOxyHistory</code></p><div class="language-json line-numbers-mode" data-ext="json"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">&quot;code&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">200</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">&quot;data&quot;</span><span style="color:#ABB2BF;">: [</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#FFFFFF;">......</span></span>
<span class="line"><span style="color:#ABB2BF;">        {</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;address&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;安徽省芜湖市弋江区香樟东路&quot;</span><span style="color:#ABB2BF;">,  </span><span style="color:#FFFFFF;">#</span><span style="color:#ABB2BF;"> </span><span style="color:#FFFFFF;">设备位置</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;createTime&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;2025-06-13 17:46:34&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#FFFFFF;">#</span><span style="color:#ABB2BF;"> </span><span style="color:#FFFFFF;">数据创建时间</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;deviceNo&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;862538064340611&quot;</span><span style="color:#ABB2BF;">,		 </span><span style="color:#FFFFFF;">#</span><span style="color:#ABB2BF;"> </span><span style="color:#FFFFFF;">设备编码</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;isAlarm&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">,						 </span><span style="color:#FFFFFF;">#</span><span style="color:#ABB2BF;"> </span><span style="color:#FFFFFF;">是否报警</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;水质溶解氧传感器&quot;</span><span style="color:#ABB2BF;">,				</span><span style="color:#FFFFFF;">#</span><span style="color:#ABB2BF;"> </span><span style="color:#FFFFFF;">设备名称</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;unit&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;水质溶解氧mg/L&quot;</span><span style="color:#ABB2BF;">,			  </span><span style="color:#FFFFFF;">#</span><span style="color:#ABB2BF;"> </span><span style="color:#FFFFFF;">数据单位</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;value&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;0.12&quot;</span><span style="color:#ABB2BF;">						 </span><span style="color:#FFFFFF;">#</span><span style="color:#ABB2BF;"> </span><span style="color:#FFFFFF;">值</span></span>
<span class="line"><span style="color:#ABB2BF;">        },</span></span>
<span class="line"><span style="color:#ABB2BF;">        {</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;address&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;安徽省芜湖市弋江区香樟东路&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;createTime&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;2025-06-13 17:47:34&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;deviceNo&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;862538064340611&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;isAlarm&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;水质溶解氧传感器&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;unit&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;水质溶解氧mg/L&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;value&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;0.12&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">    ],</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">&quot;message&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;请求成功&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">&quot;timestamp&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;2025-06-13 17:47:54&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_4、溶解氧实时数据" tabindex="-1"><a class="header-anchor" href="#_4、溶解氧实时数据" aria-hidden="true">#</a> 4、溶解氧实时数据</h4><p><code>GET</code> <code>/api/waterOxyNow</code></p><div class="language-json line-numbers-mode" data-ext="json"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">&quot;code&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">200</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">&quot;data&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">&quot;appId&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">&quot;createTime&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;2025-06-13 17:56:37&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">&quot;data&quot;</span><span style="color:#ABB2BF;">: [</span></span>
<span class="line"><span style="color:#ABB2BF;">            {</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#E06C75;">&quot;deviceType&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;水质溶解氧&quot;</span><span style="color:#ABB2BF;">,  </span><span style="color:#FFFFFF;">#</span><span style="color:#ABB2BF;"> </span><span style="color:#FFFFFF;">参数名称</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#E06C75;">&quot;value&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;0.12&quot;</span><span style="color:#ABB2BF;">			   </span><span style="color:#FFFFFF;">#</span><span style="color:#ABB2BF;"> </span><span style="color:#FFFFFF;">查询值</span></span>
<span class="line"><span style="color:#ABB2BF;">            }</span></span>
<span class="line"><span style="color:#ABB2BF;">        ],</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">&quot;deviceNo&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;862538064340611&quot;</span><span style="color:#ABB2BF;">	   </span><span style="color:#FFFFFF;">#</span><span style="color:#ABB2BF;"> </span><span style="color:#FFFFFF;">设备编码</span></span>
<span class="line"><span style="color:#ABB2BF;">    },</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">&quot;message&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;请求成功&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">&quot;timestamp&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;2025-06-13 17:56:38&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_5、水质数据" tabindex="-1"><a class="header-anchor" href="#_5、水质数据" aria-hidden="true">#</a> 5、水质数据</h4><p><code>GET</code> <code>/api/waterData</code></p><div class="language-json line-numbers-mode" data-ext="json"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">&quot;code&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">200</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">&quot;data&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">&quot;list&quot;</span><span style="color:#ABB2BF;">: [</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#FFFFFF;">......</span></span>
<span class="line"><span style="color:#ABB2BF;">            {</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#E06C75;">&quot;createTime&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;2025-06-13 18:00:43&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#E06C75;">&quot;dataMap&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#E06C75;">&quot;ph&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">5.05</span><span style="color:#ABB2BF;">, </span><span style="color:#FFFFFF;">#</span><span style="color:#ABB2BF;"> </span><span style="color:#FFFFFF;">水PH值</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#E06C75;">&quot;temp&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">25</span><span style="color:#ABB2BF;">, </span><span style="color:#FFFFFF;">#</span><span style="color:#ABB2BF;"> </span><span style="color:#FFFFFF;">水温度</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#E06C75;">&quot;tur&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">    </span><span style="color:#FFFFFF;">#</span><span style="color:#ABB2BF;"> </span><span style="color:#FFFFFF;">水浊度</span></span>
<span class="line"><span style="color:#ABB2BF;">                },</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#E06C75;">&quot;deviceId&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;8252560513680&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#FFFFFF;">#</span><span style="color:#ABB2BF;"> </span><span style="color:#FFFFFF;">设备编号</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#E06C75;">&quot;productId&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">null</span></span>
<span class="line"><span style="color:#ABB2BF;">            },</span></span>
<span class="line"><span style="color:#ABB2BF;">            {</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#E06C75;">&quot;createTime&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;2025-06-13 18:00:46&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#E06C75;">&quot;dataMap&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#E06C75;">&quot;ph&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">5.04</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#E06C75;">&quot;temp&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">25</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#E06C75;">&quot;tur&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">0</span></span>
<span class="line"><span style="color:#ABB2BF;">                },</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#E06C75;">&quot;deviceId&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;8252560513680&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#E06C75;">&quot;productId&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">null</span></span>
<span class="line"><span style="color:#ABB2BF;">            }</span></span>
<span class="line"><span style="color:#ABB2BF;">        ],</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">&quot;status&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">  </span><span style="color:#FFFFFF;">#</span><span style="color:#ABB2BF;"> </span><span style="color:#FFFFFF;">设备状态</span></span>
<span class="line"><span style="color:#ABB2BF;">    },</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">&quot;message&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;请求成功&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">&quot;timestamp&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;2025-06-13 18:00:47&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_6、环境数据" tabindex="-1"><a class="header-anchor" href="#_6、环境数据" aria-hidden="true">#</a> 6、环境数据</h4><p><code>GET</code> <code>/api/envData</code></p><div class="language-json line-numbers-mode" data-ext="json"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">&quot;code&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">200</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">&quot;data&quot;</span><span style="color:#ABB2BF;">: {</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">&quot;direction&quot;</span><span style="color:#ABB2BF;">: {				</span><span style="color:#FFFFFF;">#</span><span style="color:#ABB2BF;"> </span><span style="color:#FFFFFF;">风向</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;status&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;value&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;西北&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        },</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">&quot;humidity&quot;</span><span style="color:#ABB2BF;">: {				</span><span style="color:#FFFFFF;">#</span><span style="color:#ABB2BF;"> </span><span style="color:#FFFFFF;">环境湿度</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;status&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;value&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">37</span></span>
<span class="line"><span style="color:#ABB2BF;">        },</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">&quot;light&quot;</span><span style="color:#ABB2BF;">: {					</span><span style="color:#FFFFFF;">#</span><span style="color:#ABB2BF;"> </span><span style="color:#FFFFFF;">光照强度</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;status&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;value&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">450</span></span>
<span class="line"><span style="color:#ABB2BF;">        },</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">&quot;speed&quot;</span><span style="color:#ABB2BF;">: {					</span><span style="color:#FFFFFF;">#</span><span style="color:#ABB2BF;"> </span><span style="color:#FFFFFF;">风速</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;status&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;value&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;3.2-5.7m/s&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        },</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">&quot;temp&quot;</span><span style="color:#ABB2BF;">: {					</span><span style="color:#FFFFFF;">#</span><span style="color:#ABB2BF;"> </span><span style="color:#FFFFFF;">环境温度</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;status&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;value&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">29</span></span>
<span class="line"><span style="color:#ABB2BF;">        },</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#E06C75;">&quot;water&quot;</span><span style="color:#ABB2BF;">: {					</span><span style="color:#FFFFFF;">#</span><span style="color:#ABB2BF;"> </span><span style="color:#FFFFFF;">水深</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;status&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;value&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">,				</span><span style="color:#FFFFFF;">#</span><span style="color:#ABB2BF;"> </span><span style="color:#FFFFFF;">百分比</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;deep&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">7</span><span style="color:#ABB2BF;">				</span><span style="color:#FFFFFF;">#</span><span style="color:#ABB2BF;"> </span><span style="color:#FFFFFF;">传感器值</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">    },</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">&quot;message&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;请求成功&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">&quot;timestamp&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;2025-06-13 19:02:48&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_7、esp32-cam地址" tabindex="-1"><a class="header-anchor" href="#_7、esp32-cam地址" aria-hidden="true">#</a> 7、ESP32-CAM地址</h4><p><code>GET</code> <code>/api/videoUrl</code></p><div class="language-json line-numbers-mode" data-ext="json"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">&quot;code&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">200</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">&quot;data&quot;</span><span style="color:#ABB2BF;">: [</span></span>
<span class="line"><span style="color:#ABB2BF;">        {</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;id&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;ip&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;192.168.137.252&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;北区稻田&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        },</span></span>
<span class="line"><span style="color:#ABB2BF;">        {</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;id&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;ip&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;192.168.137.95&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;南区稻田&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        },</span></span>
<span class="line"><span style="color:#ABB2BF;">        {</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;id&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;ip&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;192.168.137.229&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;蟹池&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        },</span></span>
<span class="line"><span style="color:#ABB2BF;">        {</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;id&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">4</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;ip&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;192.168.137.14&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;name&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;巡航船&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">    ],</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">&quot;message&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;请求成功&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">&quot;timestamp&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;2025-06-27 16:16:16&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,24),jl={href:"http://$",ip:"",target:"_blank",rel:"noopener noreferrer"},Ul=p(`<h4 id="_8、本地摄像头视频流" tabindex="-1"><a class="header-anchor" href="#_8、本地摄像头视频流" aria-hidden="true">#</a> 8、本地摄像头视频流</h4><p>获取视频索引列表</p><p><code>GET</code> <code>/api/cameraList</code></p><div class="language-json line-numbers-mode" data-ext="json"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">&quot;code&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">200</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">&quot;data&quot;</span><span style="color:#ABB2BF;">: [</span></span>
<span class="line"><span style="color:#ABB2BF;">        {</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;index&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;label&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;Integrated Camera&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        },</span></span>
<span class="line"><span style="color:#ABB2BF;">        {</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;index&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">&quot;label&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;Integrated Video&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">        }</span></span>
<span class="line"><span style="color:#ABB2BF;">    ],</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">&quot;message&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;请求成功&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">&quot;timestamp&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;2025-06-27 16:22:49&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>通过索引查看视频</p><p><code>GET</code> <code>/api/stream</code></p><table><thead><tr><th>参数名</th><th>类型</th><th>示例值</th><th>说明</th></tr></thead><tbody><tr><td>index</td><td>int</td><td>0</td><td>接口/api/cameraList中data索引为0的视频流</td></tr></tbody></table><h4 id="_9、指令接口" tabindex="-1"><a class="header-anchor" href="#_9、指令接口" aria-hidden="true">#</a> 9、指令接口</h4><p><code>GET</code> <code>/api/execute</code></p><table><thead><tr><th>参数名</th><th>类型</th><th>示例值</th><th>说明</th></tr></thead><tbody><tr><td>pin</td><td>string</td><td>V3</td><td>控制器对应的信号引脚</td></tr><tr><td>state</td><td>int</td><td>1</td><td>状态1：开启；0：关闭</td></tr></tbody></table><p>有效值</p><table><thead><tr><th>pin</th><th>state</th><th>说明（暂定）</th></tr></thead><tbody><tr><td>V3</td><td>1</td><td>东区-增氧-打开</td></tr><tr><td>V3</td><td>0</td><td>东区-增氧-关闭</td></tr><tr><td>V4</td><td>1</td><td>西区-增氧-打开</td></tr><tr><td>V4</td><td>0</td><td>西区-增氧-关闭</td></tr><tr><td>V5</td><td>1</td><td>东区-除虫-打开</td></tr><tr><td>V5</td><td>0</td><td>东区-除虫-关闭</td></tr><tr><td>V6</td><td>1</td><td>西区-除虫-打开</td></tr><tr><td>V6</td><td>0</td><td>西区-除虫-关闭</td></tr><tr><td>V7</td><td>1</td><td>东区-抽水-打开</td></tr><tr><td>V7</td><td>0</td><td>东区-抽水-关闭</td></tr><tr><td>V8</td><td>1</td><td>西区-抽水-打开</td></tr><tr><td>V8</td><td>0</td><td>西区-抽水-关闭</td></tr></tbody></table><h2 id="五、web开发" tabindex="-1"><a class="header-anchor" href="#五、web开发" aria-hidden="true">#</a> 五、Web开发</h2><h3 id="环境搭建-1" tabindex="-1"><a class="header-anchor" href="#环境搭建-1" aria-hidden="true">#</a> 环境搭建</h3><h4 id="_1、开发工具-1" tabindex="-1"><a class="header-anchor" href="#_1、开发工具-1" aria-hidden="true">#</a> 1、开发工具</h4><ul><li>VSCode</li><li>html+js+css</li><li>IDEA插件- Live Server</li></ul><h4 id="_2、项目结构-1" tabindex="-1"><a class="header-anchor" href="#_2、项目结构-1" aria-hidden="true">#</a> 2、项目结构</h4><img src="`+an+`" width="600"><h3 id="网页开发" tabindex="-1"><a class="header-anchor" href="#网页开发" aria-hidden="true">#</a> 网页开发</h3><h4 id="_1、html-index-html" tabindex="-1"><a class="header-anchor" href="#_1、html-index-html" aria-hidden="true">#</a> 1、HTML | index.html</h4><div class="language-html line-numbers-mode" data-ext="html"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;">&lt;!</span><span style="color:#E06C75;">DOCTYPE</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">html</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">&lt;</span><span style="color:#E06C75;">html</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">lang</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;zh-CN&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">&lt;</span><span style="color:#E06C75;">head</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;</span><span style="color:#E06C75;">meta</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">charset</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;UTF-8&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;</span><span style="color:#E06C75;">meta</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">name</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;viewport&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">content</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;</span><span style="color:#E06C75;">title</span><span style="color:#ABB2BF;">&gt;智能农业监控系统&lt;/</span><span style="color:#E06C75;">title</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;</span><span style="color:#E06C75;">link</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">rel</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;stylesheet&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">href</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css&quot;</span><span style="color:#ABB2BF;"> /&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;</span><span style="color:#E06C75;">link</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">rel</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;stylesheet&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">href</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;style.css&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">&lt;/</span><span style="color:#E06C75;">head</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">&lt;</span><span style="color:#E06C75;">body</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;container&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">        &lt;</span><span style="color:#E06C75;">header</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">            &lt;</span><span style="color:#E06C75;">h1</span><span style="color:#ABB2BF;">&gt;&lt;</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;fas fa-seedling&quot;</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">&gt; 生态养殖中控平台&lt;/</span><span style="color:#E06C75;">h1</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">            &lt;</span><span style="color:#E06C75;">p</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;subtitle&quot;</span><span style="color:#ABB2BF;">&gt;监测农田环境、水质、土壤参数，科学管理稻虾蟹生态养殖。&lt;/</span><span style="color:#E06C75;">p</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">        &lt;/</span><span style="color:#E06C75;">header</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;dashboard&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;">&lt;!-- 参数面板 --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameters-panel&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                &lt;</span><span style="color:#E06C75;">h2</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;panel-title&quot;</span><span style="color:#ABB2BF;">&gt;&lt;</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;fas fa-leaf&quot;</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">&gt; 环境参数监测&lt;/</span><span style="color:#E06C75;">h2</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">                &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;section&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                    &lt;</span><span style="color:#E06C75;">h3</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;section-title&quot;</span><span style="color:#ABB2BF;">&gt;&lt;</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;fas fa-mountain&quot;</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">&gt; 土壤监测&lt;/</span><span style="color:#E06C75;">h3</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                    &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameters-grid&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                        &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-card&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-header&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-name&quot;</span><span style="color:#ABB2BF;">&gt;土壤电导率&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-icon&quot;</span><span style="color:#ABB2BF;">&gt;&lt;</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;fas fa-bolt&quot;</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-value&quot;</span><span style="color:#ABB2BF;">&gt;1.2 dS/m&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-status&quot;</span><span style="color:#ABB2BF;">&gt;正常范围: 0.8~1.5 dS/m&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                        &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">                        &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-card&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-header&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-name&quot;</span><span style="color:#ABB2BF;">&gt;土壤温度&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-icon&quot;</span><span style="color:#ABB2BF;">&gt;&lt;</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;fas fa-thermometer-half&quot;</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-value&quot;</span><span style="color:#ABB2BF;">&gt;24.5°C&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-status&quot;</span><span style="color:#ABB2BF;">&gt;适宜范围: 20~30°C&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                        &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">                        &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-card&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-header&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-name&quot;</span><span style="color:#ABB2BF;">&gt;土壤湿度&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-icon&quot;</span><span style="color:#ABB2BF;">&gt;&lt;</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;fas fa-tint&quot;</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-value&quot;</span><span style="color:#ABB2BF;">&gt;65%&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-status&quot;</span><span style="color:#ABB2BF;">&gt;适宜范围: 60~75%&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                        &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">                        &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-card&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-header&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-name&quot;</span><span style="color:#ABB2BF;">&gt;氮含量&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-icon&quot;</span><span style="color:#ABB2BF;">&gt;&lt;</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;fas fa-flask&quot;</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-value&quot;</span><span style="color:#ABB2BF;">&gt;84.9mg/kg&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-status&quot;</span><span style="color:#ABB2BF;">&gt;正常范围: 50~100mg/kg&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                        &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">                        &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-card&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-header&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-name&quot;</span><span style="color:#ABB2BF;">&gt;磷含量&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-icon&quot;</span><span style="color:#ABB2BF;">&gt;&lt;</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;fas fa-flask&quot;</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-value&quot;</span><span style="color:#ABB2BF;">&gt;18.6mg/kg&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-status&quot;</span><span style="color:#ABB2BF;">&gt;正常范围: 15~30mg/kg&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                        &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">                        &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-card&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-header&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-name&quot;</span><span style="color:#ABB2BF;">&gt;钾含量&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-icon&quot;</span><span style="color:#ABB2BF;">&gt;&lt;</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;fas fa-flask&quot;</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-value&quot;</span><span style="color:#ABB2BF;">&gt;136.2mg/kg&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-status&quot;</span><span style="color:#ABB2BF;">&gt;正常范围: 100~150mg/kg&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                        &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">                        &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-card&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-header&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-name&quot;</span><span style="color:#ABB2BF;">&gt;土壤PH值&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-icon&quot;</span><span style="color:#ABB2BF;">&gt;&lt;</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;fas fa-vial&quot;</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-value&quot;</span><span style="color:#ABB2BF;">&gt;6.7&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-status&quot;</span><span style="color:#ABB2BF;">&gt;适宜范围: 6.0~7.0&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                        &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                    &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">                &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;section&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                    &lt;</span><span style="color:#E06C75;">h3</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;section-title&quot;</span><span style="color:#ABB2BF;">&gt;&lt;</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;fas fa-water&quot;</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">&gt; 水质监测&lt;/</span><span style="color:#E06C75;">h3</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                    &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameters-grid&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                        &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-card&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-header&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-name&quot;</span><span style="color:#ABB2BF;">&gt;水PH值&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-icon&quot;</span><span style="color:#ABB2BF;">&gt;&lt;</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;fas fa-vial&quot;</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-value&quot;</span><span style="color:#ABB2BF;">&gt;7.6&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-status&quot;</span><span style="color:#ABB2BF;">&gt;适宜范围: 7.5~8.0&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                        &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">                        &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-card&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-header&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-name&quot;</span><span style="color:#ABB2BF;">&gt;水温&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-icon&quot;</span><span style="color:#ABB2BF;">&gt;&lt;</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;fas fa-thermometer-half&quot;</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-value&quot;</span><span style="color:#ABB2BF;">&gt;23.6°C&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-status&quot;</span><span style="color:#ABB2BF;">&gt;适宜范围: 22~26°C&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                        &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">                        &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-card&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-header&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-name&quot;</span><span style="color:#ABB2BF;">&gt;浊度&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-icon&quot;</span><span style="color:#ABB2BF;">&gt;&lt;</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;fas fa-vial&quot;</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-value&quot;</span><span style="color:#ABB2BF;">&gt;48NTU&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-status&quot;</span><span style="color:#ABB2BF;">&gt;正常范围: 30~50NTU&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                        &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                        &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-card&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-header&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-name&quot;</span><span style="color:#ABB2BF;">&gt;溶解氧&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-icon&quot;</span><span style="color:#ABB2BF;">&gt;&lt;</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;fas fa-vial&quot;</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-value&quot;</span><span style="color:#ABB2BF;">&gt;5.64mg/L&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-status&quot;</span><span style="color:#ABB2BF;">&gt;正常范围: 5.0~8.0mg/L&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                        &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                    &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">                &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;section&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                    &lt;</span><span style="color:#E06C75;">h3</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;section-title&quot;</span><span style="color:#ABB2BF;">&gt;&lt;</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;fas fa-wind&quot;</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">&gt; 气象监测&lt;/</span><span style="color:#E06C75;">h3</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                    &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameters-grid&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                        &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-card&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-header&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-name&quot;</span><span style="color:#ABB2BF;">&gt;风向&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-icon&quot;</span><span style="color:#ABB2BF;">&gt;&lt;</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;fas fa-compass&quot;</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-value&quot;</span><span style="color:#ABB2BF;">&gt;东南风&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-status&quot;</span><span style="color:#ABB2BF;">&gt;方向范围：0~360°&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                        &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">                        &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-card&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-header&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-name&quot;</span><span style="color:#ABB2BF;">&gt;风速&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-icon&quot;</span><span style="color:#ABB2BF;">&gt;&lt;</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;fas fa-wind&quot;</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-value&quot;</span><span style="color:#ABB2BF;">&gt;2.3m/s&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-status&quot;</span><span style="color:#ABB2BF;">&gt;适宜范围：1.0~3.0m/s&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                        &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">                        &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-card&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-header&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-name&quot;</span><span style="color:#ABB2BF;">&gt;空气温度&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-icon&quot;</span><span style="color:#ABB2BF;">&gt;&lt;</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;fas fa-thermometer-half&quot;</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-value&quot;</span><span style="color:#ABB2BF;">&gt;25.5°C&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-status&quot;</span><span style="color:#ABB2BF;">&gt;适宜范围: 22~32°C&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                        &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">                        &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-card&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-header&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-name&quot;</span><span style="color:#ABB2BF;">&gt;空气湿度&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-icon&quot;</span><span style="color:#ABB2BF;">&gt;&lt;</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;fas fa-cloud-rain&quot;</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-value&quot;</span><span style="color:#ABB2BF;">&gt;78%&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-status&quot;</span><span style="color:#ABB2BF;">&gt;适宜范围: 60~80%&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                        &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">                        &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-card&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-header&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-name&quot;</span><span style="color:#ABB2BF;">&gt;光照强度&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-icon&quot;</span><span style="color:#ABB2BF;">&gt;&lt;</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;fas fa-sun&quot;</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-value&quot;</span><span style="color:#ABB2BF;">&gt;23015Lux&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-status&quot;</span><span style="color:#ABB2BF;">&gt;适宜范围：20000~40000Lux&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                        &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">                        &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-card&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-header&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-name&quot;</span><span style="color:#ABB2BF;">&gt;水深&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-icon&quot;</span><span style="color:#ABB2BF;">&gt;&lt;</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;fas fa-ruler-vertical&quot;</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-value&quot;</span><span style="color:#ABB2BF;">&gt;110cm&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;parameter-status&quot;</span><span style="color:#ABB2BF;">&gt;正常范围: 50~120cm&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                        &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                    &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">            &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;">&lt;!-- 控制面板 --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;control-panel&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                &lt;</span><span style="color:#E06C75;">h2</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;panel-title&quot;</span><span style="color:#ABB2BF;">&gt;&lt;</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;fas fa-sliders-h&quot;</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">&gt; 设备控制&lt;/</span><span style="color:#E06C75;">h2</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#7F848E;font-style:italic;">&lt;!-- 水平排列的控制组 --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;controls-grid&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">                    &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;control-group&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                        &lt;</span><span style="color:#E06C75;">h3</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;control-title&quot;</span><span style="color:#ABB2BF;">&gt;&lt;</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;fas fa-fan&quot;</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">&gt; 增氧&lt;/</span><span style="color:#E06C75;">h3</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                        &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;control-buttons&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">button</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;control-btn oxygen-btn&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">data-device</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;oxygen&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">data-machine</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;1&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                &lt;</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;fas fa-wind&quot;</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                &lt;</span><span style="color:#E06C75;">span</span><span style="color:#ABB2BF;">&gt;东区&lt;/</span><span style="color:#E06C75;">span</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                &lt;</span><span style="color:#E06C75;">span</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;status&quot;</span><span style="color:#ABB2BF;">&gt;关闭&lt;/</span><span style="color:#E06C75;">span</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;/</span><span style="color:#E06C75;">button</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">button</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;control-btn oxygen-btn&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">data-device</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;oxygen&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">data-machine</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;2&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                &lt;</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;fas fa-wind&quot;</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                &lt;</span><span style="color:#E06C75;">span</span><span style="color:#ABB2BF;">&gt;西区&lt;/</span><span style="color:#E06C75;">span</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                &lt;</span><span style="color:#E06C75;">span</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;status&quot;</span><span style="color:#ABB2BF;">&gt;关闭&lt;/</span><span style="color:#E06C75;">span</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;/</span><span style="color:#E06C75;">button</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                        &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                    &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">                    &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;control-group&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                        &lt;</span><span style="color:#E06C75;">h3</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;control-title&quot;</span><span style="color:#ABB2BF;">&gt;&lt;</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;fas fa-bug&quot;</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">&gt; 除虫&lt;/</span><span style="color:#E06C75;">h3</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                        &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;control-buttons&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">button</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;control-btn insect-btn&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">data-device</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;insect&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">data-machine</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;1&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                &lt;</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;fas fa-spider&quot;</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                &lt;</span><span style="color:#E06C75;">span</span><span style="color:#ABB2BF;">&gt;东区&lt;/</span><span style="color:#E06C75;">span</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                &lt;</span><span style="color:#E06C75;">span</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;status&quot;</span><span style="color:#ABB2BF;">&gt;关闭&lt;/</span><span style="color:#E06C75;">span</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;/</span><span style="color:#E06C75;">button</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">button</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;control-btn insect-btn&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">data-device</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;insect&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">data-machine</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;2&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                &lt;</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;fas fa-spider&quot;</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                &lt;</span><span style="color:#E06C75;">span</span><span style="color:#ABB2BF;">&gt;西区&lt;/</span><span style="color:#E06C75;">span</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                &lt;</span><span style="color:#E06C75;">span</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;status&quot;</span><span style="color:#ABB2BF;">&gt;关闭&lt;/</span><span style="color:#E06C75;">span</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;/</span><span style="color:#E06C75;">button</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                        &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                    &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">                    &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;control-group&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                        &lt;</span><span style="color:#E06C75;">h3</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;control-title&quot;</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#7F848E;font-style:italic;">&lt;!-- &lt;i class=&quot;fas fa-faucet&quot;&gt;&lt;/i&gt; --&gt;</span><span style="color:#ABB2BF;"> 抽水/报警&lt;/</span><span style="color:#E06C75;">h3</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                        &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;control-buttons&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">button</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;control-btn pump-btn&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">data-device</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;pump&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">data-machine</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;1&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                &lt;</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;fas fa-water&quot;</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                &lt;</span><span style="color:#E06C75;">span</span><span style="color:#ABB2BF;">&gt;东区&lt;/</span><span style="color:#E06C75;">span</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                &lt;</span><span style="color:#E06C75;">span</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;status&quot;</span><span style="color:#ABB2BF;">&gt;关闭&lt;/</span><span style="color:#E06C75;">span</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;/</span><span style="color:#E06C75;">button</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">button</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;control-btn &quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">data-device</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;pump&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">data-machine</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;2&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                </span><span style="color:#D19A66;">style</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;background-color: #C0392B;color: #e1f5fe;&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                &lt;</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;fas fa-water&quot;</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                &lt;</span><span style="color:#E06C75;">span</span><span style="color:#ABB2BF;">&gt;报警&lt;/</span><span style="color:#E06C75;">span</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                &lt;</span><span style="color:#E06C75;">span</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;status&quot;</span><span style="color:#ABB2BF;">&gt;关闭&lt;/</span><span style="color:#E06C75;">span</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;/</span><span style="color:#E06C75;">button</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                        &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                    &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">                &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;camera-container&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                    &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;camera-header&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                        &lt;</span><span style="color:#E06C75;">h3</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;camera-title&quot;</span><span style="color:#ABB2BF;">&gt;&lt;</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;fas fa-video&quot;</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">&gt; 农田监控&lt;/</span><span style="color:#E06C75;">h3</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                        &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;camera-actions&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;select-wrapper&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                &lt;</span><span style="color:#E06C75;">select</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">id</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;cameraSelect&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;camera-select&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                    &lt;</span><span style="color:#E06C75;">option</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">value</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;&quot;</span><span style="color:#ABB2BF;">&gt;选择区域&lt;/</span><span style="color:#E06C75;">option</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                                &lt;/</span><span style="color:#E06C75;">select</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">button</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;camera-btn&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">id</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;fullscreenBtn&quot;</span><span style="color:#ABB2BF;">&gt;&lt;</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;fas fa-expand&quot;</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">&gt; 全屏显示&lt;/</span><span style="color:#E06C75;">button</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">button</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;camera-btn&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">id</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;monitorRoomBtn&quot;</span><span style="color:#ABB2BF;">&gt;&lt;</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;fas fa-video&quot;</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">&gt; 监控室&lt;/</span><span style="color:#E06C75;">button</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                        &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                    &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                    &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;camera-feed&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                        &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;camera-placeholder&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;fas fa-camera&quot;</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">h3</span><span style="color:#ABB2BF;">&gt;摄像头连接&lt;/</span><span style="color:#E06C75;">h3</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                            &lt;</span><span style="color:#E06C75;">p</span><span style="color:#ABB2BF;">&gt;实时监控农田情况&lt;/</span><span style="color:#E06C75;">p</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                        &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                        &lt;</span><span style="color:#E06C75;">img</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">id</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;camera-video&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">src</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                       </span></span>
<span class="line"><span style="color:#ABB2BF;">                        </span><span style="color:#7F848E;font-style:italic;">&lt;!-- &lt;video src=&quot;pangxie.mp4&quot; style=&quot;width:450px;width: 100%;height: 100%;object-fit: cover;display: block;&quot;&gt;&lt;/video&gt; --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                       </span></span>
<span class="line"><span style="color:#ABB2BF;">                        </span><span style="color:#7F848E;font-style:italic;">&lt;!-- &lt;div class=&quot;timestamp&quot;&gt;2023-07-28 14:35:22&lt;/div&gt; --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                    &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">            &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">        &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;status-bar&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;status-item&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;status-indicator&quot;</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                &lt;</span><span style="color:#E06C75;">span</span><span style="color:#ABB2BF;">&gt;系统状态: 运行中&lt;/</span><span style="color:#E06C75;">span</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">            &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;status-item&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;status-indicator&quot;</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                &lt;</span><span style="color:#E06C75;">span</span><span style="color:#ABB2BF;">&gt;网络连接: 正常&lt;/</span><span style="color:#E06C75;">span</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">            &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;status-item&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;status-indicator&quot;</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                &lt;</span><span style="color:#E06C75;">span</span><span style="color:#ABB2BF;">&gt;数据更新: 实时&lt;/</span><span style="color:#E06C75;">span</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">            &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;status-item&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#7F848E;font-style:italic;">&lt;!--  &lt;div class=&quot;status-indicator offline&quot;&gt;&lt;/div&gt;</span></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">                &lt;span&gt;传感器 : #7离线&lt;/span&gt; --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;status-indicator&quot;</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                &lt;</span><span style="color:#E06C75;">span</span><span style="color:#ABB2BF;">&gt;传感器 : 在线&lt;/</span><span style="color:#E06C75;">span</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">            &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">        &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#7F848E;font-style:italic;">&lt;!-- 添加全屏监控模态框HTML --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;modal-overlay&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">id</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;videoModal&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">        &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;modal-container&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;modal-header&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                &lt;</span><span style="color:#E06C75;">h3</span><span style="color:#ABB2BF;">&gt;农田监控 - 全屏视图&lt;/</span><span style="color:#E06C75;">h3</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                &lt;</span><span style="color:#E06C75;">button</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;close-modal&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">id</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;closeModal&quot;</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#E06C75;">&amp;times;</span><span style="color:#ABB2BF;">&lt;/</span><span style="color:#E06C75;">button</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">            &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;modal-content&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                &lt;</span><span style="color:#E06C75;">img</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">id</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;modal-video&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">src</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">            &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">        &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#7F848E;font-style:italic;">&lt;!-- 添加监控室模态框 --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;modal-overlay&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">id</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;monitorRoomModal&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">        &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;modal-container monitor-room&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;modal-header&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                &lt;</span><span style="color:#E06C75;">h3</span><span style="color:#ABB2BF;">&gt;稻田监控室&lt;/</span><span style="color:#E06C75;">h3</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                &lt;</span><span style="color:#E06C75;">button</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;close-modal&quot;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">id</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;closeMonitorModal&quot;</span><span style="color:#ABB2BF;">&gt;</span><span style="color:#E06C75;">&amp;times;</span><span style="color:#ABB2BF;">&lt;/</span><span style="color:#E06C75;">button</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">            &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">            &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;modal-content&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                &lt;</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">class</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;monitor-grid&quot;</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#7F848E;font-style:italic;">&lt;!-- 监控画面将通过JS动态加载 --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">                &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">            &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">        &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;/</span><span style="color:#E06C75;">div</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;</span><span style="color:#E06C75;">script</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">src</span><span style="color:#ABB2BF;">=</span><span style="color:#98C379;">&quot;config.js&quot;</span><span style="color:#ABB2BF;">&gt;&lt;/</span><span style="color:#E06C75;">script</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#7F848E;font-style:italic;">&lt;!-- 填入JavaScript  --&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">&lt;/</span><span style="color:#E06C75;">body</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">&lt;/</span><span style="color:#E06C75;">html</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2、javascript-index-html" tabindex="-1"><a class="header-anchor" href="#_2、javascript-index-html" aria-hidden="true">#</a> 2、JavaScript | index.html</h4><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;"> &lt;</span><span style="color:#E06C75;">script</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="color:#ABB2BF;">        const baseURL = AppConfig.API_BASE_URL;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        // 获取本地摄像头列表，填充下拉框</span></span>
<span class="line"><span style="color:#ABB2BF;">        async function loadCameraList() </span><span style="color:#C678DD;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">try</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">                const </span><span style="color:#E06C75;">response</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">await</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">fetch</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">\`</span><span style="color:#C678DD;">\${</span><span style="color:#E06C75;">baseURL</span><span style="color:#C678DD;">}</span><span style="color:#98C379;">/api/cameraList\`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">                const </span><span style="color:#E06C75;">result</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">await</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">response</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#61AFEF;">if</span><span style="color:#ABB2BF;"> (result.code === 200 &amp;&amp; Array.isArray(result.data)) {</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">select</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">document</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getElementById</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;cameraSelect&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#7F848E;font-style:italic;">// 清空之前的选项，只保留第一个“请选择”选项</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#E5C07B;">select</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">options</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">length</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#E5C07B;">result</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">data</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">forEach</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">cam</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">                        </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">option</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">document</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">createElement</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;option&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">                        </span><span style="color:#E5C07B;">option</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">value</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">cam</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">index</span><span style="color:#ABB2BF;">; </span><span style="color:#7F848E;font-style:italic;">// index用作value，后端摄像头索引</span></span>
<span class="line"><span style="color:#ABB2BF;">                        </span><span style="color:#E5C07B;">option</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">textContent</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">cam</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">label</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">                        </span><span style="color:#E5C07B;">select</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">appendChild</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">option</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">                    });</span></span>
<span class="line"><span style="color:#ABB2BF;">                } else {</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">error</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;获取摄像头列表失败&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">result</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">message</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">                }</span></span>
<span class="line"><span style="color:#ABB2BF;">            } </span><span style="color:#61AFEF;">catch</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">e</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">                console.error(</span><span style="color:#98C379;">&#39;请求摄像头列表出错&#39;</span><span style="color:#ABB2BF;">, e);</span></span>
<span class="line"><span style="color:#ABB2BF;">            }</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        function updateVideoStream(cameraIndex) </span><span style="color:#C678DD;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">video</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">document</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getElementById</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;camera-video&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">placeholder</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">document</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">querySelector</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;.camera-placeholder&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#61AFEF;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#56B6C2;">!</span><span style="color:#E06C75;">cameraIndex</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#7F848E;font-style:italic;">// 无选择时：清空视频源，显示提示</span></span>
<span class="line"><span style="color:#ABB2BF;">                video.</span><span style="color:#E06C75;">src</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&#39;&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">                video.style.</span><span style="color:#E06C75;">display</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&#39;none&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">                placeholder.style.</span><span style="color:#E06C75;">display</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&#39;flex&#39;</span><span style="color:#ABB2BF;">; </span><span style="color:#7F848E;font-style:italic;">// 或 block，视样式而定</span></span>
<span class="line"><span style="color:#ABB2BF;">                return;</span></span>
<span class="line"><span style="color:#ABB2BF;">            }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;">// 有选择时：更新视频源，隐藏提示</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">video</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">src</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">\`</span><span style="color:#C678DD;">\${</span><span style="color:#E06C75;">baseURL</span><span style="color:#C678DD;">}</span><span style="color:#98C379;">/api/stream?index=</span><span style="color:#C678DD;">\${</span><span style="color:#E06C75;">cameraIndex</span><span style="color:#C678DD;">}</span><span style="color:#98C379;">&amp;t=</span><span style="color:#C678DD;">\${</span><span style="color:#E5C07B;">Date</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">now</span><span style="color:#ABB2BF;">()</span><span style="color:#C678DD;">}</span><span style="color:#98C379;">\`</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">video</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">style</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">display</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&#39;block&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">placeholder</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">style</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">display</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&#39;none&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        // 监听选择事件</span></span>
<span class="line"><span style="color:#ABB2BF;">        document.getElementById(&#39;cameraSelect&#39;).addEventListener(&#39;change&#39;, function () </span><span style="color:#C678DD;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#61AFEF;">updateVideoStream</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">value</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">}</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        // 页面加载时，加载摄像头列表</span></span>
<span class="line"><span style="color:#ABB2BF;">        window.addEventListener(&#39;load&#39;, loadCameraList);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        // 监控放大</span></span>
<span class="line"><span style="color:#ABB2BF;">        document.getElementById(&#39;fullscreenBtn&#39;).addEventListener(&#39;click&#39;, function () </span><span style="color:#C678DD;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">modal</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">document</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getElementById</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;videoModal&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">videoElement</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">document</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getElementById</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;camera-video&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">modalVideo</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">document</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getElementById</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;modal-video&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">modalVideo</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">src</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">videoElement</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">src</span><span style="color:#ABB2BF;">;           </span><span style="color:#7F848E;font-style:italic;">// 设置模态框视频源</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">modal</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">style</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">display</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&#39;flex&#39;</span><span style="color:#ABB2BF;">;           </span><span style="color:#7F848E;font-style:italic;">// 显示模态框</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">document</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">body</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">style</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">overflow</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&#39;hidden&#39;</span><span style="color:#ABB2BF;">;            </span><span style="color:#7F848E;font-style:italic;">// 禁用页面滚动</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">}</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        // 按钮关闭本地摄像头模态框</span></span>
<span class="line"><span style="color:#ABB2BF;">        document.getElementById(&#39;closeModal&#39;).addEventListener(&#39;click&#39;, function () </span><span style="color:#C678DD;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">modal</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">document</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getElementById</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;videoModal&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">modal</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">style</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">display</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&#39;none&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">document</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">body</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">style</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">overflow</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&#39;auto&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">}</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        // 监控室功能：ESP32-CAM摄像头</span></span>
<span class="line"><span style="color:#ABB2BF;">        document.getElementById(&#39;monitorRoomBtn&#39;).addEventListener(&#39;click&#39;, async function () </span><span style="color:#C678DD;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">modal</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">document</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getElementById</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;monitorRoomModal&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">monitorGrid</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">document</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">querySelector</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;.monitor-grid&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">monitorGrid</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">innerHTML</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&#39;&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E06C75;">try</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">                const </span><span style="color:#E06C75;">res</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">await</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">fetch</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">\`</span><span style="color:#C678DD;">\${</span><span style="color:#E06C75;">baseURL</span><span style="color:#C678DD;">}</span><span style="color:#98C379;">/api/videoUrl\`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">                const </span><span style="color:#E06C75;">json</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">await</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">res</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#61AFEF;">if</span><span style="color:#ABB2BF;"> (json.code === 200 &amp;&amp; Array.isArray(json.data)) {</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#E5C07B;">json</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">data</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">forEach</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">camera</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">                        </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> { </span><span style="color:#E5C07B;">name</span><span style="color:#ABB2BF;">, </span><span style="color:#E5C07B;">ip</span><span style="color:#ABB2BF;"> } </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">camera</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">                        </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">monitorItem</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">document</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">createElement</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;div&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">                        </span><span style="color:#E5C07B;">monitorItem</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">className</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&#39;monitor-item&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">                        </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">title</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">document</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">createElement</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;div&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">                        </span><span style="color:#E5C07B;">title</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">className</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&#39;monitor-title&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">                        </span><span style="color:#E5C07B;">title</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">textContent</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">\`</span><span style="color:#C678DD;">\${</span><span style="color:#E06C75;">name</span><span style="color:#C678DD;">}</span><span style="color:#98C379;"> (</span><span style="color:#C678DD;">\${</span><span style="color:#E06C75;">ip</span><span style="color:#C678DD;">}</span><span style="color:#98C379;">)\`</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">                        </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">frame</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">document</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">createElement</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;img&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">                        </span><span style="color:#E5C07B;">frame</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">className</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&#39;monitor-frame&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">                        </span><span style="color:#E5C07B;">frame</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">src</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">\`http://</span><span style="color:#C678DD;">\${</span><span style="color:#E06C75;">ip</span><span style="color:#C678DD;">}</span><span style="color:#98C379;">:81/stream?t=</span><span style="color:#C678DD;">\${</span><span style="color:#E5C07B;">Date</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">now</span><span style="color:#ABB2BF;">()</span><span style="color:#C678DD;">}</span><span style="color:#98C379;">\`</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">                        </span><span style="color:#E5C07B;">frame</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">alt</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">name</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">                        </span><span style="color:#7F848E;font-style:italic;">// 连接失败占位图</span></span>
<span class="line"><span style="color:#ABB2BF;">                        </span><span style="color:#E5C07B;">frame</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">onerror</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">function</span><span style="color:#ABB2BF;"> () {</span></span>
<span class="line"><span style="color:#ABB2BF;">                            </span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">src</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&#39;data:image/svg+xml;charset=UTF-8,%3Csvg xmlns=&quot;http://www.w3.org/2000/svg&quot; width=&quot;100&quot; height=&quot;100&quot; viewBox=&quot;0 0 100 100&quot;%3E%3Crect fill=&quot;%23222&quot; width=&quot;100&quot; height=&quot;100&quot;/%3E%3Ctext fill=&quot;%23fff&quot; font-family=&quot;Arial&quot; font-size=&quot;12&quot; x=&quot;50%&quot; y=&quot;50%&quot; text-anchor=&quot;middle&quot; dominant-baseline=&quot;middle&quot;%3E连接失败%3C/text%3E%3C/svg%3E&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">                        };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">                        </span><span style="color:#E5C07B;">monitorItem</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">appendChild</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">title</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">                        </span><span style="color:#E5C07B;">monitorItem</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">appendChild</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">frame</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">                        </span><span style="color:#E5C07B;">monitorGrid</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">appendChild</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">monitorItem</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">                    });</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#E5C07B;">modal</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">style</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">display</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&#39;flex&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#E5C07B;">document</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">body</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">style</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">overflow</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&#39;hidden&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">                } else {</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#61AFEF;">alert</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;摄像头列表为空或接口异常&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">                }</span></span>
<span class="line"><span style="color:#ABB2BF;">            } </span><span style="color:#61AFEF;">catch</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">err</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">                console.error(</span><span style="color:#98C379;">&#39;摄像头接口请求失败:&#39;</span><span style="color:#ABB2BF;">, err);</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#61AFEF;">alert</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;摄像头接口请求失败&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">            }</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">}</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        // 关闭监控室模态框</span></span>
<span class="line"><span style="color:#ABB2BF;">        document.getElementById(&#39;closeMonitorModal&#39;).addEventListener(&#39;click&#39;, function () </span><span style="color:#C678DD;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">document</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">getElementById</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;monitorRoomModal&#39;</span><span style="color:#ABB2BF;">).</span><span style="color:#E5C07B;">style</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">display</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&#39;none&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">document</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">body</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">style</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">overflow</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&#39;auto&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">}</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        // 按钮控制逻辑，包含API请求</span></span>
<span class="line"><span style="color:#ABB2BF;">        document.querySelectorAll(&#39;.control-btn&#39;).forEach(button =&gt; </span><span style="color:#C678DD;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#E5C07B;">button</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">addEventListener</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;click&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#C678DD;">async</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">function</span><span style="color:#ABB2BF;"> () {</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">isActive</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">classList</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">contains</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;active&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">statusElement</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">querySelector</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;.status&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">deviceType</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">dataset</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">device</span><span style="color:#ABB2BF;">; </span><span style="color:#7F848E;font-style:italic;">// pump/oxygen/insect</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">machineNum</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">dataset</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">machine</span><span style="color:#ABB2BF;">; </span><span style="color:#7F848E;font-style:italic;">// 机器编号</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#7F848E;font-style:italic;">// 确定引脚映射</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">pinMap</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#E06C75;">oxygen</span><span style="color:#ABB2BF;">: { </span><span style="color:#98C379;">&#39;1&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;V3&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;2&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;V4&#39;</span><span style="color:#ABB2BF;"> },</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#E06C75;">insect</span><span style="color:#ABB2BF;">: { </span><span style="color:#98C379;">&#39;1&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;V5&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;2&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;V6&#39;</span><span style="color:#ABB2BF;"> },</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#E06C75;">pump</span><span style="color:#ABB2BF;">: { </span><span style="color:#98C379;">&#39;1&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;V7&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;2&#39;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&#39;V8&#39;</span><span style="color:#ABB2BF;"> }</span></span>
<span class="line"><span style="color:#ABB2BF;">                };</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">pin</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">pinMap</span><span style="color:#ABB2BF;">[</span><span style="color:#E06C75;">deviceType</span><span style="color:#ABB2BF;">]?.[</span><span style="color:#E06C75;">machineNum</span><span style="color:#ABB2BF;">];</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#56B6C2;">!</span><span style="color:#E06C75;">pin</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#61AFEF;">alert</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;设备配置错误&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">                }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#C678DD;">try</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#7F848E;font-style:italic;">// 调用后端API</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">response</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">await</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">fetch</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">\`</span><span style="color:#C678DD;">\${</span><span style="color:#E06C75;">baseURL</span><span style="color:#C678DD;">}</span><span style="color:#98C379;">/api/execute?pin=</span><span style="color:#C678DD;">\${</span><span style="color:#E06C75;">pin</span><span style="color:#C678DD;">}</span><span style="color:#98C379;">&amp;state=</span><span style="color:#C678DD;">\${</span><span style="color:#E06C75;">isActive</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">?</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&#39;0&#39;</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">:</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&#39;1&#39;</span><span style="color:#C678DD;">}</span><span style="color:#98C379;">\`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">result</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">await</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">response</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">result</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">code</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">===</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">200</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">                        </span><span style="color:#7F848E;font-style:italic;">// 切换按钮状态</span></span>
<span class="line"><span style="color:#ABB2BF;">                        </span><span style="color:#E5C07B;">this</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">classList</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">toggle</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;active&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">                        </span><span style="color:#E5C07B;">statusElement</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">textContent</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">isActive</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">?</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&#39;关闭&#39;</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">:</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&#39;开启&#39;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">                    } </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">                        </span><span style="color:#61AFEF;">alert</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">\`控制失败: </span><span style="color:#C678DD;">\${</span><span style="color:#E5C07B;">result</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">message</span><span style="color:#C678DD;">}</span><span style="color:#98C379;">\`</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">                    }</span></span>
<span class="line"><span style="color:#ABB2BF;">                } </span><span style="color:#C678DD;">catch</span><span style="color:#ABB2BF;"> (</span><span style="color:#E06C75;">error</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#E5C07B;">console</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">error</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;请求出错:&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">error</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#61AFEF;">alert</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;网络请求失败，请检查连接&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">                }</span></span>
<span class="line"><span style="color:#ABB2BF;">            });</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">}</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        /* </span></span>
<span class="line"><span style="color:#ABB2BF;">                // 模拟实时数据更新</span></span>
<span class="line"><span style="color:#ABB2BF;">                function updateParameterValues() </span><span style="color:#C678DD;">{</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#E5C07B;">document</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">querySelectorAll</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;.parameter-card&#39;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">forEach</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">card</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">=&gt;</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">                        </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">valueElement</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">card</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">querySelector</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;.parameter-value&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">                        </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">currentValue</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">parseFloat</span><span style="color:#ABB2BF;">(</span><span style="color:#E5C07B;">valueElement</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">textContent</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">replace</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">/</span><span style="color:#D19A66;">[</span><span style="color:#ABB2BF;">^</span><span style="color:#E06C75;">\\d.</span><span style="color:#D19A66;">-]</span><span style="color:#E06C75;">/</span><span style="color:#C678DD;">g</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;&#39;</span><span style="color:#ABB2BF;">));</span></span>
<span class="line"><span style="color:#ABB2BF;">                        </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">unit</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">valueElement</span><span style="color:#ABB2BF;">.</span><span style="color:#E5C07B;">textContent</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">replace</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">/</span><span style="color:#D19A66;">[</span><span style="color:#E06C75;">\\d.</span><span style="color:#D19A66;">-]</span><span style="color:#E06C75;">/</span><span style="color:#C678DD;">g</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;&#39;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">trim</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">                        </span><span style="color:#7F848E;font-style:italic;">// 生成一个小的随机波动</span></span>
<span class="line"><span style="color:#ABB2BF;">                        </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">fluctuation</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> (</span><span style="color:#E5C07B;">Math</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">random</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">-</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0.5</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">*</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">                        </span><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">newValue</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Math</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">max</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;">currentValue</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">fluctuation</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">toFixed</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">                        </span><span style="color:#7F848E;font-style:italic;">// 只更新数值部分，保留单位</span></span>
<span class="line"><span style="color:#ABB2BF;">                        </span><span style="color:#E5C07B;">valueElement</span><span style="color:#ABB2BF;">.</span><span style="color:#E06C75;">textContent</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">unit</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">includes</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;%&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">?</span></span>
<span class="line"><span style="color:#ABB2BF;">                            </span><span style="color:#98C379;">\`</span><span style="color:#C678DD;">\${</span><span style="color:#61AFEF;">parseFloat</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">newValue</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">toFixed</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">)</span><span style="color:#C678DD;">}</span><span style="color:#98C379;">%\`</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                            </span><span style="color:#E5C07B;">unit</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">includes</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;Lux&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">?</span></span>
<span class="line"><span style="color:#ABB2BF;">                                </span><span style="color:#98C379;">\`</span><span style="color:#C678DD;">\${</span><span style="color:#E5C07B;">Math</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">round</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">parseFloat</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">newValue</span><span style="color:#ABB2BF;">) </span><span style="color:#56B6C2;">*</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">1000</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">toLocaleString</span><span style="color:#ABB2BF;">()</span><span style="color:#C678DD;">}</span><span style="color:#98C379;"> Lux\`</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                                </span><span style="color:#98C379;">\`</span><span style="color:#C678DD;">\${</span><span style="color:#E06C75;">newValue</span><span style="color:#C678DD;">}\${</span><span style="color:#E06C75;">unit</span><span style="color:#C678DD;">}</span><span style="color:#98C379;">\`</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">                    });</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#7F848E;font-style:italic;">// 更新时间戳</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#E06C75;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">now</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">new</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">Date</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">                    </span><span style="color:#E5C07B;">document</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">querySelector</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;.timestamp&#39;</span><span style="color:#ABB2BF;">).</span><span style="color:#E06C75;">textContent</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">now</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">toISOString</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">replace</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;T&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39; &#39;</span><span style="color:#ABB2BF;">).</span><span style="color:#61AFEF;">substring</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">19</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#C678DD;">}</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span></span>
<span class="line"><span style="color:#ABB2BF;">                // 每3秒更新一次数据</span></span>
<span class="line"><span style="color:#ABB2BF;">                setInterval(updateParameterValues, 3000);</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span></span>
<span class="line"><span style="color:#ABB2BF;">                // 初始更新</span></span>
<span class="line"><span style="color:#ABB2BF;">                updateParameterValues(); */</span></span>
<span class="line"><span style="color:#ABB2BF;">    &lt;/</span><span style="color:#E06C75;">script</span><span style="color:#ABB2BF;">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_3、css-style-css" tabindex="-1"><a class="header-anchor" href="#_3、css-style-css" aria-hidden="true">#</a> 3、CSS | style.css</h4><div class="language-css line-numbers-mode" data-ext="css"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#E06C75;">*</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    margin: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    padding: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    box-sizing: </span><span style="color:#D19A66;">border-box</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    font-family: </span><span style="color:#98C379;">&#39;Segoe UI&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&#39;Microsoft YaHei&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">sans-serif</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#56B6C2;">-webkit-tap-highlight-color</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">transparent</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">body</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    background: </span><span style="color:#56B6C2;">linear-gradient</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">135</span><span style="color:#E06C75;">deg</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">#1a2a3a</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">#0d1b2a</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    color: </span><span style="color:#D19A66;">#e0f7fa</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    min-height: </span><span style="color:#D19A66;">100</span><span style="color:#E06C75;">vh</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    overflow-x: </span><span style="color:#D19A66;">hidden</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    padding: </span><span style="color:#D19A66;">10</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.container</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    max-width: </span><span style="color:#D19A66;">100</span><span style="color:#E06C75;">%</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    margin: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">auto</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    padding: </span><span style="color:#D19A66;">5</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">header</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    text-align: </span><span style="color:#D19A66;">center</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    margin-bottom: </span><span style="color:#D19A66;">15</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    padding: </span><span style="color:#D19A66;">10</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    border-bottom: </span><span style="color:#D19A66;">2</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">solid</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">rgba</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">200</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">255</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.3</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E06C75;">header</span><span style="color:#C678DD;"> </span><span style="color:#E06C75;">h1</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    font-size: </span><span style="color:#D19A66;">1.5</span><span style="color:#E06C75;">rem</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    margin-bottom: </span><span style="color:#D19A66;">5</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    background: </span><span style="color:#56B6C2;">linear-gradient</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">90</span><span style="color:#E06C75;">deg</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">#00b4db</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">#00ff95</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#56B6C2;">-webkit-background-clip</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">text</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#56B6C2;">-webkit-text-fill-color</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">transparent</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    text-shadow: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">2</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">10</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">rgba</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">180</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">219</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.3</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.subtitle</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    color: </span><span style="color:#D19A66;">#80deea</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    font-size: </span><span style="color:#D19A66;">0.9</span><span style="color:#E06C75;">rem</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    max-width: </span><span style="color:#D19A66;">100</span><span style="color:#E06C75;">%</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    margin: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">auto</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    line-height: </span><span style="color:#D19A66;">1.4</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.dashboard</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    display: </span><span style="color:#D19A66;">flex</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    flex-direction: </span><span style="color:#D19A66;">column</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    gap: </span><span style="color:#D19A66;">15</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.parameters-panel</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    background: </span><span style="color:#56B6C2;">rgba</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">13</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">27</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">42</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.8</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    border-radius: </span><span style="color:#D19A66;">12</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    padding: </span><span style="color:#D19A66;">12</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    font-size: </span><span style="color:#D19A66;">0.85</span><span style="color:#E06C75;">rem</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    box-shadow: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">5</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">15</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">rgba</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.4</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    border: </span><span style="color:#D19A66;">1</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">solid</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">rgba</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">64</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">224</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">208</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.2</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    max-height: </span><span style="color:#D19A66;">50</span><span style="color:#E06C75;">vh</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    overflow-y: </span><span style="color:#D19A66;">auto</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.control-panel</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    background: </span><span style="color:#56B6C2;">rgba</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">13</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">27</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">42</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.8</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    border-radius: </span><span style="color:#D19A66;">12</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    padding: </span><span style="color:#D19A66;">15</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    font-size: </span><span style="color:#D19A66;">0.9</span><span style="color:#E06C75;">rem</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    box-shadow: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">5</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">15</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">rgba</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.4</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    border: </span><span style="color:#D19A66;">1</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">solid</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">rgba</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">64</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">224</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">208</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.2</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.panel-title</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    font-size: </span><span style="color:#D19A66;">1.2</span><span style="color:#E06C75;">rem</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    margin-bottom: </span><span style="color:#D19A66;">15</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    padding-bottom: </span><span style="color:#D19A66;">10</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    border-bottom: </span><span style="color:#D19A66;">2</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">solid</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">rgba</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">200</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">255</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.3</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    color: </span><span style="color:#D19A66;">#4fc3f7</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    display: </span><span style="color:#D19A66;">flex</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    align-items: </span><span style="color:#D19A66;">center</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    gap: </span><span style="color:#D19A66;">8</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.panel-title</span><span style="color:#C678DD;"> </span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    font-size: </span><span style="color:#D19A66;">1.2</span><span style="color:#E06C75;">rem</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.section</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    margin-bottom: </span><span style="color:#D19A66;">20</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.section-title</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    font-size: </span><span style="color:#D19A66;">1.1</span><span style="color:#E06C75;">rem</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    color: </span><span style="color:#D19A66;">#81d4fa</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    margin-bottom: </span><span style="color:#D19A66;">12</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    display: </span><span style="color:#D19A66;">flex</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    align-items: </span><span style="color:#D19A66;">center</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    gap: </span><span style="color:#D19A66;">8</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.parameters-grid</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    display: </span><span style="color:#D19A66;">grid</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    grid-template-columns: </span><span style="color:#56B6C2;">repeat</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">auto-fill</span><span style="color:#ABB2BF;">, </span><span style="color:#56B6C2;">minmax</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">160</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">1</span><span style="color:#E06C75;">fr</span><span style="color:#ABB2BF;">));</span></span>
<span class="line"><span style="color:#ABB2BF;">    gap: </span><span style="color:#D19A66;">12</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.parameter-card</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    background: </span><span style="color:#56B6C2;">rgba</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">25</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">55</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">80</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.6</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    border-radius: </span><span style="color:#D19A66;">8</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    padding: </span><span style="color:#D19A66;">10</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    border: </span><span style="color:#D19A66;">1</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">solid</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">rgba</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">64</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">224</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">208</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.2</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    transition: </span><span style="color:#D19A66;">all</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0.3</span><span style="color:#E06C75;">s</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">ease</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    box-shadow: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">3</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">8</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">rgba</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.15</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.parameter-card</span><span style="color:#56B6C2;">:hover</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    transform: </span><span style="color:#56B6C2;">translateY</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">-3</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    box-shadow: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">5</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">15</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">rgba</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">200</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">255</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.3</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    border-color: </span><span style="color:#56B6C2;">rgba</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">200</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">255</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.5</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.parameter-header</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    display: </span><span style="color:#D19A66;">flex</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    justify-content: </span><span style="color:#D19A66;">space-between</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    align-items: </span><span style="color:#D19A66;">center</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    margin-bottom: </span><span style="color:#D19A66;">10</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.parameter-name</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    font-size: </span><span style="color:#D19A66;">0.95</span><span style="color:#E06C75;">rem</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    font-weight: </span><span style="color:#D19A66;">600</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    color: </span><span style="color:#D19A66;">#b3e5fc</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.parameter-icon</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    font-size: </span><span style="color:#D19A66;">1.4</span><span style="color:#E06C75;">rem</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    color: </span><span style="color:#D19A66;">#4fc3f7</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    width: </span><span style="color:#D19A66;">40</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    height: </span><span style="color:#D19A66;">40</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    background: </span><span style="color:#56B6C2;">rgba</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">150</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">200</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.2</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    border-radius: </span><span style="color:#D19A66;">8</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    display: </span><span style="color:#D19A66;">flex</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    align-items: </span><span style="color:#D19A66;">center</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    justify-content: </span><span style="color:#D19A66;">center</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.parameter-value</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    font-size: </span><span style="color:#D19A66;">1.2</span><span style="color:#E06C75;">rem</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    font-weight: </span><span style="color:#D19A66;">600</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    text-align: </span><span style="color:#D19A66;">center</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    margin: </span><span style="color:#D19A66;">5</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    font-family: </span><span style="color:#98C379;">&#39;Courier New&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">monospace</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    color: </span><span style="color:#D19A66;">#e1f5fe</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    text-shadow: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">5</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">rgba</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">100</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">255</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">255</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.5</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.parameter-status</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    text-align: </span><span style="color:#D19A66;">center</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    font-size: </span><span style="color:#D19A66;">0.8</span><span style="color:#E06C75;">rem</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    color: </span><span style="color:#D19A66;">#b2ebf2</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    font-style: </span><span style="color:#D19A66;">italic</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.controls-grid</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    display: </span><span style="color:#D19A66;">grid</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    grid-template-columns: </span><span style="color:#D19A66;">1</span><span style="color:#E06C75;">fr</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    gap: </span><span style="color:#D19A66;">15</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    margin-bottom: </span><span style="color:#D19A66;">15</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.control-group</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    background: </span><span style="color:#56B6C2;">rgba</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">25</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">55</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">80</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.6</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    border-radius: </span><span style="color:#D19A66;">12</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    padding: </span><span style="color:#D19A66;">15</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    border: </span><span style="color:#D19A66;">1</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">solid</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">rgba</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">64</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">224</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">208</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.2</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    box-shadow: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">5</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">15</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">rgba</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.2</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.control-title</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    font-size: </span><span style="color:#D19A66;">1.1</span><span style="color:#E06C75;">rem</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    color: </span><span style="color:#D19A66;">#81d4fa</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    margin-bottom: </span><span style="color:#D19A66;">12</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    text-align: </span><span style="color:#D19A66;">center</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.control-buttons</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    display: </span><span style="color:#D19A66;">flex</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    justify-content: </span><span style="color:#D19A66;">space-around</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    gap: </span><span style="color:#D19A66;">10</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.control-btn</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    flex: </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    padding: </span><span style="color:#D19A66;">12</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">5</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    border: </span><span style="color:#D19A66;">none</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    border-radius: </span><span style="color:#D19A66;">10</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    font-size: </span><span style="color:#D19A66;">0.95</span><span style="color:#E06C75;">rem</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    font-weight: </span><span style="color:#D19A66;">600</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    cursor: </span><span style="color:#D19A66;">pointer</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    transition: </span><span style="color:#D19A66;">all</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0.3</span><span style="color:#E06C75;">s</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">ease</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    display: </span><span style="color:#D19A66;">flex</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    flex-direction: </span><span style="color:#D19A66;">column</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    align-items: </span><span style="color:#D19A66;">center</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    gap: </span><span style="color:#D19A66;">6</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    box-shadow: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">5</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">15</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">rgba</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.3</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    min-height: </span><span style="color:#D19A66;">90</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.control-btn</span><span style="color:#C678DD;"> </span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    font-size: </span><span style="color:#D19A66;">1.6</span><span style="color:#E06C75;">rem</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.pump-btn</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    background: </span><span style="color:#56B6C2;">linear-gradient</span><span style="color:#ABB2BF;">(to </span><span style="color:#D19A66;">bottom</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">#29b6f6</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">#0288d1</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    color: </span><span style="color:#D19A66;">#e1f5fe</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.pump-btn.active</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    background: </span><span style="color:#56B6C2;">linear-gradient</span><span style="color:#ABB2BF;">(to </span><span style="color:#D19A66;">bottom</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">#00e676</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">#00c853</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    box-shadow: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">15</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">rgba</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">230</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">118</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.5</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.oxygen-btn</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    background: </span><span style="color:#56B6C2;">linear-gradient</span><span style="color:#ABB2BF;">(to </span><span style="color:#D19A66;">bottom</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">#26c6da</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">#0097a7</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    color: </span><span style="color:#D19A66;">#e1f5fe</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.oxygen-btn.active</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    background: </span><span style="color:#56B6C2;">linear-gradient</span><span style="color:#ABB2BF;">(to </span><span style="color:#D19A66;">bottom</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">#00e676</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">#00c853</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    box-shadow: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">15</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">rgba</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">230</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">118</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.5</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.insect-btn</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    background: </span><span style="color:#56B6C2;">linear-gradient</span><span style="color:#ABB2BF;">(to </span><span style="color:#D19A66;">bottom</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">#7e57c2</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">#512da8</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    color: </span><span style="color:#D19A66;">#e1f5fe</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.insect-btn.active</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    background: </span><span style="color:#56B6C2;">linear-gradient</span><span style="color:#ABB2BF;">(to </span><span style="color:#D19A66;">bottom</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">#00e676</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">#00c853</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    box-shadow: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">15</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">rgba</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">230</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">118</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.5</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.camera-container</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    background: </span><span style="color:#56B6C2;">rgba</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.4</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    border-radius: </span><span style="color:#D19A66;">12</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    overflow: </span><span style="color:#D19A66;">hidden</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    display: </span><span style="color:#D19A66;">flex</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    flex-direction: </span><span style="color:#D19A66;">column</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    border: </span><span style="color:#D19A66;">1</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">solid</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">rgba</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">64</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">224</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">208</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.2</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    min-height: </span><span style="color:#D19A66;">240</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.camera-header</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    padding: </span><span style="color:#D19A66;">10</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    background: </span><span style="color:#56B6C2;">rgba</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">25</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">55</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">80</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.8</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    display: </span><span style="color:#D19A66;">flex</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    justify-content: </span><span style="color:#D19A66;">space-between</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    align-items: </span><span style="color:#D19A66;">center</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.camera-title</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    font-size: </span><span style="color:#D19A66;">1.1</span><span style="color:#E06C75;">rem</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    color: </span><span style="color:#D19A66;">#81d4fa</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.camera-actions</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    display: </span><span style="color:#D19A66;">flex</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    gap: </span><span style="color:#D19A66;">10</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.camera-btn</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    padding: </span><span style="color:#D19A66;">6</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">12</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    background: </span><span style="color:#56B6C2;">rgba</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">150</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">200</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.3</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    border: </span><span style="color:#D19A66;">1</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">solid</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">rgba</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">64</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">224</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">208</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.3</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    border-radius: </span><span style="color:#D19A66;">6</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    color: </span><span style="color:#D19A66;">#b3e5fc</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    cursor: </span><span style="color:#D19A66;">pointer</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    transition: </span><span style="color:#D19A66;">all</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0.3</span><span style="color:#E06C75;">s</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">ease</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    font-size: </span><span style="color:#D19A66;">0.85</span><span style="color:#E06C75;">rem</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.camera-btn</span><span style="color:#56B6C2;">:hover</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    background: </span><span style="color:#56B6C2;">rgba</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">200</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">255</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.5</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.camera-feed</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    flex: </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    background: </span><span style="color:#56B6C2;">linear-gradient</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">45</span><span style="color:#E06C75;">deg</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">#0a1929</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">#0d2b45</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    display: </span><span style="color:#D19A66;">flex</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    align-items: </span><span style="color:#D19A66;">center</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    justify-content: </span><span style="color:#D19A66;">center</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    position: </span><span style="color:#D19A66;">relative</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.camera-placeholder</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    display: </span><span style="color:#D19A66;">flex</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    flex-direction: </span><span style="color:#D19A66;">column</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    align-items: </span><span style="color:#D19A66;">center</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    justify-content: </span><span style="color:#D19A66;">center</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    text-align: </span><span style="color:#D19A66;">center</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    padding: </span><span style="color:#D19A66;">15</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    color: </span><span style="color:#D19A66;">#81d4fa</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.camera-placeholder</span><span style="color:#C678DD;"> </span><span style="color:#E06C75;">i</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    font-size: </span><span style="color:#D19A66;">2.5</span><span style="color:#E06C75;">rem</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    margin-bottom: </span><span style="color:#D19A66;">10</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    color: </span><span style="color:#56B6C2;">rgba</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">100</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">255</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">255</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.2</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.timestamp</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    position: </span><span style="color:#D19A66;">absolute</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    bottom: </span><span style="color:#D19A66;">10</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    right: </span><span style="color:#D19A66;">10</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    background: </span><span style="color:#56B6C2;">rgba</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.6</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    padding: </span><span style="color:#D19A66;">4</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">10</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    border-radius: </span><span style="color:#D19A66;">15</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    font-size: </span><span style="color:#D19A66;">0.75</span><span style="color:#E06C75;">rem</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    color: </span><span style="color:#D19A66;">#b2ebf2</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.status-bar</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    display: </span><span style="color:#D19A66;">flex</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    flex-wrap: </span><span style="color:#D19A66;">wrap</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    justify-content: </span><span style="color:#D19A66;">space-between</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    margin-top: </span><span style="color:#D19A66;">15</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    padding: </span><span style="color:#D19A66;">10</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    background: </span><span style="color:#56B6C2;">rgba</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">13</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">27</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">42</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.8</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    border-radius: </span><span style="color:#D19A66;">12</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    border: </span><span style="color:#D19A66;">1</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">solid</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">rgba</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">64</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">224</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">208</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.2</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    gap: </span><span style="color:#D19A66;">8</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.status-item</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    display: </span><span style="color:#D19A66;">flex</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    align-items: </span><span style="color:#D19A66;">center</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    gap: </span><span style="color:#D19A66;">6</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    min-width: </span><span style="color:#D19A66;">48</span><span style="color:#E06C75;">%</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    padding: </span><span style="color:#D19A66;">3</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.status-indicator</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    width: </span><span style="color:#D19A66;">12</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    height: </span><span style="color:#D19A66;">12</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    border-radius: </span><span style="color:#D19A66;">50</span><span style="color:#E06C75;">%</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    background: </span><span style="color:#D19A66;">#00e676</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    box-shadow: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">8</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">#00e676</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.status-indicator.offline</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    background: </span><span style="color:#D19A66;">#ff5252</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    box-shadow: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">8</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">#ff5252</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">/* 横屏优化 */</span></span>
<span class="line"><span style="color:#C678DD;">@media</span><span style="color:#ABB2BF;"> (orientation: </span><span style="color:#D19A66;">landscape</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#D19A66;">.dashboard</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">        flex-direction: </span><span style="color:#D19A66;">row</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#D19A66;">.parameters-panel</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">        max-height: </span><span style="color:#D19A66;">75</span><span style="color:#E06C75;">vh</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">/*中间左高度*/</span></span>
<span class="line"><span style="color:#ABB2BF;">        flex: </span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#D19A66;">.control-panel</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">        flex: </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">        max-height: </span><span style="color:#D19A66;">75</span><span style="color:#E06C75;">vh</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">/*中间右高度*/</span></span>
<span class="line"><span style="color:#ABB2BF;">        display: </span><span style="color:#D19A66;">flex</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">        flex-direction: </span><span style="color:#D19A66;">column</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#D19A66;">.controls-grid</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">        grid-template-columns: </span><span style="color:#56B6C2;">repeat</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">1</span><span style="color:#E06C75;">fr</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#D19A66;">.control-group</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">        padding: </span><span style="color:#D19A66;">12</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#D19A66;">.control-btn</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">        min-height: </span><span style="color:#D19A66;">auto</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">        padding: </span><span style="color:#D19A66;">10</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">5</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#D19A66;">.status-bar</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">        flex-wrap: </span><span style="color:#D19A66;">nowrap</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#D19A66;">.status-item</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">        min-width: </span><span style="color:#D19A66;">auto</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">/* 大屏幕优化 */</span></span>
<span class="line"><span style="color:#C678DD;">@media</span><span style="color:#ABB2BF;"> (min-width: </span><span style="color:#D19A66;">1200</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#D19A66;">.container</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">        max-width: </span><span style="color:#D19A66;">1200</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#D19A66;">.dashboard</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">        flex-direction: </span><span style="color:#D19A66;">row</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#D19A66;">.parameters-panel</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">        max-height: </span><span style="color:#D19A66;">75</span><span style="color:#E06C75;">vh</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">        flex: </span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#D19A66;">.control-panel</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">        flex: </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">        max-height: </span><span style="color:#D19A66;">75</span><span style="color:#E06C75;">vh</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#D19A66;">.controls-grid</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">        grid-template-columns: </span><span style="color:#56B6C2;">repeat</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">1</span><span style="color:#E06C75;">fr</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#D19A66;">.control-group</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">        padding: </span><span style="color:#D19A66;">15</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#D19A66;">.control-btn</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">        padding: </span><span style="color:#D19A66;">15</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">5</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">/* 动画效果 */</span></span>
<span class="line"><span style="color:#C678DD;">@keyframes</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;font-style:italic;">pulse</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    0% {</span></span>
<span class="line"><span style="color:#ABB2BF;">        box-shadow: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">rgba</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">230</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">118</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.4</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    70% {</span></span>
<span class="line"><span style="color:#ABB2BF;">        box-shadow: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">8</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">rgba</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">230</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">118</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    100% {</span></span>
<span class="line"><span style="color:#ABB2BF;">        box-shadow: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">rgba</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">230</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">118</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.active</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    animation: pulse </span><span style="color:#D19A66;">2</span><span style="color:#E06C75;">s</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">infinite</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">/* 滚动条优化 */</span></span>
<span class="line"><span style="color:#56B6C2;">::-webkit-scrollbar</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    width: </span><span style="color:#D19A66;">6</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    height: </span><span style="color:#D19A66;">6</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2;">::-webkit-scrollbar-track</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    background: </span><span style="color:#56B6C2;">rgba</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">13</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">27</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">42</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.5</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    border-radius: </span><span style="color:#D19A66;">6</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2;">::-webkit-scrollbar-thumb</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    background: </span><span style="color:#56B6C2;">rgba</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">64</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">224</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">208</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.5</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    border-radius: </span><span style="color:#D19A66;">6</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#56B6C2;">::-webkit-scrollbar-thumb:hover</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    background: </span><span style="color:#56B6C2;">rgba</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">64</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">224</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">208</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.8</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">#camera-video</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    width: </span><span style="color:#D19A66;">100</span><span style="color:#E06C75;">%</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    height: </span><span style="color:#D19A66;">100</span><span style="color:#E06C75;">%</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    object-fit: </span><span style="color:#D19A66;">cover</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    display: </span><span style="color:#D19A66;">none</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">/* 添加模态框样式 */</span></span>
<span class="line"><span style="color:#D19A66;">.modal-overlay</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    display: </span><span style="color:#D19A66;">none</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    position: </span><span style="color:#D19A66;">fixed</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    top: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    left: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    right: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    bottom: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    background-color: </span><span style="color:#56B6C2;">rgba</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.7</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    z-index: </span><span style="color:#D19A66;">100</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    justify-content: </span><span style="color:#D19A66;">center</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    align-items: </span><span style="color:#D19A66;">center</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.modal-container</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    width: </span><span style="color:#D19A66;">80</span><span style="color:#E06C75;">vw</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    height: </span><span style="color:#D19A66;">80</span><span style="color:#E06C75;">vh</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    background-color: </span><span style="color:#D19A66;">#fff</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    border-radius: </span><span style="color:#D19A66;">8</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    overflow: </span><span style="color:#D19A66;">hidden</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    box-shadow: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">20</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">rgba</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.3</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    display: </span><span style="color:#D19A66;">flex</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    flex-direction: </span><span style="color:#D19A66;">column</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.modal-header</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    padding: </span><span style="color:#D19A66;">10</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">15</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    background-color: </span><span style="color:#D19A66;">#2c3e50</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    color: </span><span style="color:#D19A66;">white</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    display: </span><span style="color:#D19A66;">flex</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    justify-content: </span><span style="color:#D19A66;">space-between</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    align-items: </span><span style="color:#D19A66;">center</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.modal-content</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    flex: </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    background-color: </span><span style="color:#D19A66;">black</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    position: </span><span style="color:#D19A66;">relative</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">#modal-video</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    width: </span><span style="color:#D19A66;">100</span><span style="color:#E06C75;">%</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    height: </span><span style="color:#D19A66;">100</span><span style="color:#E06C75;">%</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    object-fit: </span><span style="color:#D19A66;">contain</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.close-modal</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    background: </span><span style="color:#D19A66;">none</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    border: </span><span style="color:#D19A66;">none</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    color: </span><span style="color:#D19A66;">white</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    font-size: </span><span style="color:#D19A66;">20</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    cursor: </span><span style="color:#D19A66;">pointer</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.select-wrapper</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    position: </span><span style="color:#D19A66;">relative</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    display: </span><span style="color:#D19A66;">inline-block</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    vertical-align: </span><span style="color:#D19A66;">middle</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#7F848E;font-style:italic;">/* 让包裹层高度和按钮一致 */</span></span>
<span class="line"><span style="color:#ABB2BF;">    height: </span><span style="color:#D19A66;">36</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    max-width: </span><span style="color:#D19A66;">98</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#7F848E;font-style:italic;">/* 你需要的宽度 */</span></span>
<span class="line"><span style="color:#ABB2BF;">    user-select: </span><span style="color:#D19A66;">none</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">/* 左侧图标 */</span></span>
<span class="line"><span style="color:#D19A66;">.select-wrapper</span><span style="color:#56B6C2;">::before</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    content: </span><span style="color:#98C379;">&quot;</span><span style="color:#56B6C2;">\\f2f1</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#7F848E;font-style:italic;">/* fa-sync-alt */</span></span>
<span class="line"><span style="color:#ABB2BF;">    font-family: </span><span style="color:#98C379;">&quot;Font Awesome 6 Free&quot;</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    font-weight: </span><span style="color:#D19A66;">900</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    position: </span><span style="color:#D19A66;">absolute</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    left: </span><span style="color:#D19A66;">12</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    top: </span><span style="color:#D19A66;">50</span><span style="color:#E06C75;">%</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    transform: </span><span style="color:#56B6C2;">translateY</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">-50</span><span style="color:#E06C75;">%</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    color: </span><span style="color:#D19A66;">#b3e5fc</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    pointer-events: </span><span style="color:#D19A66;">none</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">/* 下拉框本体 */</span></span>
<span class="line"><span style="color:#D19A66;">.camera-select</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#56B6C2;">-webkit-appearance</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">none</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#56B6C2;">-moz-appearance</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">none</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    appearance: </span><span style="color:#D19A66;">none</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    background: </span><span style="color:#56B6C2;">rgba</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">150</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">200</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.3</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    border: </span><span style="color:#D19A66;">1</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">solid</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">rgba</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">64</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">224</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">208</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.3</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    border-radius: </span><span style="color:#D19A66;">6</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    color: </span><span style="color:#D19A66;">#b3e5fc</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    padding: </span><span style="color:#D19A66;">6</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">12</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">6</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">30</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#7F848E;font-style:italic;">/* 左侧图标位置预留 */</span></span>
<span class="line"><span style="color:#ABB2BF;">    font-size: </span><span style="color:#D19A66;">0.85</span><span style="color:#E06C75;">rem</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    height: </span><span style="color:#D19A66;">36</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    cursor: </span><span style="color:#D19A66;">pointer</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    box-shadow: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">6</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">rgba</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">64</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">224</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">208</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.4</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    transition: </span><span style="color:#FFFFFF;">background</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0.3</span><span style="color:#E06C75;">s</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">ease</span><span style="color:#ABB2BF;">, box-shadow </span><span style="color:#D19A66;">0.3</span><span style="color:#E06C75;">s</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">ease</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    outline: </span><span style="color:#D19A66;">none</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    width: </span><span style="color:#D19A66;">100</span><span style="color:#E06C75;">%</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">/* hover和focus效果 */</span></span>
<span class="line"><span style="color:#D19A66;">.camera-select</span><span style="color:#56B6C2;">:hover</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#D19A66;">.camera-select</span><span style="color:#56B6C2;">:focus</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    background: </span><span style="color:#56B6C2;">rgba</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">200</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">255</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.5</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    box-shadow: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">15</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">rgba</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">200</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">255</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.7</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    color: </span><span style="color:#D19A66;">#e0f7fa</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">/* 彻底隐藏默认箭头 */</span></span>
<span class="line"><span style="color:#D19A66;">.camera-select</span><span style="color:#56B6C2;">::-ms-expand</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    display: </span><span style="color:#D19A66;">none</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">/* 兼容Safari和Chrome隐藏箭头 */</span></span>
<span class="line"><span style="color:#D19A66;">.camera-select</span><span style="color:#56B6C2;">::-webkit-inner-spin-button</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#D19A66;">.camera-select</span><span style="color:#56B6C2;">::-webkit-calendar-picker-indicator</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    display: </span><span style="color:#D19A66;">none</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.camera-select</span><span style="color:#56B6C2;">::-webkit-dropdown-arrow</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    display: </span><span style="color:#D19A66;">none</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">/* 监控室模态框样式 */</span></span>
<span class="line"><span style="color:#D19A66;">.monitor-room</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    width: </span><span style="color:#D19A66;">90</span><span style="color:#E06C75;">vw</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    height: </span><span style="color:#D19A66;">90</span><span style="color:#E06C75;">vh</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    max-width: </span><span style="color:#D19A66;">1400</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    display: </span><span style="color:#D19A66;">flex</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#7F848E;font-style:italic;">/* 新增 */</span></span>
<span class="line"><span style="color:#ABB2BF;">    flex-direction: </span><span style="color:#D19A66;">column</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#7F848E;font-style:italic;">/* 新增 */</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.modal-header</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    flex-shrink: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#7F848E;font-style:italic;">/* 新增 - 防止标题栏被压缩 */</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.modal-content</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    flex: </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#7F848E;font-style:italic;">/* 新增 - 填充剩余空间 */</span></span>
<span class="line"><span style="color:#ABB2BF;">    overflow-y: </span><span style="color:#D19A66;">auto</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#7F848E;font-style:italic;">/* 新增 - 垂直滚动 */</span></span>
<span class="line"><span style="color:#ABB2BF;">    padding: </span><span style="color:#D19A66;">10</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    background: </span><span style="color:#D19A66;">#111</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.monitor-grid</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    display: </span><span style="color:#D19A66;">grid</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    grid-template-columns: </span><span style="color:#56B6C2;">repeat</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">1</span><span style="color:#E06C75;">fr</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    grid-template-rows: </span><span style="color:#56B6C2;">repeat</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">1</span><span style="color:#E06C75;">fr</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    gap: </span><span style="color:#D19A66;">10</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    width: </span><span style="color:#D19A66;">100</span><span style="color:#E06C75;">%</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    min-height: </span><span style="color:#D19A66;">min-content</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#7F848E;font-style:italic;">/* 新增 - 确保网格有足够高度 */</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#7F848E;font-style:italic;">/* 移除 height: 100% - 让内容决定高度 */</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.monitor-title</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    position: </span><span style="color:#D19A66;">absolute</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    top: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    left: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    right: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    background: </span><span style="color:#56B6C2;">rgba</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.7</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    color: </span><span style="color:#D19A66;">white</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    padding: </span><span style="color:#D19A66;">5</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">10</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    font-size: </span><span style="color:#D19A66;">14</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    z-index: </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.monitor-frame</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    width: </span><span style="color:#D19A66;">100</span><span style="color:#E06C75;">%</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    height: </span><span style="color:#D19A66;">100</span><span style="color:#E06C75;">%</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    object-fit: </span><span style="color:#D19A66;">cover</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.monitor-item</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    background: </span><span style="color:#D19A66;">#222</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    border-radius: </span><span style="color:#D19A66;">5</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    overflow: </span><span style="color:#D19A66;">hidden</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    position: </span><span style="color:#D19A66;">relative</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    box-shadow: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">10</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">rgba</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.5</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    aspect-ratio: </span><span style="color:#D19A66;">16</span><span style="color:#ABB2BF;">/</span><span style="color:#D19A66;">9</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#7F848E;font-style:italic;">/* 新增 - 保持视频比例 */</span></span>
<span class="line"><span style="color:#ABB2BF;">    min-height: </span><span style="color:#D19A66;">200</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#7F848E;font-style:italic;">/* 新增 - 最小高度 */</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">/* 自定义滚动条样式 */</span></span>
<span class="line"><span style="color:#D19A66;">.modal-content</span><span style="color:#56B6C2;">::-webkit-scrollbar</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    width: </span><span style="color:#D19A66;">8</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.modal-content</span><span style="color:#56B6C2;">::-webkit-scrollbar-track</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    background: </span><span style="color:#56B6C2;">rgba</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">13</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">27</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">42</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.5</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    border-radius: </span><span style="color:#D19A66;">4</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.modal-content</span><span style="color:#56B6C2;">::-webkit-scrollbar-thumb</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    background: </span><span style="color:#56B6C2;">rgba</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">64</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">224</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">208</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.5</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">    border-radius: </span><span style="color:#D19A66;">4</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">.modal-content</span><span style="color:#56B6C2;">::-webkit-scrollbar-thumb:hover</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    background: </span><span style="color:#56B6C2;">rgba</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">64</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">224</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">208</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">0.8</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;">/* 响应式调整 */</span></span>
<span class="line"><span style="color:#C678DD;">@media</span><span style="color:#ABB2BF;"> (max-width: </span><span style="color:#D19A66;">768</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">) {</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#D19A66;">.monitor-grid</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">        grid-template-columns: </span><span style="color:#D19A66;">1</span><span style="color:#E06C75;">fr</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">        grid-template-rows: </span><span style="color:#D19A66;">unset</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">/* 改为自动高度 */</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#D19A66;">.monitor-item</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">        min-height: </span><span style="color:#D19A66;">180</span><span style="color:#E06C75;">px</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;">/* 调整移动端最小高度 */</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_4、配置文件-config-js" tabindex="-1"><a class="header-anchor" href="#_4、配置文件-config-js" aria-hidden="true">#</a> 4、配置文件 | config.js</h4><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;">// config.js</span></span>
<span class="line"><span style="color:#C678DD;">const</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">AppConfig</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#7F848E;font-style:italic;">//  API_BASE_URL: &quot;http://10.51.251.202:5000&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;">API_BASE_URL</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;http://192.168.43.146:5000&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#7F848E;font-style:italic;">// API_BASE_URL: &quot;http://127.0.0.1:5000&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#7F848E;font-style:italic;">// API_BASE_URL: &quot;http://192.168.1.21:5000&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">};</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="运行页面" tabindex="-1"><a class="header-anchor" href="#运行页面" aria-hidden="true">#</a> 运行页面</h3><p>右键index.html，点击Open with Live Server</p><img src="`+ln+'" width="600">',30),Vl={href:"http://127.0.0.1:5500/index.html",target:"_blank",rel:"noopener noreferrer"},Hl=p('<img src="'+pn+'" width="800"><h2 id="六、ai小农开发" tabindex="-1"><a class="header-anchor" href="#六、ai小农开发" aria-hidden="true">#</a> 六、AI小农开发</h2><h3 id="配置ai小农" tabindex="-1"><a class="header-anchor" href="#配置ai小农" aria-hidden="true">#</a> 配置AI小农</h3><h4 id="_1、首次配网" tabindex="-1"><a class="header-anchor" href="#_1、首次配网" aria-hidden="true">#</a> 1、首次配网</h4><p><strong>请提供稳定2.4G的wifi网络</strong></p><p>系统通电</p><img src="'+on+'" width="600"><p>连接设备发出的WIFI信号</p><img src="'+en+'" width="600"><p>自动跳转到192.168.4.1地址，输入需要链接的wifi信息，连接</p><img src="'+tn+'" width="600"><p>等待设备重启</p><img src="'+cn+'" width="600"><p>设备显示 <strong>服务地址</strong> 及 <strong>验证码</strong></p><img src="'+Bn+'" width="600"><h4 id="_2、添加设备" tabindex="-1"><a class="header-anchor" href="#_2、添加设备" aria-hidden="true">#</a> 2、添加设备</h4>',16),Gl={href:"https://xiaozhi.me",target:"_blank",rel:"noopener noreferrer"},Wl=p('<img src="'+rn+'" width="600"><p>选择新建智能体--&gt;小农</p><img src="'+yn+'" width="600"><img src="'+An+'" width="600"><p>选择添加设备--&gt;填入验证码</p><img src="'+dn+'" width="600"><img src="'+Fn+'" width="600"><p>设备添加成功</p><img src="'+vn+'" width="600"><h4 id="_3、配置角色" tabindex="-1"><a class="header-anchor" href="#_3、配置角色" aria-hidden="true">#</a> 3、配置角色</h4><p>选择配置角色</p><img src="'+un+'" width="600"><p>填写角色信息</p><img src="'+mn+'" width="600"><p>保存和获取MCP接入点</p><img src="'+Cn+'" width="600"><h3 id="环境搭建-2" tabindex="-1"><a class="header-anchor" href="#环境搭建-2" aria-hidden="true">#</a> 环境搭建</h3><h4 id="_1、开发工具-2" tabindex="-1"><a class="header-anchor" href="#_1、开发工具-2" aria-hidden="true">#</a> 1、开发工具</h4><ul><li>Python 3.12</li><li>PyCharm 2021.3.1</li></ul><h4 id="_2、项目结构-2" tabindex="-1"><a class="header-anchor" href="#_2、项目结构-2" aria-hidden="true">#</a> 2、项目结构</h4><img src="'+Dn+`" width="600"><h3 id="接口开发-1" tabindex="-1"><a class="header-anchor" href="#接口开发-1" aria-hidden="true">#</a> 接口开发</h3><h4 id="_1、项目依赖-requirements-txt-1" tabindex="-1"><a class="header-anchor" href="#_1、项目依赖-requirements-txt-1" aria-hidden="true">#</a> 1、项目依赖 | requirements.txt</h4><div class="language-tex line-numbers-mode" data-ext="tex"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#ABB2BF;">python-dotenv&gt;=1.0.0</span></span>
<span class="line"><span style="color:#ABB2BF;">websockets&gt;=11.0.3 </span></span>
<span class="line"><span style="color:#ABB2BF;">mcp&gt;=1.8.1</span></span>
<span class="line"><span style="color:#ABB2BF;">pydantic&gt;=2.11.4</span></span>
<span class="line"><span style="color:#ABB2BF;">PyYAML~=6.0.2</span></span>
<span class="line"><span style="color:#ABB2BF;">requests~=2.31.0</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_2、配置文件-config-yaml-1" tabindex="-1"><a class="header-anchor" href="#_2、配置文件-config-yaml-1" aria-hidden="true">#</a> 2、配置文件 | config.yaml</h4><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#E06C75;">device_url</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;http://127.0.0.1:5000&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># 小智后台MCP地址</span></span>
<span class="line"><span style="color:#E06C75;">xiaozhi_mcp</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;wss://api.xiaozhi.me/mcp/?token=eyJh********2g&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,26),zl={id:"_3、主程序-main-py-1",tabindex:"-1"},Kl=s("a",{class:"header-anchor",href:"#_3、主程序-main-py-1","aria-hidden":"true"},"#",-1),Yl={href:"http://main.py",target:"_blank",rel:"noopener noreferrer"},Xl=p(`<div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#7F848E;font-style:italic;"># server.py</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> mcp.server.fastmcp </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> FastMCP</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> sys</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> logging</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> requests</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> utils.configUtils </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">BASE_URL</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">logger </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> logging.</span><span style="color:#61AFEF;">getLogger</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;WaterOxygenService&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># Fix UTF-8 encoding for Windows console</span></span>
<span class="line"><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> sys.platform </span><span style="color:#56B6C2;">==</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&#39;win32&#39;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">    sys.stderr.</span><span style="color:#61AFEF;">reconfigure</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">encoding</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;utf-8&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    sys.stdout.</span><span style="color:#61AFEF;">reconfigure</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">encoding</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;utf-8&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># Create MCP server</span></span>
<span class="line"><span style="color:#ABB2BF;">mcp </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">FastMCP</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;WaterOxygenService&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># 工具：数学计算（保留原功能）</span></span>
<span class="line"><span style="color:#61AFEF;">@mcp</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">tool</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">calculator</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">python_expression</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">) -&gt; </span><span style="color:#56B6C2;">dict</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#98C379;">&quot;&quot;&quot;用于数学表达式计算，可使用 math 和 random 模块&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> math, random</span></span>
<span class="line"><span style="color:#ABB2BF;">    result </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">eval</span><span style="color:#ABB2BF;">(python_expression)</span></span>
<span class="line"><span style="color:#ABB2BF;">    logger.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;Calculating: </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">python_expression</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> = </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">result</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> {</span><span style="color:#98C379;">&quot;success&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;result&quot;</span><span style="color:#ABB2BF;">: result}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># 工具：获取水质溶解氧浓度</span></span>
<span class="line"><span style="color:#61AFEF;">@mcp</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">tool</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">get_water_oxygen</span><span style="color:#ABB2BF;">() -&gt; </span><span style="color:#56B6C2;">dict</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#98C379;">&quot;&quot;&quot;查询当前水体溶解氧浓度&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        response </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> requests.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">{BASE_URL}</span><span style="color:#98C379;">/api/waterOxyNow&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">timeout</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> response.status_code </span><span style="color:#56B6C2;">==</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">200</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            json_data </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> response.</span><span style="color:#61AFEF;">json</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">            value </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> json_data.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;data&quot;</span><span style="color:#ABB2BF;">, {}).</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;data&quot;</span><span style="color:#ABB2BF;">, [])[</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">].</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;value&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#98C379;">&quot;success&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#98C379;">&quot;value&quot;</span><span style="color:#ABB2BF;">: value,</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#98C379;">&quot;unit&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;mg/L&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#98C379;">&quot;timestamp&quot;</span><span style="color:#ABB2BF;">: json_data.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;data&quot;</span><span style="color:#ABB2BF;">, {}).</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;createTime&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">            }</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> {</span><span style="color:#98C379;">&quot;success&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">False</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;error&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;HTTP </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">response.status_code</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> {</span><span style="color:#98C379;">&quot;success&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">False</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;error&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">(e)}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">@mcp</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">tool</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">control_device</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">area</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">action</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">) -&gt; </span><span style="color:#56B6C2;">dict</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#98C379;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">    控制农田设备的开关操作，如增氧、除虫、抽水等。</span></span>
<span class="line"><span style="color:#98C379;">    参数:</span></span>
<span class="line"><span style="color:#98C379;">    - area: 地区，如 &quot;东区增氧&quot;, &quot;西区抽水&quot;</span></span>
<span class="line"><span style="color:#98C379;">    - action: 动作，&quot;打开&quot; 或 &quot;关闭&quot;</span></span>
<span class="line"><span style="color:#98C379;">    &quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#7F848E;font-style:italic;"># 区域+设备到 pin 的映射</span></span>
<span class="line"><span style="color:#ABB2BF;">    pin_map </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#98C379;">&quot;东区增氧&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;V3&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#98C379;">&quot;西区增氧&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;V4&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#98C379;">&quot;东区除虫&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;V5&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#98C379;">&quot;西区除虫&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;V6&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#98C379;">&quot;东区抽水&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;V7&quot;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#98C379;">&quot;西区抽水&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;V8&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#7F848E;font-style:italic;"># 动作到状态的映射</span></span>
<span class="line"><span style="color:#ABB2BF;">    state_map </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#98C379;">&quot;打开&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#98C379;">&quot;开启&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#98C379;">&quot;开&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#98C379;">&quot;关闭&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#98C379;">&quot;关&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">0</span></span>
<span class="line"><span style="color:#ABB2BF;">    }</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#7F848E;font-style:italic;"># 匹配指令</span></span>
<span class="line"><span style="color:#ABB2BF;">    pin </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> pin_map.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(area)</span></span>
<span class="line"><span style="color:#ABB2BF;">    state </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> state_map.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(action)</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> pin </span><span style="color:#C678DD;">is</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">or</span><span style="color:#ABB2BF;"> state </span><span style="color:#C678DD;">is</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> {</span><span style="color:#98C379;">&quot;success&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">False</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;error&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;无效的区域或动作参数&quot;</span><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    url </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">{BASE_URL}</span><span style="color:#98C379;">/api/execute?pin=</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">pin</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&amp;state=</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">state</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        response </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> requests.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(url, </span><span style="color:#E06C75;font-style:italic;">timeout</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> response.status_code </span><span style="color:#56B6C2;">==</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">200</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#98C379;">&quot;success&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#98C379;">&quot;area&quot;</span><span style="color:#ABB2BF;">: area,</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#98C379;">&quot;action&quot;</span><span style="color:#ABB2BF;">: action,</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#98C379;">&quot;pin&quot;</span><span style="color:#ABB2BF;">: pin,</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#98C379;">&quot;state&quot;</span><span style="color:#ABB2BF;">: state,</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#98C379;">&quot;message&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#98C379;">&quot;执行成功&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">            }</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">else</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> {</span><span style="color:#98C379;">&quot;success&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">False</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;error&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;HTTP </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">response.status_code</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">}</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> {</span><span style="color:#98C379;">&quot;success&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#D19A66;">False</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;error&quot;</span><span style="color:#ABB2BF;">: </span><span style="color:#56B6C2;">str</span><span style="color:#ABB2BF;">(e)}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># 启动 MCP 服务（通过 stdio 与 mcp_pipe.py 通信）</span></span>
<span class="line"><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">__name__</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">==</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;__main__&quot;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">    mcp.</span><span style="color:#61AFEF;">run</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">transport</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&quot;stdio&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),Jl={id:"_4、全局配置获取-configutils-py",tabindex:"-1"},$l=s("a",{class:"header-anchor",href:"#_4、全局配置获取-configutils-py","aria-hidden":"true"},"#",-1),Zl={href:"http://configUtils.py",target:"_blank",rel:"noopener noreferrer"},Ql=p(`<div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> yaml</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> os</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">load_base_url</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#ABB2BF;">    config_path </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(os.path.</span><span style="color:#61AFEF;">dirname</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">__file__</span><span style="color:#ABB2BF;">), </span><span style="color:#98C379;">&#39;../config.yaml&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">with</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">open</span><span style="color:#ABB2BF;">(config_path, </span><span style="color:#98C379;">&#39;r&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">encoding</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;utf-8&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> f:</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> yaml.</span><span style="color:#61AFEF;">safe_load</span><span style="color:#ABB2BF;">(f).</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;device_url&quot;</span><span style="color:#ABB2BF;">, </span><span style="color:#98C379;">&quot;http://127.0.0.1:5000&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">BASE_URL</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">load_base_url</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">load_mcp_endpoint</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#ABB2BF;">    config_path </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">join</span><span style="color:#ABB2BF;">(os.path.</span><span style="color:#61AFEF;">dirname</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;">__file__</span><span style="color:#ABB2BF;">), </span><span style="color:#98C379;">&#39;../config.yaml&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> os.path.</span><span style="color:#61AFEF;">exists</span><span style="color:#ABB2BF;">(config_path):</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">with</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">open</span><span style="color:#ABB2BF;">(config_path, </span><span style="color:#98C379;">&#39;r&#39;</span><span style="color:#ABB2BF;">, </span><span style="color:#E06C75;font-style:italic;">encoding</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;utf-8&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> f:</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#C678DD;">return</span><span style="color:#ABB2BF;"> yaml.</span><span style="color:#61AFEF;">safe_load</span><span style="color:#ABB2BF;">(f).</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;xiaozhi_mcp&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#D19A66;">MCP_URL</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">load_mcp_endpoint</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_5、mcp服务桥接-mcp-pipe-py" tabindex="-1"><a class="header-anchor" href="#_5、mcp服务桥接-mcp-pipe-py" aria-hidden="true">#</a> 5、MCP服务桥接 | mcp_pipe.py</h4><div class="language-python line-numbers-mode" data-ext="py"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#98C379;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#98C379;">This script is used to connect to the MCP server and pipe the input and output to the websocket endpoint.</span></span>
<span class="line"><span style="color:#98C379;">Version: 0.1.0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#98C379;">Usage:</span></span>
<span class="line"></span>
<span class="line"><span style="color:#98C379;">export MCP_ENDPOINT=&lt;mcp_endpoint&gt;</span></span>
<span class="line"><span style="color:#98C379;">python mcp_pipe.py &lt;mcp_script&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#98C379;">&quot;&quot;&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> asyncio</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> websockets</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> subprocess</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> logging</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> os</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> signal</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> sys</span></span>
<span class="line"><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> random</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> dotenv </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> load_dotenv</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># Load environment variables from .env file</span></span>
<span class="line"><span style="color:#C678DD;">from</span><span style="color:#ABB2BF;"> utils.configUtils </span><span style="color:#C678DD;">import</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">MCP_URL</span></span>
<span class="line"></span>
<span class="line"><span style="color:#61AFEF;">load_dotenv</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># Configure logging</span></span>
<span class="line"><span style="color:#ABB2BF;">logging.</span><span style="color:#61AFEF;">basicConfig</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;font-style:italic;">level</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">logging.</span><span style="color:#D19A66;">INFO</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#E06C75;font-style:italic;">format</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;</span><span style="color:#D19A66;">%(asctime)s</span><span style="color:#98C379;"> - </span><span style="color:#D19A66;">%(name)s</span><span style="color:#98C379;"> - </span><span style="color:#D19A66;">%(levelname)s</span><span style="color:#98C379;"> - </span><span style="color:#D19A66;">%(message)s</span><span style="color:#98C379;">&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">logger </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> logging.</span><span style="color:#61AFEF;">getLogger</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;MCP_PIPE&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#7F848E;font-style:italic;"># Reconnection settings</span></span>
<span class="line"><span style="color:#D19A66;">INITIAL_BACKOFF</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">  </span><span style="color:#7F848E;font-style:italic;"># Initial wait time in seconds</span></span>
<span class="line"><span style="color:#D19A66;">MAX_BACKOFF</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">600</span><span style="color:#ABB2BF;">  </span><span style="color:#7F848E;font-style:italic;"># Maximum wait time in seconds</span></span>
<span class="line"><span style="color:#ABB2BF;">reconnect_attempt </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span></span>
<span class="line"><span style="color:#ABB2BF;">backoff </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">INITIAL_BACKOFF</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">async</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">def</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">connect_with_retry</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">uri</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#98C379;">&quot;&quot;&quot;Connect to WebSocket server with retry mechanism&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">global</span><span style="color:#ABB2BF;"> reconnect_attempt, backoff</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">while</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">:  </span><span style="color:#7F848E;font-style:italic;"># Infinite reconnection</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> reconnect_attempt </span><span style="color:#56B6C2;">&gt;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                wait_time </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> backoff </span><span style="color:#56B6C2;">*</span><span style="color:#ABB2BF;"> (</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> random.</span><span style="color:#61AFEF;">random</span><span style="color:#ABB2BF;">() </span><span style="color:#56B6C2;">*</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0.1</span><span style="color:#ABB2BF;">)  </span><span style="color:#7F848E;font-style:italic;"># Add some random jitter</span></span>
<span class="line"><span style="color:#ABB2BF;">                logger.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;Waiting </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">wait_time</span><span style="color:#C678DD;">:.2f</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> seconds before reconnection attempt </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">reconnect_attempt</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">...&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#C678DD;">await</span><span style="color:#ABB2BF;"> asyncio.</span><span style="color:#61AFEF;">sleep</span><span style="color:#ABB2BF;">(wait_time)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;"># Attempt to connect</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#C678DD;">await</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">connect_to_server</span><span style="color:#ABB2BF;">(uri)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#ABB2BF;">            reconnect_attempt </span><span style="color:#56B6C2;">+=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">1</span></span>
<span class="line"><span style="color:#ABB2BF;">            logger.</span><span style="color:#61AFEF;">warning</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;Connection closed (attempt: </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">reconnect_attempt</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">): </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">e</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;"># Calculate wait time for next reconnection (exponential backoff)</span></span>
<span class="line"><span style="color:#ABB2BF;">            backoff </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">min</span><span style="color:#ABB2BF;">(backoff </span><span style="color:#56B6C2;">*</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">MAX_BACKOFF</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">async</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">def</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">connect_to_server</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">uri</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#98C379;">&quot;&quot;&quot;Connect to WebSocket server and establish bidirectional communication with \`mcp_script\`&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">global</span><span style="color:#ABB2BF;"> reconnect_attempt, backoff</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        logger.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;Connecting to WebSocket server...&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">async</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">with</span><span style="color:#ABB2BF;"> websockets.</span><span style="color:#61AFEF;">connect</span><span style="color:#ABB2BF;">(uri) </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> websocket:</span></span>
<span class="line"><span style="color:#ABB2BF;">            logger.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;Successfully connected to WebSocket server&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;"># Reset reconnection counter if connection closes normally</span></span>
<span class="line"><span style="color:#ABB2BF;">            reconnect_attempt </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">0</span></span>
<span class="line"><span style="color:#ABB2BF;">            backoff </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">INITIAL_BACKOFF</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;"># Start mcp_script process</span></span>
<span class="line"><span style="color:#ABB2BF;">            process </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> subprocess.</span><span style="color:#61AFEF;">Popen</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                [</span><span style="color:#98C379;">&#39;python&#39;</span><span style="color:#ABB2BF;">, mcp_script],</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#E06C75;font-style:italic;">stdin</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">subprocess.</span><span style="color:#D19A66;">PIPE</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#E06C75;font-style:italic;">stdout</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">subprocess.</span><span style="color:#D19A66;">PIPE</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#E06C75;font-style:italic;">stderr</span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;">subprocess.</span><span style="color:#D19A66;">PIPE</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#E06C75;font-style:italic;">encoding</span><span style="color:#56B6C2;">=</span><span style="color:#98C379;">&#39;utf-8&#39;</span><span style="color:#ABB2BF;">,</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#E06C75;font-style:italic;">text</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">  </span><span style="color:#7F848E;font-style:italic;"># Use text mode</span></span>
<span class="line"><span style="color:#ABB2BF;">            )</span></span>
<span class="line"><span style="color:#ABB2BF;">            logger.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;Started </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">mcp_script</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> process&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;"># Create two tasks: read from WebSocket and write to process, read from process and write to WebSocket</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#C678DD;">await</span><span style="color:#ABB2BF;"> asyncio.</span><span style="color:#61AFEF;">gather</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#61AFEF;">pipe_websocket_to_process</span><span style="color:#ABB2BF;">(websocket, process),</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#61AFEF;">pipe_process_to_websocket</span><span style="color:#ABB2BF;">(process, websocket),</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#61AFEF;">pipe_process_stderr_to_terminal</span><span style="color:#ABB2BF;">(process)</span></span>
<span class="line"><span style="color:#ABB2BF;">            )</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">except</span><span style="color:#ABB2BF;"> websockets.exceptions.ConnectionClosed </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#ABB2BF;">        logger.</span><span style="color:#61AFEF;">error</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;WebSocket connection closed: </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">e</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">raise</span><span style="color:#ABB2BF;">  </span><span style="color:#7F848E;font-style:italic;"># Re-throw exception to trigger reconnection</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#ABB2BF;">        logger.</span><span style="color:#61AFEF;">error</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;Connection error: </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">e</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">raise</span><span style="color:#ABB2BF;">  </span><span style="color:#7F848E;font-style:italic;"># Re-throw exception</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">finally</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;"># Ensure the child process is properly terminated</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&#39;process&#39;</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">in</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">locals</span><span style="color:#ABB2BF;">():</span></span>
<span class="line"><span style="color:#ABB2BF;">            logger.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;Terminating </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">mcp_script</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> process&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#C678DD;">try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">                process.</span><span style="color:#61AFEF;">terminate</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">                process.</span><span style="color:#61AFEF;">wait</span><span style="color:#ABB2BF;">(</span><span style="color:#E06C75;font-style:italic;">timeout</span><span style="color:#56B6C2;">=</span><span style="color:#D19A66;">5</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#C678DD;">except</span><span style="color:#ABB2BF;"> subprocess.TimeoutExpired:</span></span>
<span class="line"><span style="color:#ABB2BF;">                process.</span><span style="color:#61AFEF;">kill</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">            logger.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;</span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">mcp_script</span><span style="color:#D19A66;">}</span><span style="color:#98C379;"> process terminated&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">async</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">def</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">pipe_websocket_to_process</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">websocket</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">process</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#98C379;">&quot;&quot;&quot;Read data from WebSocket and write to process stdin&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">while</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;"># Read message from WebSocket</span></span>
<span class="line"><span style="color:#ABB2BF;">            message </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">await</span><span style="color:#ABB2BF;"> websocket.</span><span style="color:#61AFEF;">recv</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">            logger.</span><span style="color:#61AFEF;">debug</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;&lt;&lt; </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">message[:</span><span style="color:#D19A66;">120</span><span style="color:#ABB2BF;">]</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">...&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;"># Write to process stdin (in text mode)</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">isinstance</span><span style="color:#ABB2BF;">(message, </span><span style="color:#56B6C2;">bytes</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">                message </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> message.</span><span style="color:#61AFEF;">decode</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;utf-8&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">            process.stdin.</span><span style="color:#61AFEF;">write</span><span style="color:#ABB2BF;">(message </span><span style="color:#56B6C2;">+</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&#39;</span><span style="color:#56B6C2;">\\n</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">            process.stdin.</span><span style="color:#61AFEF;">flush</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#ABB2BF;">        logger.</span><span style="color:#61AFEF;">error</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;Error in WebSocket to process pipe: </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">e</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">raise</span><span style="color:#ABB2BF;">  </span><span style="color:#7F848E;font-style:italic;"># Re-throw exception to trigger reconnection</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">finally</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#7F848E;font-style:italic;"># Close process stdin</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">not</span><span style="color:#ABB2BF;"> process.stdin.closed:</span></span>
<span class="line"><span style="color:#ABB2BF;">            process.stdin.</span><span style="color:#61AFEF;">close</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">async</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">def</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">pipe_process_to_websocket</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">process</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">websocket</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#98C379;">&quot;&quot;&quot;Read data from process stdout and send to WebSocket&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">while</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;"># Read data from process stdout</span></span>
<span class="line"><span style="color:#ABB2BF;">            data </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">await</span><span style="color:#ABB2BF;"> asyncio.</span><span style="color:#61AFEF;">get_event_loop</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">run_in_executor</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;">, process.stdout.readline</span></span>
<span class="line"><span style="color:#ABB2BF;">            )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">not</span><span style="color:#ABB2BF;"> data:  </span><span style="color:#7F848E;font-style:italic;"># If no data, the process may have ended</span></span>
<span class="line"><span style="color:#ABB2BF;">                logger.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Process has ended output&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#C678DD;">break</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;"># Send data to WebSocket</span></span>
<span class="line"><span style="color:#ABB2BF;">            logger.</span><span style="color:#61AFEF;">debug</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;&gt;&gt; </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">data[:</span><span style="color:#D19A66;">120</span><span style="color:#ABB2BF;">]</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">...&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;"># In text mode, data is already a string, no need to decode</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#C678DD;">await</span><span style="color:#ABB2BF;"> websocket.</span><span style="color:#61AFEF;">send</span><span style="color:#ABB2BF;">(data)</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#ABB2BF;">        logger.</span><span style="color:#61AFEF;">error</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;Error in process to WebSocket pipe: </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">e</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">raise</span><span style="color:#ABB2BF;">  </span><span style="color:#7F848E;font-style:italic;"># Re-throw exception to trigger reconnection</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">async</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">def</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">pipe_process_stderr_to_terminal</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">process</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#98C379;">&quot;&quot;&quot;Read data from process stderr and print to terminal&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">while</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">True</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;"># Read data from process stderr</span></span>
<span class="line"><span style="color:#ABB2BF;">            data </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">await</span><span style="color:#ABB2BF;"> asyncio.</span><span style="color:#61AFEF;">get_event_loop</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">run_in_executor</span><span style="color:#ABB2BF;">(</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#D19A66;">None</span><span style="color:#ABB2BF;">, process.stderr.readline</span></span>
<span class="line"><span style="color:#ABB2BF;">            )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">not</span><span style="color:#ABB2BF;"> data:  </span><span style="color:#7F848E;font-style:italic;"># If no data, the process may have ended</span></span>
<span class="line"><span style="color:#ABB2BF;">                logger.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Process has ended stderr output&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">                </span><span style="color:#C678DD;">break</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">            </span><span style="color:#7F848E;font-style:italic;"># Print stderr data to terminal (in text mode, data is already a string)</span></span>
<span class="line"><span style="color:#ABB2BF;">            sys.stderr.</span><span style="color:#61AFEF;">write</span><span style="color:#ABB2BF;">(data)</span></span>
<span class="line"><span style="color:#ABB2BF;">            sys.stderr.</span><span style="color:#61AFEF;">flush</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#ABB2BF;">        logger.</span><span style="color:#61AFEF;">error</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;Error in process stderr pipe: </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">e</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        </span><span style="color:#C678DD;">raise</span><span style="color:#ABB2BF;">  </span><span style="color:#7F848E;font-style:italic;"># Re-throw exception to trigger reconnection</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">def</span><span style="color:#ABB2BF;"> </span><span style="color:#61AFEF;">signal_handler</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;font-style:italic;">sig</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;font-style:italic;">frame</span><span style="color:#ABB2BF;">):</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#98C379;">&quot;&quot;&quot;Handle interrupt signals&quot;&quot;&quot;</span></span>
<span class="line"><span style="color:#ABB2BF;">    logger.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Received interrupt signal, shutting down...&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    sys.</span><span style="color:#61AFEF;">exit</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">0</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> </span><span style="color:#E06C75;">__name__</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">==</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&quot;__main__&quot;</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#7F848E;font-style:italic;"># Register signal handler</span></span>
<span class="line"><span style="color:#ABB2BF;">    signal.</span><span style="color:#61AFEF;">signal</span><span style="color:#ABB2BF;">(signal.</span><span style="color:#D19A66;">SIGINT</span><span style="color:#ABB2BF;">, signal_handler)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#7F848E;font-style:italic;"># mcp_script</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> </span><span style="color:#56B6C2;">len</span><span style="color:#ABB2BF;">(sys.argv) </span><span style="color:#56B6C2;">&lt;</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        logger.</span><span style="color:#61AFEF;">error</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Usage: mcp_pipe.py &lt;mcp_script&gt;&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        sys.</span><span style="color:#61AFEF;">exit</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    mcp_script </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> sys.argv[</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#7F848E;font-style:italic;"># Get token from environment variable or command line arguments</span></span>
<span class="line"><span style="color:#ABB2BF;">    endpoint_url </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> os.environ.</span><span style="color:#61AFEF;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;MCP_ENDPOINT&#39;</span><span style="color:#ABB2BF;">) </span><span style="color:#C678DD;">or</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">MCP_URL</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">if</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">not</span><span style="color:#ABB2BF;"> endpoint_url:</span></span>
<span class="line"><span style="color:#ABB2BF;">        logger.</span><span style="color:#61AFEF;">error</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;MCP endpoint not found. Please set it in environment variable MCP_ENDPOINT or config.yaml.&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">        sys.</span><span style="color:#61AFEF;">exit</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#7F848E;font-style:italic;"># Start main loop</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">try</span><span style="color:#ABB2BF;">:</span></span>
<span class="line"><span style="color:#ABB2BF;">        asyncio.</span><span style="color:#61AFEF;">run</span><span style="color:#ABB2BF;">(</span><span style="color:#61AFEF;">connect_with_retry</span><span style="color:#ABB2BF;">(endpoint_url))</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">except</span><span style="color:#ABB2BF;"> KeyboardInterrupt:</span></span>
<span class="line"><span style="color:#ABB2BF;">        logger.</span><span style="color:#61AFEF;">info</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&quot;Program interrupted by user&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    </span><span style="color:#C678DD;">except</span><span style="color:#ABB2BF;"> Exception </span><span style="color:#C678DD;">as</span><span style="color:#ABB2BF;"> e:</span></span>
<span class="line"><span style="color:#ABB2BF;">        logger.</span><span style="color:#61AFEF;">error</span><span style="color:#ABB2BF;">(</span><span style="color:#C678DD;">f</span><span style="color:#98C379;">&quot;Program execution error: </span><span style="color:#D19A66;">{</span><span style="color:#ABB2BF;">e</span><span style="color:#D19A66;">}</span><span style="color:#98C379;">&quot;</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="程序运行-cmd运行" tabindex="-1"><a class="header-anchor" href="#程序运行-cmd运行" aria-hidden="true">#</a> 程序运行 | CMD运行</h3><h4 id="_1、安装依赖" tabindex="-1"><a class="header-anchor" href="#_1、安装依赖" aria-hidden="true">#</a> 1、安装依赖:</h4><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">pip</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">install</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">-r</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">requirements.txt</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><img src="`+bn+`" width="800"><h4 id="_2、运行" tabindex="-1"><a class="header-anchor" href="#_2、运行" aria-hidden="true">#</a> 2、运行</h4><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="shiki one-dark-pro" style="background-color:#282c34;" tabindex="0"><code><span class="line"><span style="color:#61AFEF;">python</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">mcp_pipe.py</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">server.py</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><img src="`+En+'" width="800"><h2 id="七、成果实景" tabindex="-1"><a class="header-anchor" href="#七、成果实景" aria-hidden="true">#</a> 七、成果实景</h2><div style="display:flex;justify-content:center;gap:10px;margin-bottom:10px;"><img src="'+gn+'" width="450"><img src="'+hn+'" width="450"></div><div style="display:flex;justify-content:center;gap:10px;margin-bottom:10px;"><img src="'+fn+'" width="450"><img src="'+qn+'" width="450"></div><div style="display:flex;justify-content:center;gap:10px;margin-bottom:10px;"><img src="'+_n+'" width="450"><img src="'+xn+'" width="450"></div><div style="display:flex;justify-content:center;gap:10px;margin-bottom:10px;"><img src="'+wn+'" width="450"><img src="'+Sn+'" width="450"></div><div style="display:flex;justify-content:center;gap:10px;margin-bottom:10px;"><img src="'+kn+'" width="450"><img src="'+Pn+'" width="450"></div><div style="display:flex;justify-content:center;gap:10px;margin-bottom:10px;"><img src="'+In+'" width="450"><img src="'+Tn+'" width="450"></div><div style="display:flex;justify-content:center;gap:10px;margin-bottom:10px;"><img src="'+Ln+'" width="450"><img src="'+Rn+'" width="450"></div><div style="display:flex;justify-content:center;gap:10px;margin-bottom:10px;"><img src="'+Nn+'" width="450"><img src="'+On+'" width="450"></div><div style="display:flex;justify-content:center;gap:10px;margin-bottom:10px;"><img src="'+Mn+'" width="450"><img src="'+jn+'" width="450"></div>',20);function sp(np,ap){const a=B("ExternalLinkIcon");return r(),i("div",null,[Vn,s("p",null,[n("Arduino IDE软件esp32+esp8266离线安装包链接："),s("a",Hn,[n("https://pan.baidu.com/s/1LymkbGFzdjkwvs4E7MMi2g?pwd=8889"),l(a)])]),s("p",null,[n("CH340资料链接: "),s("a",Gn,[n("https://pan.baidu.com/s/10xkZRh0lhhMzrGsPKYjVlw?pwd=l9hj"),l(a)]),n(" 提取码：l9hj")]),Wn,s("p",null,[n("DHT11资料下载链接："),s("a",zn,[n("https://pan.baidu.com/s/1WdJK13-oJNpTJXn-8sp0DQ?pwd=8889提取码：8889"),l(a)])]),Kn,s("p",null,[n("使用讲解视频，电路图，相关资料链接："),Yn,n(" 链接："),s("a",Xn,[n("https://pan.baidu.com/s/15i3dfnr396_Riqrt5KNIFg?pwd=cupr"),l(a)])]),s("p",null,[n("模块测试视频："),s("a",Jn,[n("https://www.ixigua.com/6947472265965470239?utm_source=xiguastudio"),l(a)])]),$n,s("p",null,[n("新款0.96寸 4管脚 白色 焊好排针 使用说明："),s("a",Zn,[n("https://www.bilibili.com/opus/1019499397834080257"),l(a)])]),s("p",null,[n("经典款0.96寸 4管脚 白色 焊好排针 使用说明："),s("a",Qn,[n("https://www.bilibili.com/opus/1019500909654179841"),l(a)])]),s("p",null,[n("新款0.96寸4管脚资料链接："),s("a",sa,[n("https://pan.baidu.com/s/1l9Az0SOl7TOfX1HwjdqMjg?pwd=8889"),l(a)]),n(" 提取码: 8889")]),s("p",null,[n("0.96寸4管脚资料链接："),s("a",na,[n("https://pan.baidu.com/s/1Zp6dyui6dDvy03ossLSKnw?pwd=8889"),l(a)]),n(" 提取码: 8889")]),aa,s("p",null,[n("STM32最小系统资料包： "),s("a",la,[n("https://pan.baidu.com/s/1voa4MsLO3xzu8Y-DC1J3OQ"),l(a)]),n(" 提取码：3did")]),s("p",null,[n("STM32F103C8T6数据手册："),s("a",pa,[n("https://pan.baidu.com/s/13T5tt842yjWaCk66cwV8Pg?pwd=pirq"),l(a)]),n(" 提取码：pirq")]),oa,s("p",null,[n("链接："),s("a",ea,[n("https://pan.baidu.com/s/1NQ1DHlxOauFRJ2vkfJrxow"),l(a)])]),ta,s("p",null,[n("浊度资料链接: "),s("a",ca,[n("https://pan.baidu.com/s/1npfhQQ3SwOPjhHAwqtPSNw?pwd=egc8"),l(a)])]),Ba,s("p",null,[n("ESP-01S 使用说明："),s("a",ra,[n("https://www.bilibili.com/opus/1069977233630691330"),l(a)])]),ia,s("p",null,[n("地址："),s("a",ya,[n("https://yunya.site/"),l(a)]),Aa,n(" 账号：158****6824"),da,n(" 密码：123456")]),Fa,s("p",null,[n("ESP32-CAM（带摄像头） 使用教程视频："),s("a",va,[n("https://www.bilibili.com/opus/1011714834051366936"),l(a)])]),s("p",null,[n("ESP32+ESP32-CAM资料: "),s("a",ua,[n("https://pan.baidu.com/s/1sS52Y4oghFh8jwgl9YQ3eg?pwd=8889"),l(a)]),n(" 提取码：8889")]),ma,s("p",null,[n("CH340资料链接: "),s("a",Ca,[n("https://pan.baidu.com/s/10xkZRh0lhhMzrGsPKYjVlw?pwd=l9hj"),l(a)]),n(" 提取码：l9hj")]),Da,ba,Ea,ga,ha,fa,s("p",null,[n("Arduino IDE软件esp32+esp8266离线安装包链接："),s("a",qa,[n("https://pan.baidu.com/s/1LymkbGFzdjkwvs4E7MMi2g?pwd=8889"),l(a)])]),_a,s("p",null,[s("a",xa,[n("https://arduino.me/packages/esp32.json"),l(a)])]),s("p",null,[s("a",wa,[n("https://arduino.me/packages/esp8266.json"),l(a)])]),Sa,s("p",null,[n("CH340资料链接: "),s("a",ka,[n("https://pan.baidu.com/s/10xkZRh0lhhMzrGsPKYjVlw?pwd=l9hj"),l(a)]),n(" 提取码：l9hj")]),Pa,Ia,Ta,La,Ra,Na,s("p",null,[s("a",Oa,[n("https://zhuanlan.zhihu.com/p/1903019173711418696"),l(a)])]),Ma,s("p",null,[n("CH340资料链接: "),s("a",ja,[n("https://pan.baidu.com/s/10xkZRh0lhhMzrGsPKYjVlw?pwd=l9hj"),l(a)]),n(" 提取码：l9hj")]),Ua,Va,Ha,Ga,Wa,za,s("p",null,[n("Arduino IDE软件esp32+esp8266离线安装包链接："),s("a",Ka,[n("https://pan.baidu.com/s/1LymkbGFzdjkwvs4E7MMi2g?pwd=8889"),l(a)])]),Ya,s("p",null,[s("a",Xa,[n("https://arduino.me/packages/esp32.json"),l(a)])]),s("p",null,[s("a",Ja,[n("https://arduino.me/packages/esp8266.json"),l(a)])]),$a,s("h4",Za,[Qa,n(" 3、主程序 | "),s("a",sl,[n("main.py"),l(a)])]),nl,s("h4",al,[ll,n(" 4、摄像头管理器 | "),s("a",pl,[n("CameraManager.py"),l(a)])]),ol,s("h4",el,[tl,n(" 5、全局配置获取 | "),s("a",cl,[n("configUtils.py"),l(a)])]),Bl,s("h4",rl,[il,n(" 6、封装返回结果 | "),s("a",yl,[n("respUtils.py"),l(a)])]),Al,s("h4",dl,[Fl,n(" 7、环境数据 | "),s("a",vl,[n("envData.py"),l(a)])]),ul,s("h4",ml,[Cl,n(" 8、土壤数据 | "),s("a",Dl,[n("soilData.py"),l(a)])]),bl,s("h4",El,[gl,n(" 9、视屏流数据 | "),s("a",hl,[n("videoData.py"),l(a)])]),fl,s("h4",ql,[_l,n(" 10、水质数据 | "),s("a",xl,[n("waterData.py"),l(a)])]),wl,s("h4",Sl,[kl,n(" 11、发送指令 | "),s("a",Pl,[n("execute.py"),l(a)])]),Il,s("p",null,[s("a",Tl,[n("右键main.py"),l(a)]),n("，选择”运行“")]),Ll,Rl,Nl,s("p",null,[n("打开浏览器输入："),s("a",Ol,[n("http://127.0.0.1:5000"),l(a)]),n(" +接口地址")]),Ml,s("p",null,[n("注：视频流 "),s("a",jl,[n("http://$"),l(a)]),n(":81/stream")]),Ul,s("p",null,[n("访问"),s("a",Vl,[n("http://127.0.0.1:5500/index.html"),l(a)])]),Hl,s("p",null,[n("登录到小智后台："),s("a",Gl,[n("https://xiaozhi.me"),l(a)]),n(" ，点控制台")]),Wl,s("h4",zl,[Kl,n(" 3、主程序 | "),s("a",Yl,[n("main.py"),l(a)])]),Xl,s("h4",Jl,[$l,n(" 4、全局配置获取 | "),s("a",Zl,[n("configUtils.py"),l(a)])]),Ql])}const pp=c(Un,[["render",sp],["__file","riceShrimpCrab.html.vue"]]);export{pp as default};
